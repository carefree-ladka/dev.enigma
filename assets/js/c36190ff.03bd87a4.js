"use strict";(self.webpackChunkdev_enigma=self.webpackChunkdev_enigma||[]).push([[75321],{28453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>a});var r=t(96540);const o={},i=r.createContext(o);function s(e){const n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),r.createElement(i.Provider,{value:n},e.children)}},68363:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>p,frontMatter:()=>i,metadata:()=>a,toc:()=>c});var r=t(74848),o=t(28453);const i={},s="Complete Authentication & Authorization Guide",a={id:"Interview Prep 2026/Complete Authentication & Authorization Guide",title:"Complete Authentication & Authorization Guide",description:"Spring Boot + React with JWT, RBAC, SSO, MFA, and More",source:"@site/docs/08-Interview Prep 2026/Complete Authentication & Authorization Guide.mdx",sourceDirName:"08-Interview Prep 2026",slug:"/Interview Prep 2026/Complete Authentication & Authorization Guide",permalink:"/docs/Interview Prep 2026/Complete Authentication & Authorization Guide",draft:!1,unlisted:!1,editUrl:"https://github.com/carefree-ladka/docs/08-Interview Prep 2026/Complete Authentication & Authorization Guide.mdx",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"TTL Cache Implementation Guide",permalink:"/docs/Interview Prep 2026/Cache With TTL"},next:{title:"\ud83c\udf33 Complete DOM Manipulation Guide",permalink:"/docs/Interview Prep 2026/Complete DOM Manipulation Guide"}},l={},c=[{value:"Spring Boot + React with JWT, RBAC, SSO, MFA, and More",id:"spring-boot--react-with-jwt-rbac-sso-mfa-and-more",level:2},{value:"Table of Contents",id:"table-of-contents",level:2},{value:"Overview",id:"overview",level:2},{value:"Authentication vs Authorization",id:"authentication-vs-authorization",level:3},{value:"JWT (JSON Web Tokens)",id:"jwt-json-web-tokens",level:2},{value:"JWT Structure",id:"jwt-structure",level:3},{value:"1. Header",id:"1-header",level:4},{value:"2. Payload (Claims)",id:"2-payload-claims",level:4},{value:"3. Signature",id:"3-signature",level:4},{value:"Access Token vs Refresh Token",id:"access-token-vs-refresh-token",level:3},{value:"Token Storage Options",id:"token-storage-options",level:3},{value:"HttpOnly Cookies",id:"httponly-cookies",level:2},{value:"Security Benefits",id:"security-benefits",level:3},{value:"Complete Authentication Flow",id:"complete-authentication-flow",level:2},{value:"Login Flow",id:"login-flow",level:3},{value:"Role-Based Access Control (RBAC)",id:"role-based-access-control-rbac",level:2},{value:"RBAC Hierarchy",id:"rbac-hierarchy",level:3},{value:"Complete Code Examples",id:"complete-code-examples",level:2},{value:"Spring Boot Backend Implementation",id:"spring-boot-backend-implementation",level:3},{value:"1. Project Dependencies (pom.xml)",id:"1-project-dependencies-pomxml",level:4},{value:"2. Application Properties",id:"2-application-properties",level:4},{value:"3. Entity Models",id:"3-entity-models",level:4},{value:"4. Repository Interfaces",id:"4-repository-interfaces",level:4},{value:"5. JWT Utility",id:"5-jwt-utility",level:4},{value:"6. Security Configuration",id:"6-security-configuration",level:4},{value:"7. JWT Authentication Filter",id:"7-jwt-authentication-filter",level:4},{value:"8. DTOs (Data Transfer Objects)",id:"8-dtos-data-transfer-objects",level:4},{value:"9. Authentication Service",id:"9-authentication-service",level:4},{value:"10. MFA Service",id:"10-mfa-service",level:4},{value:"11. Email Service",id:"11-email-service",level:4},{value:"12. Authentication Controller",id:"12-authentication-controller",level:4},{value:"React Frontend Implementation",id:"react-frontend-implementation",level:2},{value:"1. Project Setup",id:"1-project-setup",level:3},{value:"2. API Configuration",id:"2-api-configuration",level:3},{value:"3. Authentication Context",id:"3-authentication-context",level:3},{value:"4. Protected Route Component",id:"4-protected-route-component",level:3},{value:"5. Login Component",id:"5-login-component",level:3},{value:"6. Register Component",id:"6-register-component",level:3},{value:"7. Email Verification Component",id:"7-email-verification-component",level:3},{value:"8. Dashboard Component",id:"8-dashboard-component",level:3},{value:"9. App Router Setup",id:"9-app-router-setup",level:3},{value:"Security Best Practices",id:"security-best-practices",level:2},{value:"Password Security",id:"password-security",level:3},{value:"Token Security",id:"token-security",level:3},{value:"API Security",id:"api-security",level:3},{value:"Common Vulnerabilities",id:"common-vulnerabilities",level:3},{value:"Production Checklist",id:"production-checklist",level:2},{value:"Environment Variables",id:"environment-variables",level:3},{value:"Deployment Checklist",id:"deployment-checklist",level:3},{value:"Conclusion",id:"conclusion",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"complete-authentication--authorization-guide",children:"Complete Authentication & Authorization Guide"})}),"\n",(0,r.jsx)(n.h2,{id:"spring-boot--react-with-jwt-rbac-sso-mfa-and-more",children:"Spring Boot + React with JWT, RBAC, SSO, MFA, and More"}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"table-of-contents",children:"Table of Contents"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#overview",children:"Overview"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#jwt-json-web-tokens",children:"JWT (JSON Web Tokens)"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#httponly-cookies",children:"HttpOnly Cookies"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#complete-authentication-flow",children:"Complete Authentication Flow"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#role-based-access-control-rbac",children:"Role-Based Access Control (RBAC)"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#single-sign-on-sso",children:"Single Sign-On (SSO)"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#multi-factor-authentication-mfa",children:"Multi-Factor Authentication (MFA)"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#one-time-password-otp",children:"One-Time Password (OTP)"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#complete-code-examples",children:"Complete Code Examples"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#security-best-practices",children:"Security Best Practices"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#advanced-topics",children:"Advanced Topics"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#production-checklist",children:"Production Checklist"})}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsx)(n.h3,{id:"authentication-vs-authorization",children:"Authentication vs Authorization"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                                                         \u2502\n\u2502  AUTHENTICATION: "Who are you?"                         \u2502\n\u2502  \u251c\u2500 Login with username/password                        \u2502\n\u2502  \u251c\u2500 Verify identity                                     \u2502\n\u2502  \u2514\u2500 Issue token                                         \u2502\n\u2502                                                         \u2502\n\u2502  AUTHORIZATION: "What can you do?"                      \u2502\n\u2502  \u251c\u2500 Check user roles                                    \u2502\n\u2502  \u251c\u2500 Verify permissions                                  \u2502\n\u2502  \u2514\u2500 Allow/deny access                                   \u2502\n\u2502                                                         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n'})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Aspect"}),(0,r.jsx)(n.th,{children:"Authentication"}),(0,r.jsx)(n.th,{children:"Authorization"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Purpose"})}),(0,r.jsx)(n.td,{children:"Verify identity"}),(0,r.jsx)(n.td,{children:"Control access"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Question"})}),(0,r.jsx)(n.td,{children:'"Who are you?"'}),(0,r.jsx)(n.td,{children:'"What can you do?"'})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Process"})}),(0,r.jsx)(n.td,{children:"Login, credentials"}),(0,r.jsx)(n.td,{children:"Check permissions"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Result"})}),(0,r.jsx)(n.td,{children:"User identified"}),(0,r.jsx)(n.td,{children:"Access granted/denied"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Example"})}),(0,r.jsx)(n.td,{children:"Username/password"}),(0,r.jsx)(n.td,{children:"Admin can delete users"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Happens"})}),(0,r.jsx)(n.td,{children:"Once (at login)"}),(0,r.jsx)(n.td,{children:"Every request"})]})]})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"jwt-json-web-tokens",children:"JWT (JSON Web Tokens)"}),"\n",(0,r.jsx)(n.h3,{id:"jwt-structure",children:"JWT Structure"}),"\n",(0,r.jsx)(n.h4,{id:"1-header",children:"1. Header"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "alg": "HS256",\n  "typ": "JWT"\n}\n'})}),"\n",(0,r.jsx)(n.h4,{id:"2-payload-claims",children:"2. Payload (Claims)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "sub": "user123",\n  "name": "John Doe",\n  "email": "john@example.com",\n  "role": "admin",\n  "iat": 1640000000,\n  "exp": 1640003600\n}\n'})}),"\n",(0,r.jsx)(n.h4,{id:"3-signature",children:"3. Signature"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'HMACSHA256(\n  base64UrlEncode(header) + "." +\n  base64UrlEncode(payload),\n  secret\n)\n'})}),"\n",(0,r.jsx)(n.h3,{id:"access-token-vs-refresh-token",children:"Access Token vs Refresh Token"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Aspect"}),(0,r.jsx)(n.th,{children:"Access Token"}),(0,r.jsx)(n.th,{children:"Refresh Token"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Purpose"})}),(0,r.jsx)(n.td,{children:"Access protected resources"}),(0,r.jsx)(n.td,{children:"Get new access token"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Lifespan"})}),(0,r.jsx)(n.td,{children:"Short (15 min - 1 hour)"}),(0,r.jsx)(n.td,{children:"Long (7-30 days)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Storage"})}),(0,r.jsx)(n.td,{children:"Memory/state"}),(0,r.jsx)(n.td,{children:"HttpOnly cookie"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Sent with"})}),(0,r.jsx)(n.td,{children:"Every API request"}),(0,r.jsx)(n.td,{children:"Only to /refresh endpoint"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Payload"})}),(0,r.jsx)(n.td,{children:"User info, roles, permissions"}),(0,r.jsx)(n.td,{children:"User ID, token ID"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Revocable"})}),(0,r.jsx)(n.td,{children:"No (stateless)"}),(0,r.jsx)(n.td,{children:"Yes (stored in DB)"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"token-storage-options",children:"Token Storage Options"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Storage"}),(0,r.jsx)(n.th,{children:"Security"}),(0,r.jsx)(n.th,{children:"XSS Vulnerable"}),(0,r.jsx)(n.th,{children:"CSRF Vulnerable"}),(0,r.jsx)(n.th,{children:"Best For"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"LocalStorage"})}),(0,r.jsx)(n.td,{children:"\u274c Low"}),(0,r.jsx)(n.td,{children:"\u2705 Yes"}),(0,r.jsx)(n.td,{children:"\u274c No"}),(0,r.jsx)(n.td,{children:"Never (avoid)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"SessionStorage"})}),(0,r.jsx)(n.td,{children:"\u274c Low"}),(0,r.jsx)(n.td,{children:"\u2705 Yes"}),(0,r.jsx)(n.td,{children:"\u274c No"}),(0,r.jsx)(n.td,{children:"Never (avoid)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Memory (state)"})}),(0,r.jsx)(n.td,{children:"\u2705 Good"}),(0,r.jsx)(n.td,{children:"\u26a0\ufe0f Lost on refresh"}),(0,r.jsx)(n.td,{children:"\u274c No"}),(0,r.jsx)(n.td,{children:"Access tokens"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"HttpOnly Cookie"})}),(0,r.jsx)(n.td,{children:"\u2705 Best"}),(0,r.jsx)(n.td,{children:"\u274c No"}),(0,r.jsx)(n.td,{children:"\u2705 Yes (use CSRF token)"}),(0,r.jsx)(n.td,{children:"Refresh tokens"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Recommended Approach:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Access Token  \u2192 In-memory (React state)\nRefresh Token \u2192 HttpOnly cookie\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"httponly-cookies",children:"HttpOnly Cookies"}),"\n",(0,r.jsx)(n.h3,{id:"security-benefits",children:"Security Benefits"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502         Cookie Security Flags               \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                             \u2502\n\u2502  HttpOnly: Prevents JavaScript access       \u2502\n\u2502  Secure: Only sent over HTTPS               \u2502\n\u2502  SameSite: Prevents CSRF attacks            \u2502\n\u2502  Domain: Limits cookie scope                \u2502\n\u2502  Path: Restricts cookie path                \u2502\n\u2502  Max-Age: Sets expiration                   \u2502\n\u2502                                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"complete-authentication-flow",children:"Complete Authentication Flow"}),"\n",(0,r.jsx)(n.h3,{id:"login-flow",children:"Login Flow"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    Login Flow Diagram                       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\nUser                    React App              Spring Boot          Database\n \u2502                         \u2502                      \u2502                    \u2502\n \u2502  1. Enter credentials   \u2502                      \u2502                    \u2502\n \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500>\u2502                      \u2502                    \u2502\n \u2502                         \u2502  2. POST /api/auth/login                  \u2502\n \u2502                         \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500>\u2502                    \u2502\n \u2502                         \u2502  {email, password}   \u2502                    \u2502\n \u2502                         \u2502                      \u2502  3. Find user      \u2502\n \u2502                         \u2502                      \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500>\u2502\n \u2502                         \u2502                      \u2502<\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n \u2502                         \u2502                      \u2502  4. User data      \u2502\n \u2502                         \u2502                      \u2502                    \u2502\n \u2502                         \u2502                      \u2502  5. Verify password\u2502\n \u2502                         \u2502                      \u2502  (BCrypt)          \u2502\n \u2502                         \u2502                      \u2502                    \u2502\n \u2502                         \u2502                      \u2502  6. Generate tokens\u2502\n \u2502                         \u2502                      \u2502  - Access token    \u2502\n \u2502                         \u2502                      \u2502  - Refresh token   \u2502\n \u2502                         \u2502                      \u2502                    \u2502\n \u2502                         \u2502                      \u2502  7. Store refresh  \u2502\n \u2502                         \u2502                      \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500>\u2502\n \u2502                         \u2502                      \u2502                    \u2502\n \u2502                         \u2502  8. Response         \u2502                    \u2502\n \u2502                         \u2502<\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524                    \u2502\n \u2502                         \u2502  {                   \u2502                    \u2502\n \u2502                         \u2502    accessToken,      \u2502                    \u2502\n \u2502                         \u2502    user: {...}       \u2502                    \u2502\n \u2502                         \u2502  }                   \u2502                    \u2502\n \u2502                         \u2502  + Set-Cookie:       \u2502                    \u2502\n \u2502                         \u2502    refreshToken      \u2502                    \u2502\n \u2502                         \u2502                      \u2502                    \u2502\n \u2502  9. Login success       \u2502  10. Store access    \u2502                    \u2502\n \u2502<\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524      token in state  \u2502                    \u2502\n \u2502                         \u2502  11. Redirect to     \u2502                    \u2502\n \u2502                         \u2502      dashboard       \u2502                    \u2502\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"role-based-access-control-rbac",children:"Role-Based Access Control (RBAC)"}),"\n",(0,r.jsx)(n.h3,{id:"rbac-hierarchy",children:"RBAC Hierarchy"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                 RBAC Hierarchy                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n           User\n            \u2502\n       has  \u2502\n            \u2193\n           Role \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n            \u2502                     \u2502\n       has  \u2502                has  \u2502\n            \u2193                     \u2193\n       Permissions           Inherited\n                             from other roles\n\nExample:\n\nAdmin Role\n\u251c\u2500\u2500 user:create\n\u251c\u2500\u2500 user:read\n\u251c\u2500\u2500 user:update\n\u251c\u2500\u2500 user:delete\n\u251c\u2500\u2500 post:create\n\u251c\u2500\u2500 post:read\n\u251c\u2500\u2500 post:update\n\u2514\u2500\u2500 post:delete\n\nEditor Role\n\u251c\u2500\u2500 post:create\n\u251c\u2500\u2500 post:read\n\u251c\u2500\u2500 post:update\n\u2514\u2500\u2500 user:read (own)\n\nViewer Role\n\u251c\u2500\u2500 post:read\n\u2514\u2500\u2500 user:read (own)\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"complete-code-examples",children:"Complete Code Examples"}),"\n",(0,r.jsx)(n.h3,{id:"spring-boot-backend-implementation",children:"Spring Boot Backend Implementation"}),"\n",(0,r.jsx)(n.h4,{id:"1-project-dependencies-pomxml",children:"1. Project Dependencies (pom.xml)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8"?>\n<project xmlns="http://maven.apache.org/POM/4.0.0">\n    <modelVersion>4.0.0</modelVersion>\n\n    <parent>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-parent</artifactId>\n        <version>3.2.0</version>\n    </parent>\n\n    <groupId>com.example</groupId>\n    <artifactId>auth-service</artifactId>\n    <version>1.0.0</version>\n\n    <dependencies>\n        \x3c!-- Spring Boot Starter Web --\x3e\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-web</artifactId>\n        </dependency>\n\n        \x3c!-- Spring Boot Starter Security --\x3e\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-security</artifactId>\n        </dependency>\n\n        \x3c!-- Spring Boot Starter Data JPA --\x3e\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-data-jpa</artifactId>\n        </dependency>\n\n        \x3c!-- Spring Boot Starter Validation --\x3e\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-validation</artifactId>\n        </dependency>\n\n        \x3c!-- JWT --\x3e\n        <dependency>\n            <groupId>io.jsonwebtoken</groupId>\n            <artifactId>jjwt-api</artifactId>\n            <version>0.12.3</version>\n        </dependency>\n        <dependency>\n            <groupId>io.jsonwebtoken</groupId>\n            <artifactId>jjwt-impl</artifactId>\n            <version>0.12.3</version>\n            <scope>runtime</scope>\n        </dependency>\n        <dependency>\n            <groupId>io.jsonwebtoken</groupId>\n            <artifactId>jjwt-jackson</artifactId>\n            <version>0.12.3</version>\n            <scope>runtime</scope>\n        </dependency>\n\n        \x3c!-- PostgreSQL Driver --\x3e\n        <dependency>\n            <groupId>org.postgresql</groupId>\n            <artifactId>postgresql</artifactId>\n            <scope>runtime</scope>\n        </dependency>\n\n        \x3c!-- Lombok --\x3e\n        <dependency>\n            <groupId>org.projectlombok</groupId>\n            <artifactId>lombok</artifactId>\n            <optional>true</optional>\n        </dependency>\n\n        \x3c!-- Google Authenticator (for TOTP/MFA) --\x3e\n        <dependency>\n            <groupId>com.warrenstrange</groupId>\n            <artifactId>googleauth</artifactId>\n            <version>1.5.0</version>\n        </dependency>\n\n        \x3c!-- OAuth2 Client (for SSO) --\x3e\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-oauth2-client</artifactId>\n        </dependency>\n    </dependencies>\n</project>\n'})}),"\n",(0,r.jsx)(n.h4,{id:"2-application-properties",children:"2. Application Properties"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-properties",children:"# application.properties\n\n# Server Configuration\nserver.port=8080\nserver.servlet.context-path=/api\n\n# Database Configuration\nspring.datasource.url=jdbc:postgresql://localhost:5432/authdb\nspring.datasource.username=postgres\nspring.datasource.password=password\nspring.jpa.hibernate.ddl-auto=update\nspring.jpa.show-sql=true\nspring.jpa.properties.hibernate.format_sql=true\n\n# JWT Configuration\njwt.secret=your-256-bit-secret-key-change-this-in-production\njwt.access-token-expiration=900000\njwt.refresh-token-expiration=604800000\n\n# Cookie Configuration\ncookie.secure=true\ncookie.http-only=true\ncookie.same-site=Strict\ncookie.max-age=604800\n\n# OAuth2 Configuration (Google)\nspring.security.oauth2.client.registration.google.client-id=your-google-client-id\nspring.security.oauth2.client.registration.google.client-secret=your-google-client-secret\nspring.security.oauth2.client.registration.google.scope=profile,email\n\n# OAuth2 Configuration (GitHub)\nspring.security.oauth2.client.registration.github.client-id=your-github-client-id\nspring.security.oauth2.client.registration.github.client-secret=your-github-client-secret\nspring.security.oauth2.client.registration.github.scope=read:user,user:email\n\n# CORS Configuration\ncors.allowed-origins=http://localhost:3000,http://localhost:5173\ncors.allowed-methods=GET,POST,PUT,DELETE,OPTIONS\ncors.allowed-headers=*\ncors.allow-credentials=true\n"})}),"\n",(0,r.jsx)(n.h4,{id:"3-entity-models",children:"3. Entity Models"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'// User.java\npackage com.example.auth.entity;\n\nimport jakarta.persistence.*;\nimport lombok.*;\nimport java.time.LocalDateTime;\nimport java.util.HashSet;\nimport java.util.Set;\n\n@Entity\n@Table(name = "users")\n@Data\n@NoArgsConstructor\n@AllArgsConstructor\n@Builder\npublic class User {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.UUID)\n    private String id;\n\n    @Column(unique = true, nullable = false)\n    private String email;\n\n    @Column(nullable = false)\n    private String password;\n\n    private String name;\n\n    @Column(name = "phone_number")\n    private String phoneNumber;\n\n    @Column(name = "is_email_verified")\n    private boolean isEmailVerified = false;\n\n    @Column(name = "is_mfa_enabled")\n    private boolean isMfaEnabled = false;\n\n    @Column(name = "mfa_secret")\n    private String mfaSecret;\n\n    @ManyToMany(fetch = FetchType.EAGER)\n    @JoinTable(\n        name = "user_roles",\n        joinColumns = @JoinColumn(name = "user_id"),\n        inverseJoinColumns = @JoinColumn(name = "role_id")\n    )\n    private Set<Role> roles = new HashSet<>();\n\n    @Column(name = "created_at")\n    private LocalDateTime createdAt = LocalDateTime.now();\n\n    @Column(name = "updated_at")\n    private LocalDateTime updatedAt = LocalDateTime.now();\n\n    @PreUpdate\n    public void preUpdate() {\n        this.updatedAt = LocalDateTime.now();\n    }\n}\n\n// Role.java\npackage com.example.auth.entity;\n\nimport jakarta.persistence.*;\nimport lombok.*;\nimport java.util.HashSet;\nimport java.util.Set;\n\n@Entity\n@Table(name = "roles")\n@Data\n@NoArgsConstructor\n@AllArgsConstructor\n@Builder\npublic class Role {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.UUID)\n    private String id;\n\n    @Column(unique = true, nullable = false)\n    @Enumerated(EnumType.STRING)\n    private RoleType name;\n\n    private String description;\n\n    @ManyToMany(fetch = FetchType.EAGER)\n    @JoinTable(\n        name = "role_permissions",\n        joinColumns = @JoinColumn(name = "role_id"),\n        inverseJoinColumns = @JoinColumn(name = "permission_id")\n    )\n    private Set<Permission> permissions = new HashSet<>();\n}\n\n// RoleType.java\npackage com.example.auth.entity;\n\npublic enum RoleType {\n    ADMIN,\n    EDITOR,\n    VIEWER,\n    USER\n}\n\n// Permission.java\npackage com.example.auth.entity;\n\nimport jakarta.persistence.*;\nimport lombok.*;\n\n@Entity\n@Table(name = "permissions")\n@Data\n@NoArgsConstructor\n@AllArgsConstructor\n@Builder\npublic class Permission {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.UUID)\n    private String id;\n\n    @Column(unique = true, nullable = false)\n    private String name;\n\n    private String resource;\n\n    private String action;\n\n    private String description;\n}\n\n// RefreshToken.java\npackage com.example.auth.entity;\n\nimport jakarta.persistence.*;\nimport lombok.*;\nimport java.time.LocalDateTime;\n\n@Entity\n@Table(name = "refresh_tokens")\n@Data\n@NoArgsConstructor\n@AllArgsConstructor\n@Builder\npublic class RefreshToken {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.UUID)\n    private String id;\n\n    @Column(nullable = false, unique = true)\n    private String token;\n\n    @ManyToOne\n    @JoinColumn(name = "user_id", nullable = false)\n    private User user;\n\n    @Column(name = "expires_at", nullable = false)\n    private LocalDateTime expiresAt;\n\n    @Column(name = "created_at")\n    private LocalDateTime createdAt = LocalDateTime.now();\n\n    public boolean isExpired() {\n        return LocalDateTime.now().isAfter(expiresAt);\n    }\n}\n\n// OtpToken.java\npackage com.example.auth.entity;\n\nimport jakarta.persistence.*;\nimport lombok.*;\nimport java.time.LocalDateTime;\n\n@Entity\n@Table(name = "otp_tokens")\n@Data\n@NoArgsConstructor\n@AllArgsConstructor\n@Builder\npublic class OtpToken {\n\n    @Id\n    @GeneratedValue(strategy = GenerationType.UUID)\n    private String id;\n\n    @Column(nullable = false)\n    private String otp;\n\n    @Column(nullable = false)\n    private String email;\n\n    @Enumerated(EnumType.STRING)\n    private OtpType type;\n\n    @Column(name = "expires_at")\n    private LocalDateTime expiresAt;\n\n    @Column(name = "created_at")\n    private LocalDateTime createdAt = LocalDateTime.now();\n\n    private boolean used = false;\n\n    public boolean isExpired() {\n        return LocalDateTime.now().isAfter(expiresAt);\n    }\n}\n\n// OtpType.java\npackage com.example.auth.entity;\n\npublic enum OtpType {\n    EMAIL_VERIFICATION,\n    PASSWORD_RESET,\n    MFA_LOGIN,\n    PHONE_VERIFICATION\n}\n'})}),"\n",(0,r.jsx)(n.h4,{id:"4-repository-interfaces",children:"4. Repository Interfaces"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"// UserRepository.java\npackage com.example.auth.repository;\n\nimport com.example.auth.entity.User;\nimport org.springframework.data.jpa.repository.JpaRepository;\nimport org.springframework.stereotype.Repository;\nimport java.util.Optional;\n\n@Repository\npublic interface UserRepository extends JpaRepository<User, String> {\n    Optional<User> findByEmail(String email);\n    boolean existsByEmail(String email);\n}\n\n// RoleRepository.java\npackage com.example.auth.repository;\n\nimport com.example.auth.entity.Role;\nimport com.example.auth.entity.RoleType;\nimport org.springframework.data.jpa.repository.JpaRepository;\nimport org.springframework.stereotype.Repository;\nimport java.util.Optional;\n\n@Repository\npublic interface RoleRepository extends JpaRepository<Role, String> {\n    Optional<Role> findByName(RoleType name);\n}\n\n// PermissionRepository.java\npackage com.example.auth.repository;\n\nimport com.example.auth.entity.Permission;\nimport org.springframework.data.jpa.repository.JpaRepository;\nimport org.springframework.stereotype.Repository;\nimport java.util.Optional;\n\n@Repository\npublic interface PermissionRepository extends JpaRepository<Permission, String> {\n    Optional<Permission> findByName(String name);\n}\n\n// RefreshTokenRepository.java\npackage com.example.auth.repository;\n\nimport com.example.auth.entity.RefreshToken;\nimport com.example.auth.entity.User;\nimport org.springframework.data.jpa.repository.JpaRepository;\nimport org.springframework.stereotype.Repository;\nimport java.util.Optional;\n\n@Repository\npublic interface RefreshTokenRepository extends JpaRepository<RefreshToken, String> {\n    Optional<RefreshToken> findByToken(String token);\n    void deleteByUser(User user);\n    void deleteByToken(String token);\n}\n\n// OtpTokenRepository.java\npackage com.example.auth.repository;\n\nimport com.example.auth.entity.OtpToken;\nimport com.example.auth.entity.OtpType;\nimport org.springframework.data.jpa.repository.JpaRepository;\nimport org.springframework.stereotype.Repository;\nimport java.util.Optional;\n\n@Repository\npublic interface OtpTokenRepository extends JpaRepository<OtpToken, String> {\n    Optional<OtpToken> findByEmailAndOtpAndType(String email, String otp, OtpType type);\n    void deleteByEmail(String email);\n}\n"})}),"\n",(0,r.jsx)(n.h4,{id:"5-jwt-utility",children:"5. JWT Utility"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'// JwtUtil.java\npackage com.example.auth.util;\n\nimport io.jsonwebtoken.*;\nimport io.jsonwebtoken.security.Keys;\nimport org.springframework.beans.factory.annotation.Value;\nimport org.springframework.security.core.userdetails.UserDetails;\nimport org.springframework.stereotype.Component;\nimport javax.crypto.SecretKey;\nimport java.util.Date;\nimport java.util.HashMap;\nimport java.util.Map;\nimport java.util.function.Function;\n\n@Component\npublic class JwtUtil {\n\n    @Value("${jwt.secret}")\n    private String secret;\n\n    @Value("${jwt.access-token-expiration}")\n    private Long accessTokenExpiration;\n\n    @Value("${jwt.refresh-token-expiration}")\n    private Long refreshTokenExpiration;\n\n    private SecretKey getSigningKey() {\n        return Keys.hmacShaKeyFor(secret.getBytes());\n    }\n\n    // Generate Access Token\n    public String generateAccessToken(UserDetails userDetails, Map<String, Object> claims) {\n        return createToken(claims, userDetails.getUsername(), accessTokenExpiration);\n    }\n\n    // Generate Refresh Token\n    public String generateRefreshToken(String username) {\n        Map<String, Object> claims = new HashMap<>();\n        return createToken(claims, username, refreshTokenExpiration);\n    }\n\n    // Create Token\n    private String createToken(Map<String, Object> claims, String subject, Long expiration) {\n        Date now = new Date();\n        Date expiryDate = new Date(now.getTime() + expiration);\n\n        return Jwts.builder()\n                .claims(claims)\n                .subject(subject)\n                .issuedAt(now)\n                .expiration(expiryDate)\n                .signWith(getSigningKey())\n                .compact();\n    }\n\n    // Extract Username\n    public String extractUsername(String token) {\n        return extractClaim(token, Claims::getSubject);\n    }\n\n    // Extract Expiration\n    public Date extractExpiration(String token) {\n        return extractClaim(token, Claims::getExpiration);\n    }\n\n    // Extract Claim\n    public <T> T extractClaim(String token, Function<Claims, T> claimsResolver) {\n        final Claims claims = extractAllClaims(token);\n        return claimsResolver.apply(claims);\n    }\n\n    // Extract All Claims\n    private Claims extractAllClaims(String token) {\n        return Jwts.parser()\n                .verifyWith(getSigningKey())\n                .build()\n                .parseSignedClaims(token)\n                .getPayload();\n    }\n\n    // Check if Token is Expired\n    private Boolean isTokenExpired(String token) {\n        return extractExpiration(token).before(new Date());\n    }\n\n    // Validate Token\n    public Boolean validateToken(String token, UserDetails userDetails) {\n        final String username = extractUsername(token);\n        return (username.equals(userDetails.getUsername()) && !isTokenExpired(token));\n    }\n}\n'})}),"\n",(0,r.jsx)(n.h4,{id:"6-security-configuration",children:"6. Security Configuration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'// SecurityConfig.java\npackage com.example.auth.config;\n\nimport com.example.auth.security.JwtAuthenticationEntryPoint;\nimport com.example.auth.security.JwtAuthenticationFilter;\nimport lombok.RequiredArgsConstructor;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.security.authentication.AuthenticationManager;\nimport org.springframework.security.authentication.AuthenticationProvider;\nimport org.springframework.security.authentication.dao.DaoAuthenticationProvider;\nimport org.springframework.security.config.annotation.authentication.configuration.AuthenticationConfiguration;\nimport org.springframework.security.config.annotation.method.configuration.EnableMethodSecurity;\nimport org.springframework.security.config.annotation.web.builders.HttpSecurity;\nimport org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;\nimport org.springframework.security.config.http.SessionCreationPolicy;\nimport org.springframework.security.core.userdetails.UserDetailsService;\nimport org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;\nimport org.springframework.security.crypto.password.PasswordEncoder;\nimport org.springframework.security.web.SecurityFilterChain;\nimport org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter;\nimport org.springframework.web.cors.CorsConfiguration;\nimport org.springframework.web.cors.CorsConfigurationSource;\nimport org.springframework.web.cors.UrlBasedCorsConfigurationSource;\nimport java.util.Arrays;\n\n@Configuration\n@EnableWebSecurity\n@EnableMethodSecurity(prePostEnabled = true)\n@RequiredArgsConstructor\npublic class SecurityConfig {\n\n    private final JwtAuthenticationFilter jwtAuthFilter;\n    private final UserDetailsService userDetailsService;\n    private final JwtAuthenticationEntryPoint authenticationEntryPoint;\n\n    @Bean\n    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {\n        http\n            .csrf(csrf -> csrf.disable())\n            .cors(cors -> cors.configurationSource(corsConfigurationSource()))\n            .authorizeHttpRequests(auth -> auth\n                .requestMatchers(\n                    "/auth/login",\n                    "/auth/register",\n                    "/auth/refresh",\n                    "/auth/forgot-password",\n                    "/auth/reset-password",\n                    "/auth/verify-email",\n                    "/oauth2/**"\n                ).permitAll()\n                .anyRequest().authenticated()\n            )\n            .sessionManagement(session ->\n                session.sessionCreationPolicy(SessionCreationPolicy.STATELESS)\n            )\n            .authenticationProvider(authenticationProvider())\n            .addFilterBefore(jwtAuthFilter, UsernamePasswordAuthenticationFilter.class)\n            .exceptionHandling(ex ->\n                ex.authenticationEntryPoint(authenticationEntryPoint)\n            );\n\n        return http.build();\n    }\n\n    @Bean\n    public AuthenticationProvider authenticationProvider() {\n        DaoAuthenticationProvider authProvider = new DaoAuthenticationProvider();\n        authProvider.setUserDetailsService(userDetailsService);\n        authProvider.setPasswordEncoder(passwordEncoder());\n        return authProvider;\n    }\n\n    @Bean\n    public AuthenticationManager authenticationManager(\n            AuthenticationConfiguration config) throws Exception {\n        return config.getAuthenticationManager();\n    }\n\n    @Bean\n    public PasswordEncoder passwordEncoder() {\n        return new BCryptPasswordEncoder();\n    }\n\n    @Bean\n    public CorsConfigurationSource corsConfigurationSource() {\n        CorsConfiguration configuration = new CorsConfiguration();\n        configuration.setAllowedOrigins(Arrays.asList(\n            "http://localhost:3000",\n            "http://localhost:5173"\n        ));\n        configuration.setAllowedMethods(Arrays.asList(\n            "GET", "POST", "PUT", "DELETE", "OPTIONS"\n        ));\n        configuration.setAllowedHeaders(Arrays.asList("*"));\n        configuration.setAllowCredentials(true);\n\n        UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();\n        source.registerCorsConfiguration("/**", configuration);\n        return source;\n    }\n}\n'})}),"\n",(0,r.jsx)(n.h4,{id:"7-jwt-authentication-filter",children:"7. JWT Authentication Filter"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'// JwtAuthenticationFilter.java\npackage com.example.auth.security;\n\nimport com.example.auth.util.JwtUtil;\nimport jakarta.servlet.FilterChain;\nimport jakarta.servlet.ServletException;\nimport jakarta.servlet.http.HttpServletRequest;\nimport jakarta.servlet.http.HttpServletResponse;\nimport lombok.RequiredArgsConstructor;\nimport org.springframework.lang.NonNull;\nimport org.springframework.security.authentication.UsernamePasswordAuthenticationToken;\nimport org.springframework.security.core.context.SecurityContextHolder;\nimport org.springframework.security.core.userdetails.UserDetails;\nimport org.springframework.security.core.userdetails.UserDetailsService;\nimport org.springframework.security.web.authentication.WebAuthenticationDetailsSource;\nimport org.springframework.stereotype.Component;\nimport org.springframework.web.filter.OncePerRequestFilter;\nimport java.io.IOException;\n\n@Component\n@RequiredArgsConstructor\npublic class JwtAuthenticationFilter extends OncePerRequestFilter {\n\n    private final JwtUtil jwtUtil;\n    private final UserDetailsService userDetailsService;\n\n    @Override\n    protected void doFilterInternal(\n            @NonNull HttpServletRequest request,\n            @NonNull HttpServletResponse response,\n            @NonNull FilterChain filterChain\n    ) throws ServletException, IOException {\n\n        final String authHeader = request.getHeader("Authorization");\n\n        if (authHeader == null || !authHeader.startsWith("Bearer ")) {\n            filterChain.doFilter(request, response);\n            return;\n        }\n\n        try {\n            final String jwt = authHeader.substring(7);\n            final String username = jwtUtil.extractUsername(jwt);\n\n            if (username != null && SecurityContextHolder.getContext().getAuthentication() == null) {\n                UserDetails userDetails = userDetailsService.loadUserByUsername(username);\n\n                if (jwtUtil.validateToken(jwt, userDetails)) {\n                    UsernamePasswordAuthenticationToken authToken =\n                        new UsernamePasswordAuthenticationToken(\n                            userDetails,\n                            null,\n                            userDetails.getAuthorities()\n                        );\n\n                    authToken.setDetails(\n                        new WebAuthenticationDetailsSource().buildDetails(request)\n                    );\n\n                    SecurityContextHolder.getContext().setAuthentication(authToken);\n                }\n            }\n        } catch (Exception e) {\n            logger.error("Cannot set user authentication: {}", e);\n        }\n\n        filterChain.doFilter(request, response);\n    }\n}\n\n// JwtAuthenticationEntryPoint.java\npackage com.example.auth.security;\n\nimport jakarta.servlet.ServletException;\nimport jakarta.servlet.http.HttpServletRequest;\nimport jakarta.servlet.http.HttpServletResponse;\nimport org.springframework.security.core.AuthenticationException;\nimport org.springframework.security.web.AuthenticationEntryPoint;\nimport org.springframework.stereotype.Component;\nimport java.io.IOException;\n\n@Component\npublic class JwtAuthenticationEntryPoint implements AuthenticationEntryPoint {\n\n    @Override\n    public void commence(\n            HttpServletRequest request,\n            HttpServletResponse response,\n            AuthenticationException authException\n    ) throws IOException, ServletException {\n        response.setContentType("application/json");\n        response.setStatus(HttpServletResponse.SC_UNAUTHORIZED);\n        response.getWriter().write("{\\"error\\": \\"Unauthorized\\", \\"message\\": \\"" +\n            authException.getMessage() + "\\"}");\n    }\n}\n\n// CustomUserDetailsService.java\npackage com.example.auth.security;\n\nimport com.example.auth.entity.User;\nimport com.example.auth.repository.UserRepository;\nimport lombok.RequiredArgsConstructor;\nimport org.springframework.security.core.GrantedAuthority;\nimport org.springframework.security.core.authority.SimpleGrantedAuthority;\nimport org.springframework.security.core.userdetails.UserDetails;\nimport org.springframework.security.core.userdetails.UserDetailsService;\nimport org.springframework.security.core.userdetails.UsernameNotFoundException;\nimport org.springframework.stereotype.Service;\nimport java.util.Collection;\nimport java.util.stream.Collectors;\n\n@Service\n@RequiredArgsConstructor\npublic class CustomUserDetailsService implements UserDetailsService {\n\n    private final UserRepository userRepository;\n\n    @Override\n    public UserDetails loadUserByUsername(String email) throws UsernameNotFoundException {\n        User user = userRepository.findByEmail(email)\n                .orElseThrow(() -> new UsernameNotFoundException("User not found: " + email));\n\n        return org.springframework.security.core.userdetails.User.builder()\n                .username(user.getEmail())\n                .password(user.getPassword())\n                .authorities(getAuthorities(user))\n                .accountExpired(false)\n                .accountLocked(false)\n                .credentialsExpired(false)\n                .disabled(!user.isEmailVerified())\n                .build();\n    }\n\n    private Collection<? extends GrantedAuthority> getAuthorities(User user) {\n        return user.getRoles().stream()\n                .flatMap(role -> {\n                    var roleAuthority = new SimpleGrantedAuthority("ROLE_" + role.getName());\n                    var permissions = role.getPermissions().stream()\n                            .map(permission -> new SimpleGrantedAuthority(permission.getName()))\n                            .collect(Collectors.toList());\n                    permissions.add(roleAuthority);\n                    return permissions.stream();\n                })\n                .collect(Collectors.toSet());\n    }\n}\n'})}),"\n",(0,r.jsx)(n.h4,{id:"8-dtos-data-transfer-objects",children:"8. DTOs (Data Transfer Objects)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'// LoginRequest.java\npackage com.example.auth.dto;\n\nimport jakarta.validation.constraints.Email;\nimport jakarta.validation.constraints.NotBlank;\nimport lombok.Data;\n\n@Data\npublic class LoginRequest {\n    @NotBlank(message = "Email is required")\n    @Email(message = "Invalid email format")\n    private String email;\n\n    @NotBlank(message = "Password is required")\n    private String password;\n\n    private String mfaCode;\n}\n\n// RegisterRequest.java\npackage com.example.auth.dto;\n\nimport jakarta.validation.constraints.Email;\nimport jakarta.validation.constraints.NotBlank;\nimport jakarta.validation.constraints.Size;\nimport lombok.Data;\n\n@Data\npublic class RegisterRequest {\n    @NotBlank(message = "Name is required")\n    private String name;\n\n    @NotBlank(message = "Email is required")\n    @Email(message = "Invalid email format")\n    private String email;\n\n    @NotBlank(message = "Password is required")\n    @Size(min = 8, message = "Password must be at least 8 characters")\n    private String password;\n\n    private String phoneNumber;\n}\n\n// AuthResponse.java\npackage com.example.auth.dto;\n\nimport lombok.AllArgsConstructor;\nimport lombok.Builder;\nimport lombok.Data;\nimport lombok.NoArgsConstructor;\n\n@Data\n@Builder\n@NoArgsConstructor\n@AllArgsConstructor\npublic class AuthResponse {\n    private String accessToken;\n    private String tokenType = "Bearer";\n    private UserDto user;\n    private boolean mfaRequired;\n}\n\n// UserDto.java\npackage com.example.auth.dto;\n\nimport lombok.AllArgsConstructor;\nimport lombok.Builder;\nimport lombok.Data;\nimport lombok.NoArgsConstructor;\nimport java.util.Set;\n\n@Data\n@Builder\n@NoArgsConstructor\n@AllArgsConstructor\npublic class UserDto {\n    private String id;\n    private String email;\n    private String name;\n    private String phoneNumber;\n    private boolean emailVerified;\n    private boolean mfaEnabled;\n    private Set<String> roles;\n    private Set<String> permissions;\n}\n\n// RefreshTokenRequest.java\npackage com.example.auth.dto;\n\nimport lombok.Data;\n\n@Data\npublic class RefreshTokenRequest {\n    private String refreshToken;\n}\n\n// MessageResponse.java\npackage com.example.auth.dto;\n\nimport lombok.AllArgsConstructor;\nimport lombok.Data;\n\n@Data\n@AllArgsConstructor\npublic class MessageResponse {\n    private String message;\n}\n\n// ErrorResponse.java\npackage com.example.auth.dto;\n\nimport lombok.AllArgsConstructor;\nimport lombok.Builder;\nimport lombok.Data;\nimport lombok.NoArgsConstructor;\nimport java.time.LocalDateTime;\n\n@Data\n@Builder\n@NoArgsConstructor\n@AllArgsConstructor\npublic class ErrorResponse {\n    private String error;\n    private String message;\n    private int status;\n    private LocalDateTime timestamp;\n}\n'})}),"\n",(0,r.jsx)(n.h4,{id:"9-authentication-service",children:"9. Authentication Service"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'// AuthService.java\npackage com.example.auth.service;\n\nimport com.example.auth.dto.*;\nimport com.example.auth.entity.*;\nimport com.example.auth.repository.*;\nimport com.example.auth.util.JwtUtil;\nimport lombok.RequiredArgsConstructor;\nimport org.springframework.beans.factory.annotation.Value;\nimport org.springframework.security.authentication.AuthenticationManager;\nimport org.springframework.security.authentication.UsernamePasswordAuthenticationToken;\nimport org.springframework.security.core.Authentication;\nimport org.springframework.security.core.userdetails.UsernameNotFoundException;\nimport org.springframework.security.crypto.password.PasswordEncoder;\nimport org.springframework.stereotype.Service;\nimport org.springframework.transaction.annotation.Transactional;\nimport jakarta.servlet.http.Cookie;\nimport jakarta.servlet.http.HttpServletResponse;\nimport java.time.LocalDateTime;\nimport java.util.*;\nimport java.util.stream.Collectors;\n\n@Service\n@RequiredArgsConstructor\npublic class AuthService {\n\n    private final UserRepository userRepository;\n    private final RoleRepository roleRepository;\n    private final RefreshTokenRepository refreshTokenRepository;\n    private final OtpTokenRepository otpTokenRepository;\n    private final PasswordEncoder passwordEncoder;\n    private final JwtUtil jwtUtil;\n    private final AuthenticationManager authenticationManager;\n    private final EmailService emailService;\n    private final MfaService mfaService;\n\n    @Value("${jwt.refresh-token-expiration}")\n    private Long refreshTokenExpiration;\n\n    @Value("${cookie.max-age}")\n    private int cookieMaxAge;\n\n    // Register new user\n    @Transactional\n    public AuthResponse register(RegisterRequest request) {\n        // Check if user already exists\n        if (userRepository.existsByEmail(request.getEmail())) {\n            throw new RuntimeException("Email already registered");\n        }\n\n        // Create new user\n        User user = User.builder()\n                .email(request.getEmail())\n                .name(request.getName())\n                .password(passwordEncoder.encode(request.getPassword()))\n                .phoneNumber(request.getPhoneNumber())\n                .isEmailVerified(false)\n                .isMfaEnabled(false)\n                .build();\n\n        // Assign default role\n        Role userRole = roleRepository.findByName(RoleType.USER)\n                .orElseThrow(() -> new RuntimeException("Default role not found"));\n        user.getRoles().add(userRole);\n\n        userRepository.save(user);\n\n        // Send verification email\n        String otp = generateOtp();\n        saveOtp(user.getEmail(), otp, OtpType.EMAIL_VERIFICATION);\n        emailService.sendVerificationEmail(user.getEmail(), otp);\n\n        return AuthResponse.builder()\n                .user(mapToUserDto(user))\n                .build();\n    }\n\n    // Login\n    @Transactional\n    public AuthResponse login(LoginRequest request, HttpServletResponse response) {\n        // Authenticate user\n        Authentication authentication = authenticationManager.authenticate(\n                new UsernamePasswordAuthenticationToken(\n                        request.getEmail(),\n                        request.getPassword()\n                )\n        );\n\n        User user = userRepository.findByEmail(request.getEmail())\n                .orElseThrow(() -> new UsernameNotFoundException("User not found"));\n\n        // Check MFA\n        if (user.isMfaEnabled()) {\n            if (request.getMfaCode() == null) {\n                return AuthResponse.builder()\n                        .mfaRequired(true)\n                        .build();\n            }\n\n            boolean isValid = mfaService.verifyTotp(user.getMfaSecret(), request.getMfaCode());\n            if (!isValid) {\n                throw new RuntimeException("Invalid MFA code");\n            }\n        }\n\n        // Generate tokens\n        Map<String, Object> claims = buildClaims(user);\n        String accessToken = jwtUtil.generateAccessToken(\n                (org.springframework.security.core.userdetails.UserDetails) authentication.getPrincipal(),\n                claims\n        );\n        String refreshToken = jwtUtil.generateRefreshToken(user.getEmail());\n\n        // Save refresh token\n        saveRefreshToken(user, refreshToken);\n\n        // Set refresh token as HttpOnly cookie\n        setRefreshTokenCookie(response, refreshToken);\n\n        return AuthResponse.builder()\n                .accessToken(accessToken)\n                .user(mapToUserDto(user))\n                .mfaRequired(false)\n                .build();\n    }\n\n    // Refresh access token\n    @Transactional\n    public AuthResponse refreshAccessToken(String refreshToken) {\n        // Verify refresh token\n        String username = jwtUtil.extractUsername(refreshToken);\n\n        User user = userRepository.findByEmail(username)\n                .orElseThrow(() -> new UsernameNotFoundException("User not found"));\n\n        // Check if refresh token exists in database\n        RefreshToken storedToken = refreshTokenRepository.findByToken(refreshToken)\n                .orElseThrow(() -> new RuntimeException("Refresh token not found"));\n\n        if (storedToken.isExpired()) {\n            refreshTokenRepository.delete(storedToken);\n            throw new RuntimeException("Refresh token expired");\n        }\n\n        // Generate new access token\n        Map<String, Object> claims = buildClaims(user);\n        String accessToken = jwtUtil.generateAccessToken(\n                org.springframework.security.core.userdetails.User.builder()\n                        .username(user.getEmail())\n                        .password(user.getPassword())\n                        .authorities(Collections.emptyList())\n                        .build(),\n                claims\n        );\n\n        return AuthResponse.builder()\n                .accessToken(accessToken)\n                .user(mapToUserDto(user))\n                .build();\n    }\n\n    // Logout\n    @Transactional\n    public void logout(String refreshToken, HttpServletResponse response) {\n        if (refreshToken != null) {\n            refreshTokenRepository.deleteByToken(refreshToken);\n        }\n\n        // Clear cookie\n        Cookie cookie = new Cookie("refreshToken", null);\n        cookie.setHttpOnly(true);\n        cookie.setSecure(true);\n        cookie.setPath("/");\n        cookie.setMaxAge(0);\n        response.addCookie(cookie);\n    }\n\n    // Verify email\n    @Transactional\n    public MessageResponse verifyEmail(String email, String otp) {\n        OtpToken otpToken = otpTokenRepository\n                .findByEmailAndOtpAndType(email, otp, OtpType.EMAIL_VERIFICATION)\n                .orElseThrow(() -> new RuntimeException("Invalid OTP"));\n\n        if (otpToken.isExpired() || otpToken.isUsed()) {\n            throw new RuntimeException("OTP expired or already used");\n        }\n\n        User user = userRepository.findByEmail(email)\n                .orElseThrow(() -> new UsernameNotFoundException("User not found"));\n\n        user.setEmailVerified(true);\n        userRepository.save(user);\n\n        otpToken.setUsed(true);\n        otpTokenRepository.save(otpToken);\n\n        return new MessageResponse("Email verified successfully");\n    }\n\n    // Forgot password\n    @Transactional\n    public MessageResponse forgotPassword(String email) {\n        User user = userRepository.findByEmail(email)\n                .orElseThrow(() -> new UsernameNotFoundException("User not found"));\n\n        String otp = generateOtp();\n        saveOtp(email, otp, OtpType.PASSWORD_RESET);\n        emailService.sendPasswordResetEmail(email, otp);\n\n        return new MessageResponse("Password reset OTP sent to email");\n    }\n\n    // Reset password\n    @Transactional\n    public MessageResponse resetPassword(String email, String otp, String newPassword) {\n        OtpToken otpToken = otpTokenRepository\n                .findByEmailAndOtpAndType(email, otp, OtpType.PASSWORD_RESET)\n                .orElseThrow(() -> new RuntimeException("Invalid OTP"));\n\n        if (otpToken.isExpired() || otpToken.isUsed()) {\n            throw new RuntimeException("OTP expired or already used");\n        }\n\n        User user = userRepository.findByEmail(email)\n                .orElseThrow(() -> new UsernameNotFoundException("User not found"));\n\n        user.setPassword(passwordEncoder.encode(newPassword));\n        userRepository.save(user);\n\n        otpToken.setUsed(true);\n        otpTokenRepository.save(otpToken);\n\n        // Invalidate all refresh tokens\n        refreshTokenRepository.deleteByUser(user);\n\n        return new MessageResponse("Password reset successful");\n    }\n\n    // Helper methods\n    private Map<String, Object> buildClaims(User user) {\n        Map<String, Object> claims = new HashMap<>();\n        claims.put("userId", user.getId());\n        claims.put("name", user.getName());\n        claims.put("roles", user.getRoles().stream()\n                .map(role -> role.getName().toString())\n                .collect(Collectors.toList()));\n        claims.put("permissions", user.getRoles().stream()\n                .flatMap(role -> role.getPermissions().stream())\n                .map(Permission::getName)\n                .collect(Collectors.toSet()));\n        return claims;\n    }\n\n    private UserDto mapToUserDto(User user) {\n        return UserDto.builder()\n                .id(user.getId())\n                .email(user.getEmail())\n                .name(user.getName())\n                .phoneNumber(user.getPhoneNumber())\n                .emailVerified(user.isEmailVerified())\n                .mfaEnabled(user.isMfaEnabled())\n                .roles(user.getRoles().stream()\n                        .map(role -> role.getName().toString())\n                        .collect(Collectors.toSet()))\n                .permissions(user.getRoles().stream()\n                        .flatMap(role -> role.getPermissions().stream())\n                        .map(Permission::getName)\n                        .collect(Collectors.toSet()))\n                .build();\n    }\n\n    private void saveRefreshToken(User user, String token) {\n        RefreshToken refreshToken = RefreshToken.builder()\n                .token(token)\n                .user(user)\n                .expiresAt(LocalDateTime.now().plusSeconds(refreshTokenExpiration / 1000))\n                .build();\n        refreshTokenRepository.save(refreshToken);\n    }\n\n    private void setRefreshTokenCookie(HttpServletResponse response, String token) {\n        Cookie cookie = new Cookie("refreshToken", token);\n        cookie.setHttpOnly(true);\n        cookie.setSecure(true);\n        cookie.setPath("/");\n        cookie.setMaxAge(cookieMaxAge);\n        response.addCookie(cookie);\n    }\n\n    private String generateOtp() {\n        Random random = new Random();\n        return String.format("%06d", random.nextInt(999999));\n    }\n\n    private void saveOtp(String email, String otp, OtpType type) {\n        otpTokenRepository.deleteByEmail(email);\n\n        OtpToken otpToken = OtpToken.builder()\n                .email(email)\n                .otp(otp)\n                .type(type)\n                .expiresAt(LocalDateTime.now().plusMinutes(10))\n                .build();\n        otpTokenRepository.save(otpToken);\n    }\n}\n'})}),"\n",(0,r.jsx)(n.h4,{id:"10-mfa-service",children:"10. MFA Service"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'// MfaService.java\npackage com.example.auth.service;\n\nimport com.warrenstrange.googleauth.GoogleAuthenticator;\nimport com.warrenstrange.googleauth.GoogleAuthenticatorKey;\nimport com.warrenstrange.googleauth.GoogleAuthenticatorQRGenerator;\nimport lombok.RequiredArgsConstructor;\nimport org.springframework.stereotype.Service;\n\n@Service\n@RequiredArgsConstructor\npublic class MfaService {\n\n    private final GoogleAuthenticator googleAuthenticator = new GoogleAuthenticator();\n\n    // Generate MFA secret\n    public String generateSecret() {\n        GoogleAuthenticatorKey key = googleAuthenticator.createCredentials();\n        return key.getKey();\n    }\n\n    // Generate QR code URL\n    public String generateQrCodeUrl(String email, String secret) {\n        return GoogleAuthenticatorQRGenerator.getOtpAuthURL(\n                "YourAppName",\n                email,\n                new GoogleAuthenticatorKey.Builder(secret).build()\n        );\n    }\n\n    // Verify TOTP code\n    public boolean verifyTotp(String secret, String code) {\n        try {\n            int codeInt = Integer.parseInt(code);\n            return googleAuthenticator.authorize(secret, codeInt);\n        } catch (NumberFormatException e) {\n            return false;\n        }\n    }\n}\n'})}),"\n",(0,r.jsx)(n.h4,{id:"11-email-service",children:"11. Email Service"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'// EmailService.java\npackage com.example.auth.service;\n\nimport lombok.RequiredArgsConstructor;\nimport lombok.extern.slf4j.Slf4j;\nimport org.springframework.mail.SimpleMailMessage;\nimport org.springframework.mail.javamail.JavaMailSender;\nimport org.springframework.stereotype.Service;\n\n@Service\n@RequiredArgsConstructor\n@Slf4j\npublic class EmailService {\n\n    private final JavaMailSender mailSender;\n\n    public void sendVerificationEmail(String to, String otp) {\n        SimpleMailMessage message = new SimpleMailMessage();\n        message.setTo(to);\n        message.setSubject("Email Verification");\n        message.setText("Your verification code is: " + otp +\n                "\\n\\nThis code will expire in 10 minutes.");\n\n        try {\n            mailSender.send(message);\n            log.info("Verification email sent to: {}", to);\n        } catch (Exception e) {\n            log.error("Failed to send verification email: {}", e.getMessage());\n        }\n    }\n\n    public void sendPasswordResetEmail(String to, String otp) {\n        SimpleMailMessage message = new SimpleMailMessage();\n        message.setTo(to);\n        message.setSubject("Password Reset");\n        message.setText("Your password reset code is: " + otp +\n                "\\n\\nThis code will expire in 10 minutes.");\n\n        try {\n            mailSender.send(message);\n            log.info("Password reset email sent to: {}", to);\n        } catch (Exception e) {\n            log.error("Failed to send password reset email: {}", e.getMessage());\n        }\n    }\n}\n'})}),"\n",(0,r.jsx)(n.h4,{id:"12-authentication-controller",children:"12. Authentication Controller"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'// AuthController.java\npackage com.example.auth.controller;\n\nimport com.example.auth.dto.*;\nimport com.example.auth.service.AuthService;\nimport jakarta.servlet.http.Cookie;\nimport jakarta.servlet.http.HttpServletRequest;\nimport jakarta.servlet.http.HttpServletResponse;\nimport jakarta.validation.Valid;\nimport lombok.RequiredArgsConstructor;\nimport org.springframework.http.ResponseEntity;\nimport org.springframework.web.bind.annotation.*;\nimport java.util.Arrays;\n\n@RestController\n@RequestMapping("/auth")\n@RequiredArgsConstructor\npublic class AuthController {\n\n    private final AuthService authService;\n\n    @PostMapping("/register")\n    public ResponseEntity<AuthResponse> register(@Valid @RequestBody RegisterRequest request) {\n        return ResponseEntity.ok(authService.register(request));\n    }\n\n    @PostMapping("/login")\n    public ResponseEntity<AuthResponse> login(\n            @Valid @RequestBody LoginRequest request,\n            HttpServletResponse response) {\n        return ResponseEntity.ok(authService.login(request, response));\n    }\n\n    @PostMapping("/refresh")\n    public ResponseEntity<AuthResponse> refresh(HttpServletRequest request) {\n        String refreshToken = getRefreshTokenFromCookie(request);\n        if (refreshToken == null) {\n            return ResponseEntity.status(401).build();\n        }\n        return ResponseEntity.ok(authService.refreshAccessToken(refreshToken));\n    }\n\n    @PostMapping("/logout")\n    public ResponseEntity<MessageResponse> logout(\n            HttpServletRequest request,\n            HttpServletResponse response) {\n        String refreshToken = getRefreshTokenFromCookie(request);\n        authService.logout(refreshToken, response);\n        return ResponseEntity.ok(new MessageResponse("Logged out successfully"));\n    }\n\n    @PostMapping("/verify-email")\n    public ResponseEntity<MessageResponse> verifyEmail(\n            @RequestParam String email,\n            @RequestParam String otp) {\n        return ResponseEntity.ok(authService.verifyEmail(email, otp));\n    }\n\n    @PostMapping("/forgot-password")\n    public ResponseEntity<MessageResponse> forgotPassword(@RequestParam String email) {\n        return ResponseEntity.ok(authService.forgotPassword(email));\n    }\n\n    @PostMapping("/reset-password")\n    public ResponseEntity<MessageResponse> resetPassword(\n            @RequestParam String email,\n            @RequestParam String otp,\n            @RequestParam String newPassword) {\n        return ResponseEntity.ok(authService.resetPassword(email, otp, newPassword));\n    }\n\n    private String getRefreshTokenFromCookie(HttpServletRequest request) {\n        if (request.getCookies() == null) {\n            return null;\n        }\n        return Arrays.stream(request.getCookies())\n                .filter(cookie -> "refreshToken".equals(cookie.getName()))\n                .findFirst()\n                .map(Cookie::getValue)\n                .orElse(null);\n    }\n}\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"react-frontend-implementation",children:"React Frontend Implementation"}),"\n",(0,r.jsx)(n.h3,{id:"1-project-setup",children:"1. Project Setup"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Create React app with Vite\nnpm create vite@latest auth-frontend -- --template react\ncd auth-frontend\n\n# Install dependencies\nnpm install axios react-router-dom @tanstack/react-query\nnpm install -D tailwindcss postcss autoprefixer\nnpx tailwindcss init -p\n"})}),"\n",(0,r.jsx)(n.h3,{id:"2-api-configuration",children:"2. API Configuration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// src/api/axios.js\nimport axios from 'axios';\n\nconst api = axios.create({\n  baseURL: 'http://localhost:8080/api',\n  withCredentials: true,\n  headers: {\n    'Content-Type': 'application/json',\n  },\n});\n\n// Store access token in memory\nlet accessToken = null;\n\nexport const setAccessToken = (token) => {\n  accessToken = token;\n};\n\nexport const getAccessToken = () => accessToken;\n\n// Request interceptor\napi.interceptors.request.use(\n  (config) => {\n    if (accessToken) {\n      config.headers.Authorization = `Bearer ${accessToken}`;\n    }\n    return config;\n  },\n  (error) => Promise.reject(error)\n);\n\n// Response interceptor\napi.interceptors.response.use(\n  (response) => response,\n  async (error) => {\n    const originalRequest = error.config;\n\n    if (error.response?.status === 401 && !originalRequest._retry) {\n      originalRequest._retry = true;\n\n      try {\n        const response = await axios.post(\n          'http://localhost:8080/api/auth/refresh',\n          {},\n          { withCredentials: true }\n        );\n\n        const { accessToken: newToken } = response.data;\n        setAccessToken(newToken);\n\n        originalRequest.headers.Authorization = `Bearer ${newToken}`;\n        return api(originalRequest);\n      } catch (refreshError) {\n        setAccessToken(null);\n        window.location.href = '/login';\n        return Promise.reject(refreshError);\n      }\n    }\n\n    return Promise.reject(error);\n  }\n);\n\nexport default api;\n"})}),"\n",(0,r.jsx)(n.h3,{id:"3-authentication-context",children:"3. Authentication Context"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// src/context/AuthContext.jsx\nimport { createContext, useContext, useState, useEffect } from 'react';\nimport api, { setAccessToken, getAccessToken } from '../api/axios';\n\nconst AuthContext = createContext(null);\n\nexport function AuthProvider({ children }) {\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    checkAuth();\n  }, []);\n\n  const checkAuth = async () => {\n    try {\n      const response = await api.post('/auth/refresh');\n      setAccessToken(response.data.accessToken);\n      setUser(response.data.user);\n    } catch (error) {\n      console.error('Not authenticated');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const login = async (email, password, mfaCode = null) => {\n    const response = await api.post('/auth/login', {\n      email,\n      password,\n      mfaCode,\n    });\n\n    if (response.data.mfaRequired) {\n      return { mfaRequired: true };\n    }\n\n    setAccessToken(response.data.accessToken);\n    setUser(response.data.user);\n    return { success: true };\n  };\n\n  const register = async (data) => {\n    const response = await api.post('/auth/register', data);\n    return response.data;\n  };\n\n  const logout = async () => {\n    try {\n      await api.post('/auth/logout');\n    } catch (error) {\n      console.error('Logout error:', error);\n    } finally {\n      setAccessToken(null);\n      setUser(null);\n      window.location.href = '/login';\n    }\n  };\n\n  const verifyEmail = async (email, otp) => {\n    const response = await api.post('/auth/verify-email', null, {\n      params: { email, otp },\n    });\n    return response.data;\n  };\n\n  const forgotPassword = async (email) => {\n    const response = await api.post('/auth/forgot-password', null, {\n      params: { email },\n    });\n    return response.data;\n  };\n\n  const resetPassword = async (email, otp, newPassword) => {\n    const response = await api.post('/auth/reset-password', null, {\n      params: { email, otp, newPassword },\n    });\n    return response.data;\n  };\n\n  const value = {\n    user,\n    loading,\n    login,\n    register,\n    logout,\n    verifyEmail,\n    forgotPassword,\n    resetPassword,\n    hasRole: (role) => user?.roles?.includes(role),\n    hasPermission: (permission) => user?.permissions?.includes(permission),\n  };\n\n  return (\n    <AuthContext.Provider value={value}>\n      {!loading && children}\n    </AuthContext.Provider>\n  );\n}\n\nexport const useAuth = () => {\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error('useAuth must be used within AuthProvider');\n  }\n  return context;\n};\n"})}),"\n",(0,r.jsx)(n.h3,{id:"4-protected-route-component",children:"4. Protected Route Component"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:'// src/components/ProtectedRoute.jsx\nimport { Navigate } from \'react-router-dom\';\nimport { useAuth } from \'../context/AuthContext\';\n\nexport function ProtectedRoute({ children, roles = [], permissions = [] }) {\n  const { user, hasRole, hasPermission } = useAuth();\n\n  if (!user) {\n    return <Navigate to="/login" replace />;\n  }\n\n  if (roles.length > 0 && !roles.some((role) => hasRole(role))) {\n    return <Navigate to="/unauthorized" replace />;\n  }\n\n  if (\n    permissions.length > 0 &&\n    !permissions.some((perm) => hasPermission(perm))\n  ) {\n    return <Navigate to="/unauthorized" replace />;\n  }\n\n  return children;\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"5-login-component",children:"5. Login Component"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:'// src/pages/Login.jsx\nimport { useState } from \'react\';\nimport { useNavigate, Link } from \'react-router-dom\';\nimport { useAuth } from \'../context/AuthContext\';\n\nexport function Login() {\n  const [email, setEmail] = useState(\'\');\n  const [password, setPassword] = useState(\'\');\n  const [mfaCode, setMfaCode] = useState(\'\');\n  const [showMfa, setShowMfa] = useState(false);\n  const [error, setError] = useState(\'\');\n  const [loading, setLoading] = useState(false);\n\n  const { login } = useAuth();\n  const navigate = useNavigate();\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setError(\'\');\n    setLoading(true);\n\n    try {\n      const result = await login(email, password, showMfa ? mfaCode : null);\n\n      if (result.mfaRequired) {\n        setShowMfa(true);\n        setLoading(false);\n        return;\n      }\n\n      if (result.success) {\n        navigate(\'/dashboard\');\n      }\n    } catch (err) {\n      setError(err.response?.data?.message || \'Login failed\');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className="min-h-screen flex items-center justify-center bg-gray-50">\n      <div className="max-w-md w-full space-y-8 p-8 bg-white rounded-lg shadow">\n        <div>\n          <h2 className="text-3xl font-bold text-center">Sign in</h2>\n        </div>\n\n        {error && (\n          <div className="bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded">\n            {error}\n          </div>\n        )}\n\n        <form onSubmit={handleSubmit} className="space-y-6">\n          {!showMfa ? (\n            <>\n              <div>\n                <label className="block text-sm font-medium text-gray-700">\n                  Email\n                </label>\n                <input\n                  type="email"\n                  value={email}\n                  onChange={(e) => setEmail(e.target.value)}\n                  required\n                  className="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md"\n                />\n              </div>\n\n              <div>\n                <label className="block text-sm font-medium text-gray-700">\n                  Password\n                </label>\n                <input\n                  type="password"\n                  value={password}\n                  onChange={(e) => setPassword(e.target.value)}\n                  required\n                  className="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md"\n                />\n              </div>\n            </>\n          ) : (\n            <div>\n              <label className="block text-sm font-medium text-gray-700">\n                MFA Code\n              </label>\n              <input\n                type="text"\n                value={mfaCode}\n                onChange={(e) => setMfaCode(e.target.value)}\n                required\n                maxLength={6}\n                placeholder="Enter 6-digit code"\n                className="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md"\n              />\n            </div>\n          )}\n\n          <button\n            type="submit"\n            disabled={loading}\n            className="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50"\n          >\n            {loading ? \'Signing in...\' : showMfa ? \'Verify MFA\' : \'Sign in\'}\n          </button>\n        </form>\n\n        <div className="text-center space-y-2">\n          <Link to="/forgot-password" className="text-sm text-blue-600 hover:underline">\n            Forgot password?\n          </Link>\n          <div>\n            <span className="text-sm text-gray-600">Don\'t have an account? </span>\n            <Link to="/register" className="text-sm text-blue-600 hover:underline">\n              Sign up\n            </Link>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"6-register-component",children:"6. Register Component"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:'// src/pages/Register.jsx\nimport { useState } from \'react\';\nimport { useNavigate, Link } from \'react-router-dom\';\nimport { useAuth } from \'../context/AuthContext\';\n\nexport function Register() {\n  const [formData, setFormData] = useState({\n    name: \'\',\n    email: \'\',\n    password: \'\',\n    confirmPassword: \'\',\n    phoneNumber: \'\',\n  });\n  const [error, setError] = useState(\'\');\n  const [loading, setLoading] = useState(false);\n  const [success, setSuccess] = useState(false);\n\n  const { register } = useAuth();\n  const navigate = useNavigate();\n\n  const handleChange = (e) => {\n    setFormData({ ...formData, [e.target.name]: e.target.value });\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setError(\'\');\n    setLoading(true);\n\n    if (formData.password !== formData.confirmPassword) {\n      setError(\'Passwords do not match\');\n      setLoading(false);\n      return;\n    }\n\n    if (formData.password.length < 8) {\n      setError(\'Password must be at least 8 characters\');\n      setLoading(false);\n      return;\n    }\n\n    try {\n      await register({\n        name: formData.name,\n        email: formData.email,\n        password: formData.password,\n        phoneNumber: formData.phoneNumber,\n      });\n      setSuccess(true);\n      setTimeout(() => navigate(\'/verify-email\', { state: { email: formData.email } }), 2000);\n    } catch (err) {\n      setError(err.response?.data?.message || \'Registration failed\');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (success) {\n    return (\n      <div className="min-h-screen flex items-center justify-center bg-gray-50">\n        <div className="max-w-md w-full p-8 bg-white rounded-lg shadow text-center">\n          <div className="text-green-600 text-5xl mb-4">\u2713</div>\n          <h2 className="text-2xl font-bold mb-2">Registration Successful!</h2>\n          <p className="text-gray-600">Check your email for verification code.</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className="min-h-screen flex items-center justify-center bg-gray-50">\n      <div className="max-w-md w-full space-y-8 p-8 bg-white rounded-lg shadow">\n        <div>\n          <h2 className="text-3xl font-bold text-center">Create Account</h2>\n        </div>\n\n        {error && (\n          <div className="bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded">\n            {error}\n          </div>\n        )}\n\n        <form onSubmit={handleSubmit} className="space-y-6">\n          <div>\n            <label className="block text-sm font-medium text-gray-700">\n              Name\n            </label>\n            <input\n              type="text"\n              name="name"\n              value={formData.name}\n              onChange={handleChange}\n              required\n              className="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md"\n            />\n          </div>\n\n          <div>\n            <label className="block text-sm font-medium text-gray-700">\n              Email\n            </label>\n            <input\n              type="email"\n              name="email"\n              value={formData.email}\n              onChange={handleChange}\n              required\n              className="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md"\n            />\n          </div>\n\n          <div>\n            <label className="block text-sm font-medium text-gray-700">\n              Phone Number (Optional)\n            </label>\n            <input\n              type="tel"\n              name="phoneNumber"\n              value={formData.phoneNumber}\n              onChange={handleChange}\n              className="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md"\n            />\n          </div>\n\n          <div>\n            <label className="block text-sm font-medium text-gray-700">\n              Password\n            </label>\n            <input\n              type="password"\n              name="password"\n              value={formData.password}\n              onChange={handleChange}\n              required\n              minLength={8}\n              className="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md"\n            />\n          </div>\n\n          <div>\n            <label className="block text-sm font-medium text-gray-700">\n              Confirm Password\n            </label>\n            <input\n              type="password"\n              name="confirmPassword"\n              value={formData.confirmPassword}\n              onChange={handleChange}\n              required\n              className="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md"\n            />\n          </div>\n\n          <button\n            type="submit"\n            disabled={loading}\n            className="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50"\n          >\n            {loading ? \'Creating account...\' : \'Sign up\'}\n          </button>\n        </form>\n\n        <div className="text-center">\n          <span className="text-sm text-gray-600">Already have an account? </span>\n          <Link to="/login" className="text-sm text-blue-600 hover:underline">\n            Sign in\n          </Link>\n        </div>\n      </div>\n    </div>\n  );\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"7-email-verification-component",children:"7. Email Verification Component"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:'// src/pages/VerifyEmail.jsx\nimport { useState } from \'react\';\nimport { useNavigate, useLocation } from \'react-router-dom\';\nimport { useAuth } from \'../context/AuthContext\';\n\nexport function VerifyEmail() {\n  const [otp, setOtp] = useState(\'\');\n  const [error, setError] = useState(\'\');\n  const [loading, setLoading] = useState(false);\n\n  const { verifyEmail } = useAuth();\n  const navigate = useNavigate();\n  const location = useLocation();\n  const email = location.state?.email;\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setError(\'\');\n    setLoading(true);\n\n    try {\n      await verifyEmail(email, otp);\n      navigate(\'/login\');\n    } catch (err) {\n      setError(err.response?.data?.message || \'Verification failed\');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className="min-h-screen flex items-center justify-center bg-gray-50">\n      <div className="max-w-md w-full space-y-8 p-8 bg-white rounded-lg shadow">\n        <div>\n          <h2 className="text-3xl font-bold text-center">Verify Email</h2>\n          <p className="mt-2 text-center text-sm text-gray-600">\n            Enter the 6-digit code sent to {email}\n          </p>\n        </div>\n\n        {error && (\n          <div className="bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded">\n            {error}\n          </div>\n        )}\n\n        <form onSubmit={handleSubmit} className="space-y-6">\n          <div>\n            <label className="block text-sm font-medium text-gray-700">\n              Verification Code\n            </label>\n            <input\n              type="text"\n              value={otp}\n              onChange={(e) => setOtp(e.target.value)}\n              required\n              maxLength={6}\n              placeholder="000000"\n              className="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md text-center text-2xl tracking-widest"\n            />\n          </div>\n\n          <button\n            type="submit"\n            disabled={loading || otp.length !== 6}\n            className="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50"\n          >\n            {loading ? \'Verifying...\' : \'Verify Email\'}\n          </button>\n        </form>\n      </div>\n    </div>\n  );\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"8-dashboard-component",children:"8. Dashboard Component"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:'// src/pages/Dashboard.jsx\nimport { useAuth } from \'../context/AuthContext\';\n\nexport function Dashboard() {\n  const { user, logout, hasRole, hasPermission } = useAuth();\n\n  return (\n    <div className="min-h-screen bg-gray-50">\n      <nav className="bg-white shadow">\n        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">\n          <div className="flex justify-between h-16">\n            <div className="flex items-center">\n              <h1 className="text-xl font-bold">Dashboard</h1>\n            </div>\n            <div className="flex items-center space-x-4">\n              <span className="text-gray-700">{user?.name}</span>\n              <button\n                onClick={logout}\n                className="px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700"\n              >\n                Logout\n              </button>\n            </div>\n          </div>\n        </div>\n      </nav>\n\n      <main className="max-w-7xl mx-auto py-6 sm:px-6 lg:px-8">\n        <div className="px-4 py-6 sm:px-0">\n          <div className="bg-white shadow rounded-lg p-6">\n            <h2 className="text-2xl font-bold mb-4">Welcome, {user?.name}!</h2>\n\n            <div className="space-y-4">\n              <div>\n                <h3 className="text-lg font-semibold">User Information</h3>\n                <dl className="mt-2 space-y-2">\n                  <div>\n                    <dt className="text-sm font-medium text-gray-500">Email</dt>\n                    <dd className="text-sm text-gray-900">{user?.email}</dd>\n                  </div>\n                  <div>\n                    <dt className="text-sm font-medium text-gray-500">Email Verified</dt>\n                    <dd className="text-sm text-gray-900">\n                      {user?.emailVerified ? (\n                        <span className="text-green-600">\u2713 Verified</span>\n                      ) : (\n                        <span className="text-red-600">\u2717 Not Verified</span>\n                      )}\n                    </dd>\n                  </div>\n                  <div>\n                    <dt className="text-sm font-medium text-gray-500">MFA Enabled</dt>\n                    <dd className="text-sm text-gray-900">\n                      {user?.mfaEnabled ? (\n                        <span className="text-green-600">\u2713 Enabled</span>\n                      ) : (\n                        <span className="text-gray-600">\u2717 Disabled</span>\n                      )}\n                    </dd>\n                  </div>\n                </dl>\n              </div>\n\n              <div>\n                <h3 className="text-lg font-semibold">Roles</h3>\n                <div className="mt-2 flex flex-wrap gap-2">\n                  {user?.roles?.map((role) => (\n                    <span\n                      key={role}\n                      className="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm"\n                    >\n                      {role}\n                    </span>\n                  ))}\n                </div>\n              </div>\n\n              <div>\n                <h3 className="text-lg font-semibold">Permissions</h3>\n                <div className="mt-2 flex flex-wrap gap-2">\n                  {user?.permissions?.map((permission) => (\n                    <span\n                      key={permission}\n                      className="px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm"\n                    >\n                      {permission}\n                    </span>\n                  ))}\n                </div>\n              </div>\n\n              {hasRole(\'ADMIN\') && (\n                <div className="mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded">\n                  <h3 className="text-lg font-semibold text-yellow-800">\n                    Admin Section\n                  </h3>\n                  <p className="text-sm text-yellow-700 mt-2">\n                    You have admin privileges and can access admin features.\n                  </p>\n                </div>\n              )}\n\n              {hasPermission(\'user:create\') && (\n                <div className="mt-6 p-4 bg-purple-50 border border-purple-200 rounded">\n                  <h3 className="text-lg font-semibold text-purple-800">\n                    User Management\n                  </h3>\n                  <p className="text-sm text-purple-700 mt-2">\n                    You can create and manage users.\n                  </p>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      </main>\n    </div>\n  );\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"9-app-router-setup",children:"9. App Router Setup"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// src/App.jsx\nimport { BrowserRouter, Routes, Route, Navigate } from 'react-router-dom';\nimport { AuthProvider } from './context/AuthContext';\nimport { ProtectedRoute } from './components/ProtectedRoute';\nimport { Login } from './pages/Login';\nimport { Register } from './pages/Register';\nimport { VerifyEmail } from './pages/VerifyEmail';\nimport { Dashboard } from './pages/Dashboard';\n\nfunction App() {\n  return (\n    <BrowserRouter>\n      <AuthProvider>\n        <Routes>\n          <Route path=\"/login\" element={<Login />} />\n          <Route path=\"/register\" element={<Register />} />\n          <Route path=\"/verify-email\" element={<VerifyEmail />} />\n\n          <Route\n            path=\"/dashboard\"\n            element={\n              <ProtectedRoute>\n                <Dashboard />\n              </ProtectedRoute>\n            }\n          />\n\n          <Route\n            path=\"/admin\"\n            element={\n              <ProtectedRoute roles={['ADMIN']}>\n                <div>Admin Page</div>\n              </ProtectedRoute>\n            }\n          />\n\n          <Route path=\"/\" element={<Navigate to=\"/dashboard\" replace />} />\n          <Route path=\"/unauthorized\" element={<div>Unauthorized</div>} />\n        </Routes>\n      </AuthProvider>\n    </BrowserRouter>\n  );\n}\n\nexport default App;\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"security-best-practices",children:"Security Best Practices"}),"\n",(0,r.jsx)(n.h3,{id:"password-security",children:"Password Security"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"// Password validation\n@Pattern(\n    regexp = \"^(?=.*[a-z])(?=.*[A-Z])(?=.*\\\\d)(?=.*[@$!%*?&])[A-Za-z\\\\d@$!%*?&]{8,}$\",\n    message = \"Password must contain at least 8 characters, one uppercase, one lowercase, one number and one special character\"\n)\nprivate String password;\n\n// Password strength checker (JavaScript)\nfunction checkPasswordStrength(password) {\n  let strength = 0;\n  if (password.length >= 8) strength++;\n  if (password.length >= 12) strength++;\n  if (/[a-z]/.test(password) && /[A-Z]/.test(password)) strength++;\n  if (/\\d/.test(password)) strength++;\n  if (/[@$!%*?&]/.test(password)) strength++;\n\n  const levels = ['Weak', 'Fair', 'Good', 'Strong', 'Very Strong'];\n  return levels[strength];\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"token-security",children:"Token Security"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Best Practices:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u2705 Use HTTPS in production"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Short-lived access tokens (15 min)"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Long-lived refresh tokens (7-30 days)"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Store refresh tokens in HttpOnly cookies"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Implement token rotation"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Use secure random secrets (256-bit minimum)"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Implement token blacklisting for logout"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"api-security",children:"API Security"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'// Rate limiting with Bucket4j\n@Component\npublic class RateLimitInterceptor implements HandlerInterceptor {\n\n    private final Map<String, Bucket> buckets = new ConcurrentHashMap<>();\n\n    @Override\n    public boolean preHandle(HttpServletRequest request,\n                            HttpServletResponse response,\n                            Object handler) throws Exception {\n        String key = request.getRemoteAddr();\n        Bucket bucket = buckets.computeIfAbsent(key, k -> createBucket());\n\n        if (bucket.tryConsume(1)) {\n            return true;\n        }\n\n        response.setStatus(429);\n        response.getWriter().write("{\\"error\\": \\"Too many requests\\"}");\n        return false;\n    }\n\n    private Bucket createBucket() {\n        return Bucket.builder()\n            .addLimit(Bandwidth.simple(100, Duration.ofMinutes(1)))\n            .build();\n    }\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"common-vulnerabilities",children:"Common Vulnerabilities"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Vulnerability"}),(0,r.jsx)(n.th,{children:"Protection"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"XSS"})}),(0,r.jsx)(n.td,{children:"HttpOnly cookies, CSP headers, input sanitization"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"CSRF"})}),(0,r.jsx)(n.td,{children:"SameSite cookies, CSRF tokens"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"SQL Injection"})}),(0,r.jsx)(n.td,{children:"Parameterized queries, ORM"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Brute Force"})}),(0,r.jsx)(n.td,{children:"Rate limiting, account lockout, CAPTCHA"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Session Fixation"})}),(0,r.jsx)(n.td,{children:"Regenerate session on login"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Man-in-the-Middle"})}),(0,r.jsx)(n.td,{children:"HTTPS only, secure cookies"})]})]})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"production-checklist",children:"Production Checklist"}),"\n",(0,r.jsx)(n.h3,{id:"environment-variables",children:"Environment Variables"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-properties",children:"# Production application.properties\nserver.port=8080\nserver.ssl.enabled=true\nserver.ssl.key-store=classpath:keystore.p12\nserver.ssl.key-store-password=${SSL_PASSWORD}\nserver.ssl.key-store-type=PKCS12\n\nspring.datasource.url=${DB_URL}\nspring.datasource.username=${DB_USERNAME}\nspring.datasource.password=${DB_PASSWORD}\n\njwt.secret=${JWT_SECRET}\njwt.access-token-expiration=900000\njwt.refresh-token-expiration=604800000\n\ncookie.secure=true\ncookie.http-only=true\ncookie.same-site=Strict\n\nspring.mail.host=${MAIL_HOST}\nspring.mail.port=${MAIL_PORT}\nspring.mail.username=${MAIL_USERNAME}\nspring.mail.password=${MAIL_PASSWORD}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"deployment-checklist",children:"Deployment Checklist"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u2705 Enable HTTPS/SSL"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Set secure cookie flags"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Use environment variables for secrets"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Enable CORS for specific origins only"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Implement rate limiting"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Set up monitoring and logging"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Enable database encryption"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Use password strength requirements"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Implement account lockout policies"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Set up automated backups"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Enable audit logging"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Configure firewall rules"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Use CDN for static assets"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Implement health checks"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Set up error tracking (Sentry, etc.)"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,r.jsx)(n.p,{children:"This guide provides a complete, production-ready authentication and authorization system using Spring Boot and React. The implementation includes JWT tokens, RBAC, MFA, OTP verification, and follows security best practices."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Key Features:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u2705 Secure JWT authentication with refresh tokens"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Role-Based Access Control (RBAC)"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Multi-Factor Authentication (MFA)"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Email verification with OTP"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Password reset functionality"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 HttpOnly cookies for token storage"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Protected routes and API endpoints"}),"\n",(0,r.jsx)(n.li,{children:"\u2705 Security best practices implemented"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Next Steps:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Implement OAuth2 SSO (Google, GitHub)"}),"\n",(0,r.jsx)(n.li,{children:"Add biometric authentication"}),"\n",(0,r.jsx)(n.li,{children:"Implement passwordless authentication"}),"\n",(0,r.jsx)(n.li,{children:"Add session management dashboard"}),"\n",(0,r.jsx)(n.li,{children:"Set up audit logging"}),"\n",(0,r.jsx)(n.li,{children:"Implement device fingerprinting"}),"\n",(0,r.jsx)(n.li,{children:"Add backup codes for MFA recovery"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"For production deployment, ensure all security measures are in place and thoroughly test all authentication flows."})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);