"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[6972],{20778:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>c,toc:()=>l});var t=s(74848),i=s(28453);const r={},o="Authentication & Authorization Security",c={id:"WebDev/Web Parts/AuthAndAuthorization",title:"Authentication & Authorization Security",description:"Core Concepts",source:"@site/docs/WebDev/Web Parts/AuthAndAuthorization.mdx",sourceDirName:"WebDev/Web Parts",slug:"/WebDev/Web Parts/AuthAndAuthorization",permalink:"/dev.enigma/docs/WebDev/Web Parts/AuthAndAuthorization",draft:!1,unlisted:!1,editUrl:"https://github.com/carefree-ladka/docs/WebDev/Web Parts/AuthAndAuthorization.mdx",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"TypeScript Operators",permalink:"/dev.enigma/docs/WebDev/TypeScript/TypeScriptOperators"},next:{title:"Web Accessibility",permalink:"/dev.enigma/docs/WebDev/Web Parts/WebAccessibility"}},a={},l=[{value:"Core Concepts",id:"core-concepts",level:2},{value:"Authentication vs Authorization",id:"authentication-vs-authorization",level:3},{value:"Cookie Security",id:"cookie-security",level:2},{value:"Cookie Attributes",id:"cookie-attributes",level:3},{value:"Cookie Security Best Practices",id:"cookie-security-best-practices",level:3},{value:"JWT (JSON Web Tokens)",id:"jwt-json-web-tokens",level:2},{value:"JWT Structure",id:"jwt-structure",level:3},{value:"JWT Implementation",id:"jwt-implementation",level:3},{value:"JWT Best Practices",id:"jwt-best-practices",level:3},{value:"Refresh Token Implementation",id:"refresh-token-implementation",level:2},{value:"Token Flow",id:"token-flow",level:3},{value:"Refresh Token Rotation",id:"refresh-token-rotation",level:3},{value:"CSRF (Cross-Site Request Forgery) Protection",id:"csrf-cross-site-request-forgery-protection",level:2},{value:"CSRF Token Implementation",id:"csrf-token-implementation",level:3},{value:"Double Submit Cookie Pattern",id:"double-submit-cookie-pattern",level:3},{value:"Content Security Policy (CSP)",id:"content-security-policy-csp",level:2},{value:"Basic CSP Implementation",id:"basic-csp-implementation",level:3},{value:"CSP Header Examples",id:"csp-header-examples",level:3},{value:"Security Headers",id:"security-headers",level:2},{value:"Essential Security Headers",id:"essential-security-headers",level:3},{value:"Session Management",id:"session-management",level:2},{value:"Session Configuration",id:"session-configuration",level:3},{value:"Session Security Best Practices",id:"session-security-best-practices",level:3}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"authentication--authorization-security",children:"Authentication & Authorization Security"})}),"\n",(0,t.jsx)(n.h2,{id:"core-concepts",children:"Core Concepts"}),"\n",(0,t.jsx)(n.h3,{id:"authentication-vs-authorization",children:"Authentication vs Authorization"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Authentication (AuthN)\n- Verifies WHO you are\n- Handles user login/identity\n- Examples: passwords, biometrics\n- Comes before authorization\n\nAuthorization (AuthZ)\n- Determines WHAT you can do\n- Handles permissions\n- Examples: admin rights, role-based access\n- Happens after authentication\n"})}),"\n",(0,t.jsx)(n.h2,{id:"cookie-security",children:"Cookie Security"}),"\n",(0,t.jsx)(n.h3,{id:"cookie-attributes",children:"Cookie Attributes"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"// Setting a secure HttpOnly cookie\nres.cookie('sessionId', 'value', {\n    httpOnly: true,     // Cannot be accessed by JavaScript\n    secure: true,       // Only sent over HTTPS\n    sameSite: 'strict', // Protects against CSRF\n    path: '/',          // Cookie scope\n    domain: '.example.com',\n    maxAge: 3600000,    // 1 hour in milliseconds\n    expires: new Date() // Specific date\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"cookie-security-best-practices",children:"Cookie Security Best Practices"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"HttpOnly Cookies"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Prevents XSS attacks accessing cookies"}),"\n",(0,t.jsxs)(n.li,{children:["Cannot be accessed via ",(0,t.jsx)(n.code,{children:"document.cookie"})]}),"\n",(0,t.jsx)(n.li,{children:"Essential for session cookies"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Secure Flag"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Only transmitted over HTTPS"}),"\n",(0,t.jsx)(n.li,{children:"Prevents man-in-the-middle attacks"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"SameSite Attribute"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"// Strict: Cookie only sent in first-party context\nsameSite: 'strict'\n\n// Lax: Sent with navigation to origin site\nsameSite: 'lax'\n\n// None: Cookie sent in all contexts (requires Secure)\nsameSite: 'none'\n"})}),"\n",(0,t.jsx)(n.h2,{id:"jwt-json-web-tokens",children:"JWT (JSON Web Tokens)"}),"\n",(0,t.jsx)(n.h3,{id:"jwt-structure",children:"JWT Structure"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'Header.Payload.Signature\n\nHeader: {\n  "alg": "HS256",\n  "typ": "JWT"\n}\n\nPayload: {\n  "sub": "1234567890",\n  "name": "John Doe",\n  "exp": 1516239022\n}\n\nSignature: HMACSHA256(\n  base64UrlEncode(header) + "." +\n  base64UrlEncode(payload),\n  secret\n)\n'})}),"\n",(0,t.jsx)(n.h3,{id:"jwt-implementation",children:"JWT Implementation"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"// Creating a JWT\nconst token = jwt.sign(\n    { userId: user.id },\n    process.env.JWT_SECRET,\n    { \n        expiresIn: '15m',\n        algorithm: 'HS256'\n    }\n);\n\n// Verifying a JWT\ntry {\n    const decoded = jwt.verify(token, process.env.JWT_SECRET);\n    // decoded.userId is now available\n} catch (err) {\n    // Token invalid or expired\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"jwt-best-practices",children:"JWT Best Practices"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Token Storage"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Store in HttpOnly cookie (preferred)"}),"\n",(0,t.jsx)(n.li,{children:"Never in localStorage (XSS vulnerable)"}),"\n",(0,t.jsx)(n.li,{children:"Consider memory storage for SPAs"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Security Measures"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Short expiration times (15min recommended)"}),"\n",(0,t.jsx)(n.li,{children:"Use refresh tokens for longevity"}),"\n",(0,t.jsx)(n.li,{children:"Include only necessary payload data"}),"\n",(0,t.jsx)(n.li,{children:"Use strong secrets (min 256 bits)"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"refresh-token-implementation",children:"Refresh Token Implementation"}),"\n",(0,t.jsx)(n.h3,{id:"token-flow",children:"Token Flow"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"// Initial authentication\nconst authToken = generateJWT(user, '15m');\nconst refreshToken = generateRefreshToken(user);\n\n// Store refresh token in database\nawait storeRefreshToken(user.id, refreshToken);\n\n// Send tokens to client\nres.cookie('authToken', authToken, {\n    httpOnly: true,\n    secure: true,\n    sameSite: 'strict',\n    maxAge: 900000 // 15 minutes\n});\n\nres.cookie('refreshToken', refreshToken, {\n    httpOnly: true,\n    secure: true,\n    sameSite: 'strict',\n    path: '/refresh', // Restrict to refresh endpoint\n    maxAge: 7776000000 // 90 days\n});\n"})}),"\n",(0,t.jsx)(n.h3,{id:"refresh-token-rotation",children:"Refresh Token Rotation"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"async function handleRefresh(refreshToken) {\n    // Verify refresh token\n    const storedToken = await getStoredRefreshToken(refreshToken);\n    if (!storedToken || storedToken.revoked) {\n        throw new Error('Invalid refresh token');\n    }\n\n    // Generate new tokens\n    const newAuthToken = generateJWT(user, '15m');\n    const newRefreshToken = generateRefreshToken(user);\n\n    // Revoke old refresh token\n    await revokeRefreshToken(refreshToken);\n    \n    // Store new refresh token\n    await storeRefreshToken(user.id, newRefreshToken);\n\n    return { newAuthToken, newRefreshToken };\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"csrf-cross-site-request-forgery-protection",children:"CSRF (Cross-Site Request Forgery) Protection"}),"\n",(0,t.jsx)(n.h3,{id:"csrf-token-implementation",children:"CSRF Token Implementation"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"// Generate CSRF token\nconst csrfToken = crypto.randomBytes(32).toString('hex');\n\n// Store token in session\nreq.session.csrfToken = csrfToken;\n\n// Send token to client\nres.cookie('XSRF-TOKEN', csrfToken, {\n    secure: true,\n    sameSite: 'strict'\n});\n\n// Verify token in middleware\nfunction validateCSRF(req, res, next) {\n    const token = req.headers['x-csrf-token'] || \n                 req.body._csrf ||\n                 req.cookies['XSRF-TOKEN'];\n\n    if (!token || token !== req.session.csrfToken) {\n        return res.status(403).json({ error: 'CSRF token invalid' });\n    }\n    next();\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"double-submit-cookie-pattern",children:"Double Submit Cookie Pattern"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"// Set CSRF token in cookie and form field\nfunction setCSRFToken(req, res) {\n    const token = crypto.randomBytes(32).toString('hex');\n    res.cookie('csrfToken', token, { \n        httpOnly: false,\n        secure: true \n    });\n    return token;\n}\n\n// Validate token match\nfunction validateToken(req) {\n    return req.cookies.csrfToken === req.headers['x-csrf-token'];\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"content-security-policy-csp",children:"Content Security Policy (CSP)"}),"\n",(0,t.jsx)(n.h3,{id:"basic-csp-implementation",children:"Basic CSP Implementation"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:'// Using helmet middleware in Express\napp.use(helmet.contentSecurityPolicy({\n    directives: {\n        defaultSrc: ["\'self\'"],\n        scriptSrc: ["\'self\'", "\'unsafe-inline\'"],\n        styleSrc: ["\'self\'", "\'unsafe-inline\'"],\n        imgSrc: ["\'self\'", "data:", "https:"],\n        connectSrc: ["\'self\'", "https://api.example.com"],\n        fontSrc: ["\'self\'", "https://fonts.gstatic.com"],\n        objectSrc: ["\'none\'"],\n        mediaSrc: ["\'self\'"],\n        frameSrc: ["\'none\'"]\n    }\n}));\n'})}),"\n",(0,t.jsx)(n.h3,{id:"csp-header-examples",children:"CSP Header Examples"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-http",children:"// Basic security\nContent-Security-Policy: default-src 'self'\n\n// Allow specific sources\nContent-Security-Policy: \n    default-src 'self'; \n    script-src 'self' https://trusted.com;\n    style-src 'self' 'unsafe-inline';\n    img-src 'self' data: https:;\n    font-src 'self' https://fonts.gstatic.com;\n    frame-src 'none';\n    base-uri 'self';\n    form-action 'self'\n\n// Report-only mode\nContent-Security-Policy-Report-Only: \n    default-src 'self';\n    report-uri /csp-violation-report\n"})}),"\n",(0,t.jsx)(n.h2,{id:"security-headers",children:"Security Headers"}),"\n",(0,t.jsx)(n.h3,{id:"essential-security-headers",children:"Essential Security Headers"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"// Using helmet in Express\napp.use(helmet({\n    // Strict Transport Security\n    hsts: {\n        maxAge: 31536000,\n        includeSubDomains: true,\n        preload: true\n    },\n    \n    // Prevent clickjacking\n    frameguard: {\n        action: 'deny'\n    },\n    \n    // Disable MIME type sniffing\n    noSniff: true,\n    \n    // XSS Protection\n    xssFilter: true,\n    \n    // Referrer Policy\n    referrerPolicy: { \n        policy: 'strict-origin-when-cross-origin' \n    }\n}));\n"})}),"\n",(0,t.jsx)(n.h2,{id:"session-management",children:"Session Management"}),"\n",(0,t.jsx)(n.h3,{id:"session-configuration",children:"Session Configuration"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"// Express session configuration\napp.use(session({\n    secret: process.env.SESSION_SECRET,\n    name: 'sessionId', // Custom cookie name\n    cookie: {\n        httpOnly: true,\n        secure: true,\n        sameSite: 'strict',\n        maxAge: 3600000 // 1 hour\n    },\n    resave: false,\n    saveUninitialized: false,\n    store: new RedisStore({\n        client: redisClient,\n        prefix: 'sess:'\n    })\n}));\n"})}),"\n",(0,t.jsx)(n.h3,{id:"session-security-best-practices",children:"Session Security Best Practices"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Session ID Management"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Use cryptographically secure random IDs"}),"\n",(0,t.jsx)(n.li,{children:"Rotate session IDs after login"}),"\n",(0,t.jsx)(n.li,{children:"Invalidate on logout/timeout"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Session Storage"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Use server-side storage (Redis/Memcached)"}),"\n",(0,t.jsx)(n.li,{children:"Never store sensitive data in cookie"}),"\n",(0,t.jsx)(n.li,{children:"Implement session expiration"}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Session Validation"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Validate IP address consistency"}),"\n",(0,t.jsx)(n.li,{children:"Check User-Agent consistency"}),"\n",(0,t.jsx)(n.li,{children:"Implement absolute/idle timeouts"}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>c});var t=s(96540);const i={},r=t.createContext(i);function o(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);