"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[6972],{778:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>i,metadata:()=>c,toc:()=>l});var s=r(4848),t=r(8453);const i={},o="Authentication & Authorization Security",c={id:"WebDev/Web Parts/AuthAndAuthorization",title:"Authentication & Authorization Security",description:"Core Concepts",source:"@site/docs/WebDev/Web Parts/AuthAndAuthorization.mdx",sourceDirName:"WebDev/Web Parts",slug:"/WebDev/Web Parts/AuthAndAuthorization",permalink:"/js.enigma/docs/WebDev/Web Parts/AuthAndAuthorization",draft:!1,unlisted:!1,editUrl:"https://github.com/carefree-ladka/docs/WebDev/Web Parts/AuthAndAuthorization.mdx",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Rendering Strategies Types",permalink:"/js.enigma/docs/WebDev/React/RenderingTypes"},next:{title:"Web Accessibility",permalink:"/js.enigma/docs/WebDev/Web Parts/WebAccessibility"}},a={},l=[{value:"Core Concepts",id:"core-concepts",level:2},{value:"Authentication vs Authorization",id:"authentication-vs-authorization",level:3},{value:"Cookie Security",id:"cookie-security",level:2},{value:"Cookie Attributes",id:"cookie-attributes",level:3},{value:"Cookie Security Best Practices",id:"cookie-security-best-practices",level:3},{value:"JWT (JSON Web Tokens)",id:"jwt-json-web-tokens",level:2},{value:"JWT Structure",id:"jwt-structure",level:3},{value:"JWT Implementation",id:"jwt-implementation",level:3},{value:"JWT Best Practices",id:"jwt-best-practices",level:3},{value:"Refresh Token Implementation",id:"refresh-token-implementation",level:2},{value:"Token Flow",id:"token-flow",level:3},{value:"Refresh Token Rotation",id:"refresh-token-rotation",level:3},{value:"CSRF (Cross-Site Request Forgery) Protection",id:"csrf-cross-site-request-forgery-protection",level:2},{value:"CSRF Token Implementation",id:"csrf-token-implementation",level:3},{value:"Double Submit Cookie Pattern",id:"double-submit-cookie-pattern",level:3},{value:"Content Security Policy (CSP)",id:"content-security-policy-csp",level:2},{value:"Basic CSP Implementation",id:"basic-csp-implementation",level:3},{value:"CSP Header Examples",id:"csp-header-examples",level:3},{value:"Security Headers",id:"security-headers",level:2},{value:"Essential Security Headers",id:"essential-security-headers",level:3},{value:"Session Management",id:"session-management",level:2},{value:"Session Configuration",id:"session-configuration",level:3},{value:"Session Security Best Practices",id:"session-security-best-practices",level:3}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"authentication--authorization-security",children:"Authentication & Authorization Security"})}),"\n",(0,s.jsx)(n.h2,{id:"core-concepts",children:"Core Concepts"}),"\n",(0,s.jsx)(n.h3,{id:"authentication-vs-authorization",children:"Authentication vs Authorization"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Authentication (AuthN)\r\n- Verifies WHO you are\r\n- Handles user login/identity\r\n- Examples: passwords, biometrics\r\n- Comes before authorization\r\n\r\nAuthorization (AuthZ)\r\n- Determines WHAT you can do\r\n- Handles permissions\r\n- Examples: admin rights, role-based access\r\n- Happens after authentication\n"})}),"\n",(0,s.jsx)(n.h2,{id:"cookie-security",children:"Cookie Security"}),"\n",(0,s.jsx)(n.h3,{id:"cookie-attributes",children:"Cookie Attributes"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// Setting a secure HttpOnly cookie\r\nres.cookie('sessionId', 'value', {\r\n    httpOnly: true,     // Cannot be accessed by JavaScript\r\n    secure: true,       // Only sent over HTTPS\r\n    sameSite: 'strict', // Protects against CSRF\r\n    path: '/',          // Cookie scope\r\n    domain: '.example.com',\r\n    maxAge: 3600000,    // 1 hour in milliseconds\r\n    expires: new Date() // Specific date\r\n});\n"})}),"\n",(0,s.jsx)(n.h3,{id:"cookie-security-best-practices",children:"Cookie Security Best Practices"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"HttpOnly Cookies"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Prevents XSS attacks accessing cookies"}),"\n",(0,s.jsxs)(n.li,{children:["Cannot be accessed via ",(0,s.jsx)(n.code,{children:"document.cookie"})]}),"\n",(0,s.jsx)(n.li,{children:"Essential for session cookies"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Secure Flag"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Only transmitted over HTTPS"}),"\n",(0,s.jsx)(n.li,{children:"Prevents man-in-the-middle attacks"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"SameSite Attribute"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// Strict: Cookie only sent in first-party context\r\nsameSite: 'strict'\r\n\r\n// Lax: Sent with navigation to origin site\r\nsameSite: 'lax'\r\n\r\n// None: Cookie sent in all contexts (requires Secure)\r\nsameSite: 'none'\n"})}),"\n",(0,s.jsx)(n.h2,{id:"jwt-json-web-tokens",children:"JWT (JSON Web Tokens)"}),"\n",(0,s.jsx)(n.h3,{id:"jwt-structure",children:"JWT Structure"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'Header.Payload.Signature\r\n\r\nHeader: {\r\n  "alg": "HS256",\r\n  "typ": "JWT"\r\n}\r\n\r\nPayload: {\r\n  "sub": "1234567890",\r\n  "name": "John Doe",\r\n  "exp": 1516239022\r\n}\r\n\r\nSignature: HMACSHA256(\r\n  base64UrlEncode(header) + "." +\r\n  base64UrlEncode(payload),\r\n  secret\r\n)\n'})}),"\n",(0,s.jsx)(n.h3,{id:"jwt-implementation",children:"JWT Implementation"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// Creating a JWT\r\nconst token = jwt.sign(\r\n    { userId: user.id },\r\n    process.env.JWT_SECRET,\r\n    { \r\n        expiresIn: '15m',\r\n        algorithm: 'HS256'\r\n    }\r\n);\r\n\r\n// Verifying a JWT\r\ntry {\r\n    const decoded = jwt.verify(token, process.env.JWT_SECRET);\r\n    // decoded.userId is now available\r\n} catch (err) {\r\n    // Token invalid or expired\r\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"jwt-best-practices",children:"JWT Best Practices"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Token Storage"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Store in HttpOnly cookie (preferred)"}),"\n",(0,s.jsx)(n.li,{children:"Never in localStorage (XSS vulnerable)"}),"\n",(0,s.jsx)(n.li,{children:"Consider memory storage for SPAs"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Security Measures"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Short expiration times (15min recommended)"}),"\n",(0,s.jsx)(n.li,{children:"Use refresh tokens for longevity"}),"\n",(0,s.jsx)(n.li,{children:"Include only necessary payload data"}),"\n",(0,s.jsx)(n.li,{children:"Use strong secrets (min 256 bits)"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"refresh-token-implementation",children:"Refresh Token Implementation"}),"\n",(0,s.jsx)(n.h3,{id:"token-flow",children:"Token Flow"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// Initial authentication\r\nconst authToken = generateJWT(user, '15m');\r\nconst refreshToken = generateRefreshToken(user);\r\n\r\n// Store refresh token in database\r\nawait storeRefreshToken(user.id, refreshToken);\r\n\r\n// Send tokens to client\r\nres.cookie('authToken', authToken, {\r\n    httpOnly: true,\r\n    secure: true,\r\n    sameSite: 'strict',\r\n    maxAge: 900000 // 15 minutes\r\n});\r\n\r\nres.cookie('refreshToken', refreshToken, {\r\n    httpOnly: true,\r\n    secure: true,\r\n    sameSite: 'strict',\r\n    path: '/refresh', // Restrict to refresh endpoint\r\n    maxAge: 7776000000 // 90 days\r\n});\n"})}),"\n",(0,s.jsx)(n.h3,{id:"refresh-token-rotation",children:"Refresh Token Rotation"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"async function handleRefresh(refreshToken) {\r\n    // Verify refresh token\r\n    const storedToken = await getStoredRefreshToken(refreshToken);\r\n    if (!storedToken || storedToken.revoked) {\r\n        throw new Error('Invalid refresh token');\r\n    }\r\n\r\n    // Generate new tokens\r\n    const newAuthToken = generateJWT(user, '15m');\r\n    const newRefreshToken = generateRefreshToken(user);\r\n\r\n    // Revoke old refresh token\r\n    await revokeRefreshToken(refreshToken);\r\n    \r\n    // Store new refresh token\r\n    await storeRefreshToken(user.id, newRefreshToken);\r\n\r\n    return { newAuthToken, newRefreshToken };\r\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"csrf-cross-site-request-forgery-protection",children:"CSRF (Cross-Site Request Forgery) Protection"}),"\n",(0,s.jsx)(n.h3,{id:"csrf-token-implementation",children:"CSRF Token Implementation"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// Generate CSRF token\r\nconst csrfToken = crypto.randomBytes(32).toString('hex');\r\n\r\n// Store token in session\r\nreq.session.csrfToken = csrfToken;\r\n\r\n// Send token to client\r\nres.cookie('XSRF-TOKEN', csrfToken, {\r\n    secure: true,\r\n    sameSite: 'strict'\r\n});\r\n\r\n// Verify token in middleware\r\nfunction validateCSRF(req, res, next) {\r\n    const token = req.headers['x-csrf-token'] || \r\n                 req.body._csrf ||\r\n                 req.cookies['XSRF-TOKEN'];\r\n\r\n    if (!token || token !== req.session.csrfToken) {\r\n        return res.status(403).json({ error: 'CSRF token invalid' });\r\n    }\r\n    next();\r\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"double-submit-cookie-pattern",children:"Double Submit Cookie Pattern"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// Set CSRF token in cookie and form field\r\nfunction setCSRFToken(req, res) {\r\n    const token = crypto.randomBytes(32).toString('hex');\r\n    res.cookie('csrfToken', token, { \r\n        httpOnly: false,\r\n        secure: true \r\n    });\r\n    return token;\r\n}\r\n\r\n// Validate token match\r\nfunction validateToken(req) {\r\n    return req.cookies.csrfToken === req.headers['x-csrf-token'];\r\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"content-security-policy-csp",children:"Content Security Policy (CSP)"}),"\n",(0,s.jsx)(n.h3,{id:"basic-csp-implementation",children:"Basic CSP Implementation"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'// Using helmet middleware in Express\r\napp.use(helmet.contentSecurityPolicy({\r\n    directives: {\r\n        defaultSrc: ["\'self\'"],\r\n        scriptSrc: ["\'self\'", "\'unsafe-inline\'"],\r\n        styleSrc: ["\'self\'", "\'unsafe-inline\'"],\r\n        imgSrc: ["\'self\'", "data:", "https:"],\r\n        connectSrc: ["\'self\'", "https://api.example.com"],\r\n        fontSrc: ["\'self\'", "https://fonts.gstatic.com"],\r\n        objectSrc: ["\'none\'"],\r\n        mediaSrc: ["\'self\'"],\r\n        frameSrc: ["\'none\'"]\r\n    }\r\n}));\n'})}),"\n",(0,s.jsx)(n.h3,{id:"csp-header-examples",children:"CSP Header Examples"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-http",children:"// Basic security\r\nContent-Security-Policy: default-src 'self'\r\n\r\n// Allow specific sources\r\nContent-Security-Policy: \r\n    default-src 'self'; \r\n    script-src 'self' https://trusted.com;\r\n    style-src 'self' 'unsafe-inline';\r\n    img-src 'self' data: https:;\r\n    font-src 'self' https://fonts.gstatic.com;\r\n    frame-src 'none';\r\n    base-uri 'self';\r\n    form-action 'self'\r\n\r\n// Report-only mode\r\nContent-Security-Policy-Report-Only: \r\n    default-src 'self';\r\n    report-uri /csp-violation-report\n"})}),"\n",(0,s.jsx)(n.h2,{id:"security-headers",children:"Security Headers"}),"\n",(0,s.jsx)(n.h3,{id:"essential-security-headers",children:"Essential Security Headers"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// Using helmet in Express\r\napp.use(helmet({\r\n    // Strict Transport Security\r\n    hsts: {\r\n        maxAge: 31536000,\r\n        includeSubDomains: true,\r\n        preload: true\r\n    },\r\n    \r\n    // Prevent clickjacking\r\n    frameguard: {\r\n        action: 'deny'\r\n    },\r\n    \r\n    // Disable MIME type sniffing\r\n    noSniff: true,\r\n    \r\n    // XSS Protection\r\n    xssFilter: true,\r\n    \r\n    // Referrer Policy\r\n    referrerPolicy: { \r\n        policy: 'strict-origin-when-cross-origin' \r\n    }\r\n}));\n"})}),"\n",(0,s.jsx)(n.h2,{id:"session-management",children:"Session Management"}),"\n",(0,s.jsx)(n.h3,{id:"session-configuration",children:"Session Configuration"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// Express session configuration\r\napp.use(session({\r\n    secret: process.env.SESSION_SECRET,\r\n    name: 'sessionId', // Custom cookie name\r\n    cookie: {\r\n        httpOnly: true,\r\n        secure: true,\r\n        sameSite: 'strict',\r\n        maxAge: 3600000 // 1 hour\r\n    },\r\n    resave: false,\r\n    saveUninitialized: false,\r\n    store: new RedisStore({\r\n        client: redisClient,\r\n        prefix: 'sess:'\r\n    })\r\n}));\n"})}),"\n",(0,s.jsx)(n.h3,{id:"session-security-best-practices",children:"Session Security Best Practices"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Session ID Management"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Use cryptographically secure random IDs"}),"\n",(0,s.jsx)(n.li,{children:"Rotate session IDs after login"}),"\n",(0,s.jsx)(n.li,{children:"Invalidate on logout/timeout"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Session Storage"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Use server-side storage (Redis/Memcached)"}),"\n",(0,s.jsx)(n.li,{children:"Never store sensitive data in cookie"}),"\n",(0,s.jsx)(n.li,{children:"Implement session expiration"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Session Validation"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Validate IP address consistency"}),"\n",(0,s.jsx)(n.li,{children:"Check User-Agent consistency"}),"\n",(0,s.jsx)(n.li,{children:"Implement absolute/idle timeouts"}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>c});var s=r(6540);const t={},i=s.createContext(t);function o(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);